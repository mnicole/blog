{"data":{"site":{"siteMetadata":{"title":"Thoughts on Things","author":"Michele Larson"}},"markdownRemark":{"id":"ea6ffb1f-ab7a-594a-94c8-9615384afbc4","excerpt":"This week focuses on life as a malware researcher and covers how the attack gets into the system, how it typically functions, and how we can defend against it…","html":"<p>This week focuses on life as a malware researcher and covers how the attack gets into the system, how it typically functions, and how we can defend against it.</p>\n<h4>Spreading malware</h4>\n<h5>First contact - Possible Sources</h5>\n<ul>\n<li>Email, Instant Messaging</li>\n<li>Malvertising - contaminated ads</li>\n<li>Poisoned search results - Trow up sites based on google trends that would show up high in search results that people would then click on</li>\n<li>Watering hole - go to the place where people mostly go and poison one place</li>\n<li>Physical access - such as USB drives</li>\n</ul>\n<h5>Local Execution</h5>\n<ul>\n<li>Autorun - Windows will automatically run software</li>\n<li>Exploitation of a document or file - PDF, plugin, browser</li>\n<li>Reverse psychology/social engineering - “don’t click here” “click to claim your prize”</li>\n</ul>\n<h5>Establish Presence</h5>\n<ul>\n<li>Tries to blend in and hide (change filenames or datetime stamp, sign files)</li>\n<li>Tries to appear legitimate</li>\n<li>Persists (system startup, application start up, scheduled tasks, etc)</li>\n</ul>\n<h5>Attack</h5>\n<ul>\n<li>Harvest information</li>\n<li>Phone home - use web, email, FTP to send data</li>\n</ul>\n<h4>Defenses</h4>\n<ul>\n<li>User education</li>\n<li>Block computer ports</li>\n<li>Anti-virus/malware</li>\n<li>Network Firewall/Inreusion Prevention</li>\n<li>Message/Network/Web Reputation</li>\n<li>Host Firewall</li>\n<li>Host IPS</li>\n<li>Access control</li>\n</ul>\n<h5>Anti-malware features</h5>\n<ul>\n<li>File Scanning</li>\n<li>Registry and Cookies</li>\n<li>Cloud scanning</li>\n<li>Memory scanning</li>\n<li>Scripts</li>\n<li>Heuristics</li>\n<li>Decomposition</li>\n<li>Configuration: Exclusions, sensitivity, reporting</li>\n</ul>\n<h4>Yara</h4>\n<ul>\n<li>language that lets you search for patterns in your scans</li>\n<li>strings - <code class=\"language-text\">&quot;in quotes&quot;</code> params: <code class=\"language-text\">nocase</code>, <code class=\"language-text\">wide</code>, <code class=\"language-text\">wide ascii</code>, <code class=\"language-text\">fullword</code></li>\n<li>Byte patterns (hex strings) <code class=\"language-text\">{}</code> params: <code class=\"language-text\">?</code> <code class=\"language-text\">??</code> are wildcards <code class=\"language-text\">{E2 34 ?? C8 A? FB}</code></li>\n<li>conditions are boolean operators, arithmetic, and bitwise <code class=\"language-text\">($a == 6 or $b)</code> <code class=\"language-text\">#a == 6 and #b &gt; 10</code> <code class=\"language-text\">$a at 100 and $b at 200</code></li>\n</ul>\n<p>example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">rule myRule {\n    strings:\n        $a = &quot;win.exe&quot;\n        $b = badfile1.exe\n        $c = badfile2.exe\n    condition:\n        $a and ($b or $c)\n}</code></pre></div>\n<p>————</p>\n<p>Lab:</p>\n<p>look for yara editor</p>","frontmatter":{"title":"Thoughts on Security Defenses (Defense of the Dark Arts)","date":"January 26, 2019","tags":["school","security"]}}},"pageContext":{"slug":"/security-defenses/","previous":{"fields":{"slug":"/security-forensics/"},"frontmatter":{"title":"Thoughts on Forensics (Defense of the Dark Arts)","tags":["school","security"]}},"next":null}}