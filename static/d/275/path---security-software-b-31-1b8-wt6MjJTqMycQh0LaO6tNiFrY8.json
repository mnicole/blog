{"data":{"site":{"siteMetadata":{"title":"Thoughts on Things","author":"Michele Larson"}},"markdownRemark":{"id":"57abbbe3-1b3b-57f0-9ed1-59a424278591","excerpt":"Software Vulnerabilities Hacking is manipulating software from bugs in a program, or through configuration vulnerability (when someone has a weak password, or…","html":"<h4>Software Vulnerabilities</h4>\n<p>Hacking is manipulating software from bugs in a program, or through configuration vulnerability (when someone has a weak password, or unchecks a security box, etc. Those things make it less secure.) This week will focus on the first, software vulnerabilities.</p>\n<p>Companies use bug bounty programs where they ask people to find vulnerabilities and report them so they can be fixed, and then they’ll be paid for finding them. </p>\n<p>Companies have gotten better at protecting their perimeters, so rather than focusing on perimeter attacks, attackers now focus on targeting users through phishing and social engineering.</p>\n<p>They can be targeted through a web browser, where javascript code can take over the browser. </p>\n<h5>WinDbg</h5>\n<ul>\n<li>debugger that freezes the program and lets you inspect it.</li>\n<li>List modules <code class=\"language-text\">lm</code></li>\n<li>Search for string (called simple) <code class=\"language-text\">lm list modules</code></li>\n<li>Set breakpoint in singlestackandheap program, main function <code class=\"language-text\">bp singlestackandheap!main</code> on </li>\n<li>list breakpoints <code class=\"language-text\">bl</code></li>\n<li>go <code class=\"language-text\">g</code></li>\n<li>Display dword in memory in (eip) <code class=\"language-text\">dd eip</code></li>\n<li>Unassemble - takes bytes at address (eip) and desembles them <code class=\"language-text\">u eip</code> </li>\n<li>See numbers in different formats <code class=\"language-text\">.formats 123</code></li>\n<li>Display as ascii string <code class=\"language-text\">da 123</code></li>\n<li>Display as unicode string <code class=\"language-text\">du 123</code></li>\n<li>Registers <code class=\"language-text\">r</code></li>\n<li>Stack <code class=\"language-text\">k</code></li>\n</ul>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4e04a32e24d8faa1afb8a0f1d7019325/77244/windbg.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 65.893470790378%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACdElEQVQ4y12S21PaUBDG8/8/dtROO1ZnnGm11NoH60MfFAUUoeGWewIkQSBAQC4SqFy/7h6bjuOZObObze7vfHv2SJ+PE/h2+gMnp+c4Pr3A0ck5dj4lsHuQwM5+Qvi83x9+xx7F9g6+CvvuwxF297/g49EZDo/PcXZxhZvkLaRfl0nkSxrksgG5qCNXUFGsGNCsqojdywru7otIpvK4TBeQzlWQvCsgVzZpW8hSTbagI51XKF6ClMrkYFg2Ot0eFqs1JtMpBo9DBPTd6Ybw/Af0wj7kQgmKZlCug7KiwXLq8B5aKJFfUXUUy6qwkiz/huPYmIzH2G42GI1GCNptdLtdLJcLxMu2LTi2jXqtCtM04PsegqAN0zBgWSYMQ4eua5AymVsCOphMJliv1xgOh+h0OgjDELPZDPP5XMQNKuS8Wq0mfN/3CRgI36Z4pVKBqhEweX2NarUqgM/Pz+j3+8I+PT0JtWwZqlEyAznXNE00Gg0BZN8m5bquCyul0hlY3ErdpTZ7aFPSmNpnyHK5FHBelmWJAgZysed5/xXyPz6QrXSbScN3q5hOhlj8iTCbjrFeLbDdbvF6xYUMZBsrZBD/483XIf28yiKrN2B1InjDFcwgwmDGsK2AxmBRZL7cI0NcUthqtYTPbSuqKnzpIpmD7ASoP67gjTZQHsYIo40Abl4B45Zj4OuhMJCvgdVLmdQNmr77rzF6NoNQ2Lcrvvz4Drllfg1iyhRXSaFo+fomBYeSPM9HRM9kTNPuDwbi9AFZfj6skpUxlIvioXDLsXJFUV4UpmnKrusKAE82iiL0ej0BaDabQgXHGcSFby3XxhPnur9XNKGmbvVbSgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Trying WinDbg\"\n        title=\"\"\n        src=\"/static/4e04a32e24d8faa1afb8a0f1d7019325/fb8a0/windbg.png\"\n        srcset=\"/static/4e04a32e24d8faa1afb8a0f1d7019325/1a291/windbg.png 148w,\n/static/4e04a32e24d8faa1afb8a0f1d7019325/2bc4a/windbg.png 295w,\n/static/4e04a32e24d8faa1afb8a0f1d7019325/fb8a0/windbg.png 590w,\n/static/4e04a32e24d8faa1afb8a0f1d7019325/526de/windbg.png 885w,\n/static/4e04a32e24d8faa1afb8a0f1d7019325/77244/windbg.png 1164w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h5>Registers</h5>\n<ul>\n<li>eax - likely stores return</li>\n<li>eip - instruction pointer</li>\n<li>ebp/esp - stack frame pointers</li>\n</ul>\n<h5>Program memory</h5>\n<ul>\n<li><code class=\"language-text\">!teb</code> - stack - thread - pay attention to stack limit and stack base (refers to entire program)</li>\n<li><code class=\"language-text\">!peb</code> - heap - process - pay attention to process heap</li>\n<li><code class=\"language-text\">!address</code> - will tell you where it is</li>\n</ul>\n<h5>Memory corruption</h5>\n<p>Accessing (reading/writing) memory (usually stack or heap) in an invalid way which results in an undefined behavior (that we then take control of! - exploitation)</p>\n<p>As kind of an inside security thing, as a proof of concept you try to get the calculator app in Windows to launch when you launch your payload when exploiting a vulnerability.</p>\n<p>Metasploit has a lot of vulnerabilities and payloads you can use by mixing and matching to exploit programs.</p>\n<h5>Stack overflow explained</h5>\n<p>In an overflow, we can overwrite what is on the stack in memory, such as saved EBP, saved return address, next function parameter, local variables… so for example, the saved EBP value is whatever we had put in there, which can correspond to an address. </p>\n<h5>Taking control of program</h5>\n<h5>1. Crash triage</h5>\n<p>What registers contain attacker controlled data? what registers point to attacker controlled data? Is attacker controlled data on the stack or the heap? Do we control critical data such as stack frames?\nWhere are we in the execution of the program?</p>\n<h5>2. Determine the return address offset</h5>\n<p>How many bytes between our buffer and the return address on the stack?</p>\n<h5>3. Position our shellcode</h5>\n<h5>4. Find address of our shellcode</h5>\n<p><code class=\"language-text\">ffe4</code> is a jump instruction. We can look for that anywhere in memory and replace the return address with that jmp esp instruction. ESP is pointing to our code, so it will execute off the stack.</p>\n<hr>\n<h4>Lab</h4>\n<p>We are going to exploit a program by overflowing the stack buffer. Here is the javascript code that is running:</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7eae9991b7730ba3f4e444e01e9372d0/811f5/lab1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 310px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 28.064516129032256%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABN0lEQVQY0z2Q6XaCQBSDef9H62ndEAUFhh1UFgEFt/brBWp/3BMyw+Qm0SzryGyes7XOKK/F2FQEUUcQHtmaSriHqzL8MMd2YvZOQpSUpIeGY9nR9nAZpoP2+oPmeSWbbc3ObkSgYrkq8IIW242Fe6x0h70dyUJfUATdRBaksrTglJ1pi46m6qma5yTY9S8e37JBiL4+46gbeXHhcBrmimG44lKxWO5E6CCCKdY+ZK3b3FXCy/IodwFR1tLfQWsvT65iOS9v6CuLj09DXNriOEL5GbqhxKUrFUgtpj/ObL5ltjAxxfXX3EQFOQvhcVqjFdV1zF+3L5K0krgnHDebespqwriUH89kx2bE4TyUuEOniUQO42JM48u7vOylwyChqieX3Y3R9u0x4Zt3f99v/p7/+z8cNH4B5Ai+YeG/428AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"JS program\"\n        title=\"\"\n        src=\"/static/7eae9991b7730ba3f4e444e01e9372d0/811f5/lab1.png\"\n        srcset=\"/static/7eae9991b7730ba3f4e444e01e9372d0/3db3b/lab1.png 148w,\n/static/7eae9991b7730ba3f4e444e01e9372d0/1434c/lab1.png 295w,\n/static/7eae9991b7730ba3f4e444e01e9372d0/811f5/lab1.png 310w\"\n        sizes=\"(max-width: 310px) 100vw, 310px\"\n      />\n  </span>\n  </a></p>\n<p>I load it into windbg and trigger the vulnerability:</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e80ced5230e067f2d2bc5fb7ffe5355d/e18e2/lab2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 30.758426966292134%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAA+UlEQVQY021Q6YqDYAz0/V9NoVrveuGBV6t40dYDZncCun9WCOabTCaTKKZpIgxD+L4Px3Ukv91usCwLcRxDVVXczTvyPL8wctI0xePxQBAEcF0XRVFIKGxgwbbtq4HNTdNcpL7v5U9snmdM04Tv94tlWSTatpU6Byl0GEUR6roW4vv9xnEc0rCuK/Z9v4I4sW3bpP7fpziOc6lzDTo816qqCv6ve+Ynj4OzLBPu8/lE13X4fD5/gpqmyf0Mw5BbeJ4HXddB52dOMdZ4Gq73er0kyrKUOE+TJAkUCjHhZDoahkEms4FvCvBuJzaOo5yGq9MZVydOHsV/AGhjumc30thwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"WinDbg\"\n        title=\"\"\n        src=\"/static/e80ced5230e067f2d2bc5fb7ffe5355d/fb8a0/lab2.png\"\n        srcset=\"/static/e80ced5230e067f2d2bc5fb7ffe5355d/1a291/lab2.png 148w,\n/static/e80ced5230e067f2d2bc5fb7ffe5355d/2bc4a/lab2.png 295w,\n/static/e80ced5230e067f2d2bc5fb7ffe5355d/fb8a0/lab2.png 590w,\n/static/e80ced5230e067f2d2bc5fb7ffe5355d/e18e2/lab2.png 712w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>Next I change the code to use <code class=\"language-text\">msfPatternString</code> to generate and search a pattern and in WinDBG type <code class=\"language-text\">!load byakugan</code> to load a program to tell me the offset of the registers. I run the program and <code class=\"language-text\">!pattern_offset 2000</code> to get the return address of 1028.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5f5a0d48a5e4e71d7e4aee74650ef8b6/44786/lab3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 316px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 33.22784810126582%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABd0lEQVQoz12R6ZKiQBCEff8XmzVWZwAVVwS6Gwc5RE5FHB2/KTQ2NmJ/ZHTW0RlVWRM9D3j7fcBZFPhhi2UX6N2ZUEV82BtWbkCgEnSUsVorqeVoc6BqBoqq53qD/grnC5z6B5M8LPD8Ad8/4Tg1jt2IWEco+Y2XSc4wm20lr1kuY7xNhrtO2G5z6SuJ9yd2nx3F8ZuygklbXakbOBYPfk1znGWD1rU0NyhV8/GuROwTx4qwnB2WpZi9hywWsXCDbRumU48kvVEUInhuL3Q9tOc7xbllkflYqY+TbvGKPapO2Bx3qCojqFKCMsbUB5rhxv0BX/cXhq/X2pO+GzgNUNYDS1cxt1yWG42vY5T4ZS08XN8QmD2uFxGEe+b2H7ZhzGoVooysrjPxNRdPr7Jy2dGJctPe2MWleBmzXkfiy1FQikCKiY5kufiq0udHT3p0dJBa8oxHQSPxU3BvYurT93PcfniNPmLk4/VGfhmvOPzj/79/MWr8AIiVB2JnQCZaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"WinDbg\"\n        title=\"\"\n        src=\"/static/5f5a0d48a5e4e71d7e4aee74650ef8b6/44786/lab3.png\"\n        srcset=\"/static/5f5a0d48a5e4e71d7e4aee74650ef8b6/18004/lab3.png 148w,\n/static/5f5a0d48a5e4e71d7e4aee74650ef8b6/c49a0/lab3.png 295w,\n/static/5f5a0d48a5e4e71d7e4aee74650ef8b6/44786/lab3.png 316w\"\n        sizes=\"(max-width: 316px) 100vw, 316px\"\n      />\n  </span>\n  </a></p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6c8c467e13cd09475449e6df683c0f80/9eb69/lab4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 50.16129032258064%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABgklEQVQoz32Si2rCUBBE8/+fUSi0v1IUNL5NYmqiifGtCRgVneasVdoiXVj2PvbO7Oxep9vtyg989Xo9BUGgVqul4XCoTqejwWCgfr+vRqNh53Ec2x0+Go3k+Z5FcsnDHTae5wlg1u12W77v234ymTwAoiiyc0jm87n5ZrNRnudar9e2XiwWckDlMUyz2Uy73U5lWQo7HA46n8+6Xq/6a5fLRc/MgT0MQ2VZpu12a6AwZvPMqoAgSRJjp0rylsul3ZEbxZH2+70VQQEOEgGs1WomnX5xRtX0DQXNZtN6XK/XH5IBm06nStPUHFLIDJBHPAAYIKoGhMg9DhCEkAAEKEqonF7fwa2HJIPOwWq1MkdqURSPxtNLImdlJQ2ZSPxpx+PxViEDsW/wPW3XdasKMpOVpon+MwZ2dxsKvQMAIAAhGI/Hldxq3ekqSWfVf/MtjsJPHU+nX0D39T3alPlfgNCXcTXJ3WYlN97rtVnqzS313sireNBLvdDH9PZdLk++EvYFYufkMs1DFp4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"WinDbg\"\n        title=\"\"\n        src=\"/static/6c8c467e13cd09475449e6df683c0f80/fb8a0/lab4.png\"\n        srcset=\"/static/6c8c467e13cd09475449e6df683c0f80/1a291/lab4.png 148w,\n/static/6c8c467e13cd09475449e6df683c0f80/2bc4a/lab4.png 295w,\n/static/6c8c467e13cd09475449e6df683c0f80/fb8a0/lab4.png 590w,\n/static/6c8c467e13cd09475449e6df683c0f80/9eb69/lab4.png 620w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>I put that value into the code (need to divide by 2 because it returns 2 for every 1) and add values to the string so it will overwrite that space in memory:</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4da1e0c8d1e77e7091aebf7d5bb6a450/28feb/lab5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 299px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 21.070234113712374%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAA5UlEQVQY01WP2W6DQAxF+f9Pa6UmRZQ1AYawDExg2EmapKcj1Jc+HF3Zsn2vLd/vOBxbongiPI34wUAhF1IhcZyT6RWIiyIRDWF0MaooqwGlN/T0ZLnDvP2xgiWyaT9yikeOdovn92S5NnXBlxvjuClBmOEFGdG5IDSkmaKWPYOama8Lutt2xuUH6/YNjxfo/snbe0NZ38mLK6rdyMuOj0OAbUe4niBOpEl8wXYTCl9wjzL0Z0AVCIQxbMcH1rS89qiNccvLdk+h2tWwIJuBUg5Udc+1W3fNq55KaqSZH83efPv/8i8Q4ylvgUeXfQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"WinDbg\"\n        title=\"\"\n        src=\"/static/4da1e0c8d1e77e7091aebf7d5bb6a450/28feb/lab5.png\"\n        srcset=\"/static/4da1e0c8d1e77e7091aebf7d5bb6a450/58d0d/lab5.png 148w,\n/static/4da1e0c8d1e77e7091aebf7d5bb6a450/bd2b0/lab5.png 295w,\n/static/4da1e0c8d1e77e7091aebf7d5bb6a450/28feb/lab5.png 299w\"\n        sizes=\"(max-width: 299px) 100vw, 299px\"\n      />\n  </span>\n  </a></p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a21061bada3a72946b6b1a77d075d06c/6ea70/lab6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 29.973118279569892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABAElEQVQY022QiYqDQBBE/f9vEzzjgUaTGA88o4mJeKRCNSgsrDB0DT3dVj3F932cz2fcbjcEQSDadV3EcSzaNE3R1+sVURTJSZLk0JxJ0xRlWeL1ekHRdR2e58G2bTiOI0sulwvyPJfKYWrWtm3xeDzw+XwwDAOezyfquhYzYRhKXzmdTnLhEB9N04Tv9ytDy7JgXdfj8D7Ps1S++e9T6I5x6IbRGIN1d0ckO5aiKHC/36VHXVWVmPizUNM0GIYhrOhWN3SoqgrLskAc7LNHJGTFJE3TIMsyuTMuDRyROUiwhEo+7/cbfd+j6zrhM46jwGaPmo722Nu2SY+L+BNi+gGmA7ySGNMhQAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"WinDbg\"\n        title=\"\"\n        src=\"/static/a21061bada3a72946b6b1a77d075d06c/fb8a0/lab6.png\"\n        srcset=\"/static/a21061bada3a72946b6b1a77d075d06c/1a291/lab6.png 148w,\n/static/a21061bada3a72946b6b1a77d075d06c/2bc4a/lab6.png 295w,\n/static/a21061bada3a72946b6b1a77d075d06c/fb8a0/lab6.png 590w,\n/static/a21061bada3a72946b6b1a77d075d06c/6ea70/lab6.png 744w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>Now I see where the program starts and ends and search the program between those two values for ff e4, which is the jump, and update my code with it plus add a call to shellcode to my string to execute next:</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/26ec4ab6ed8aa539430605343b2b11a8/de368/lab7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 10.977242302543507%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAbUlEQVQI112Muw7DIBRD8/8/1LVz5pKrkCFCEVCeYgIBg9veLR2Oju3By04vZP+GMRpKKbTWEGOE957de8cY48b/VmvFnBOlFCyP9cCTAo7zAtEGrQ2EEN9MkFLy8Q9rLds5x04pMTln7iEE9gefXpXVxWndBQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"WinDbg\"\n        title=\"\"\n        src=\"/static/26ec4ab6ed8aa539430605343b2b11a8/fb8a0/lab7.png\"\n        srcset=\"/static/26ec4ab6ed8aa539430605343b2b11a8/1a291/lab7.png 148w,\n/static/26ec4ab6ed8aa539430605343b2b11a8/2bc4a/lab7.png 295w,\n/static/26ec4ab6ed8aa539430605343b2b11a8/fb8a0/lab7.png 590w,\n/static/26ec4ab6ed8aa539430605343b2b11a8/de368/lab7.png 747w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ecffed612e1184bd210fa4e6a528d4d1/9531c/lab8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 319px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 48.275862068965516%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAB6UlEQVQoz1VS6ZraMAzM+7/ZdulyBAgkEHKfzmHnIqUwnSS72/bHfJJla6SRrLlGDP0ocbkqOF4H86KQZAPsW4SzFcBxM7i+QBCVuNGPEsn7BqK+Q3ZAeycGol+ghUYI3ZBMrnE619hsC/ihhHXxsT/Y0PdXFol457LwDbaT4uZkyFIJJTqockBNSPUbTfeCdh8eeLzAwBMfm4lsYBclUj72vBzbrYX11oRpBrjYMQt72O5M1CQe9xbys4Ngd0YYs0D7hNbKAQ1bzkkQp4qyEuTFMJ+TjPLZSZq1EGXPQvUsd7KivEP1n3K/JHMEWqcGdCMgig4RkydCQQlF1ZNomqdEJhbCJKu/i0xvJolt/z+0hsNVZE7TbpndNSbRwKSW5xpBUMHzK0SxguvQRg3ipKWKEZV8olYv1PI1W0loVXbnJeBzwzengWkJuG6H1buFj7UL4xjjsI/w/sOCqbeoBOctgbIkKqAoFisYz/NZ8jjPIEkUfq7PeHvToR8cbjnkdmOsViduNsPp5OFo+Njtrnx3wsFwsdmYsOyUBW34kYJspg7zel6KVA+keUN5glLL2U/zFsHst/OSwrii3Hr+k1MsjKrF8k1RjcsM4yCFbF/oSNrzkw6/iHHx5/On333549/Yv3bKb7iLP4FR7jDbdp/MAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"WinDbg\"\n        title=\"\"\n        src=\"/static/ecffed612e1184bd210fa4e6a528d4d1/9531c/lab8.png\"\n        srcset=\"/static/ecffed612e1184bd210fa4e6a528d4d1/231f6/lab8.png 148w,\n/static/ecffed612e1184bd210fa4e6a528d4d1/04000/lab8.png 295w,\n/static/ecffed612e1184bd210fa4e6a528d4d1/9531c/lab8.png 319w\"\n        sizes=\"(max-width: 319px) 100vw, 319px\"\n      />\n  </span>\n  </a></p>\n<p>It worked! I see a calculator:</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/902af4083fc5535c7a3a3ba345298c61/1bc44/lab9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 59.24412665985699%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAB+UlEQVQoz31T6XKbMBjk/d+pM/2RSVNf4NsEDOYSYBCnwTjY3n6Sj2mmSTWzo4Nltd8hpW1a1HWNpmlwOBwkxLptW0KDruvQnQRO8qxpb7wT7b8aiiAJQSlW38Sa5oCyLJEXBQqJHAVPUeTZ7WLiHY9H9H2P8/l8A63FXnFdF5zIKSFJEoQhg7Xb4VXd4Lem43Vq4ZeqY/zjJwZvQ7AkxT6OEEURYpoFP2QMSV6ioouU2WyG7XYLwzBg2zZM04SqTbEyGXZBDovgJy1Y2uLlbYz5Yi55juOQWCjFIrokLSsZpSI/RCGYuIkIjAjm1oITZijbHrzukBNYWmOkzuHdhXzflyiripzVz7Qpur6BvtFhvL/Dsi14nksOZxgsdljaMRZWhBXNa4fjZbKUIhEJcs6fRRR4Cj6q+zgQlfX8AJoRwAwymD6X0L0Mg+kaORVGuqqqT4KP7pCCXXdrgev1Kue8qKQ7Ny5gsQyGn2LtckzXW1zO/ZN7uVz+gSKKIcLoPz5kb4kWiPck4CRg/AB3X8GOCpisxGxj4XoX/G4oLTmsyb7ot0cYrhdguBI5jCiHoQx/uAmgLg3p8PKNO+kwLmvEeYGUepBnnHKUy55UNQ0TVcNoPMFkomI0Gsl2+fQQvipKUdUo6FUIh+J1PNDcCyRezd8//Q+C8wfnfYhSc8774wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"WinDbg\"\n        title=\"\"\n        src=\"/static/902af4083fc5535c7a3a3ba345298c61/fb8a0/lab9.png\"\n        srcset=\"/static/902af4083fc5535c7a3a3ba345298c61/1a291/lab9.png 148w,\n/static/902af4083fc5535c7a3a3ba345298c61/2bc4a/lab9.png 295w,\n/static/902af4083fc5535c7a3a3ba345298c61/fb8a0/lab9.png 590w,\n/static/902af4083fc5535c7a3a3ba345298c61/526de/lab9.png 885w,\n/static/902af4083fc5535c7a3a3ba345298c61/1bc44/lab9.png 979w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>","frontmatter":{"title":"Thoughts on Software Vulnerabilities (Defense Against the Dark Arts)","date":"January 30, 2019","tags":["school","security"]}}},"pageContext":{"slug":"/security-software/","previous":{"fields":{"slug":"/security-defenses/"},"frontmatter":{"title":"Thoughts on Security Defenses (Defense of the Dark Arts)","tags":["school","security"]}},"next":null}}