{"data":{"site":{"siteMetadata":{"title":"Thoughts on Things","author":"Michele Larson"}},"markdownRemark":{"id":"57abbbe3-1b3b-57f0-9ed1-59a424278591","excerpt":"Software Vulnerabilities Hacking is manipulating software from bugs in a program, or through configuration vulnerability (when someone has a weak password, or…","html":"<h4>Software Vulnerabilities</h4>\n<p>Hacking is manipulating software from bugs in a program, or through configuration vulnerability (when someone has a weak password, or unchecks a security box, etc. Those things make it less secure.) This week will focus on the first, software vulnerabilities.</p>\n<p>Companies use bug bounty programs where they ask people to find vulnerabilities and report them so they can be fixed, and then they’ll be paid for finding them. </p>\n<p>Companies have gotten better at protecting their perimeters, so rather than focusing on perimeter attacks, attackers now focus on targeting users through phishing and social engineering.</p>\n<p>They can be targeted through a web browser, where javascript code can take over the browser. </p>\n<h5>WinDbg</h5>\n<ul>\n<li>debugger that freezes the program and lets you inspect it.</li>\n<li>List modules <code class=\"language-text\">lm</code></li>\n<li>Search for string (called simple) <code class=\"language-text\">lm list modules</code></li>\n<li>Set breakpoint in singlestackandheap program, main function <code class=\"language-text\">bp singlestackandheap!main</code> on </li>\n<li>list breakpoints <code class=\"language-text\">bl</code></li>\n<li>go <code class=\"language-text\">g</code></li>\n<li>Display dword in memory in (eip) <code class=\"language-text\">dd eip</code></li>\n<li>Unassemble - takes bytes at address (eip) and desembles them <code class=\"language-text\">u eip</code> </li>\n<li>See numbers in different formats <code class=\"language-text\">.formats 123</code></li>\n<li>Display as ascii string <code class=\"language-text\">da 123</code></li>\n<li>Display as unicode string <code class=\"language-text\">du 123</code></li>\n<li>Registers <code class=\"language-text\">r</code></li>\n<li>Stack <code class=\"language-text\">k</code></li>\n</ul>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4e04a32e24d8faa1afb8a0f1d7019325/77244/windbg.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 65.893470790378%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACdElEQVQ4y12S21PaUBDG8/8/dtROO1ZnnGm11NoH60MfFAUUoeGWewIkQSBAQC4SqFy/7h6bjuOZObObze7vfHv2SJ+PE/h2+gMnp+c4Pr3A0ck5dj4lsHuQwM5+Qvi83x9+xx7F9g6+CvvuwxF297/g49EZDo/PcXZxhZvkLaRfl0nkSxrksgG5qCNXUFGsGNCsqojdywru7otIpvK4TBeQzlWQvCsgVzZpW8hSTbagI51XKF6ClMrkYFg2Ot0eFqs1JtMpBo9DBPTd6Ybw/Af0wj7kQgmKZlCug7KiwXLq8B5aKJFfUXUUy6qwkiz/huPYmIzH2G42GI1GCNptdLtdLJcLxMu2LTi2jXqtCtM04PsegqAN0zBgWSYMQ4eua5AymVsCOphMJliv1xgOh+h0OgjDELPZDPP5XMQNKuS8Wq0mfN/3CRgI36Z4pVKBqhEweX2NarUqgM/Pz+j3+8I+PT0JtWwZqlEyAznXNE00Gg0BZN8m5bquCyul0hlY3ErdpTZ7aFPSmNpnyHK5FHBelmWJAgZysed5/xXyPz6QrXSbScN3q5hOhlj8iTCbjrFeLbDdbvF6xYUMZBsrZBD/483XIf28yiKrN2B1InjDFcwgwmDGsK2AxmBRZL7cI0NcUthqtYTPbSuqKnzpIpmD7ASoP67gjTZQHsYIo40Abl4B45Zj4OuhMJCvgdVLmdQNmr77rzF6NoNQ2Lcrvvz4Drllfg1iyhRXSaFo+fomBYeSPM9HRM9kTNPuDwbi9AFZfj6skpUxlIvioXDLsXJFUV4UpmnKrusKAE82iiL0ej0BaDabQgXHGcSFby3XxhPnur9XNKGmbvVbSgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Trying WinDbg\"\n        title=\"\"\n        src=\"/static/4e04a32e24d8faa1afb8a0f1d7019325/fb8a0/windbg.png\"\n        srcset=\"/static/4e04a32e24d8faa1afb8a0f1d7019325/1a291/windbg.png 148w,\n/static/4e04a32e24d8faa1afb8a0f1d7019325/2bc4a/windbg.png 295w,\n/static/4e04a32e24d8faa1afb8a0f1d7019325/fb8a0/windbg.png 590w,\n/static/4e04a32e24d8faa1afb8a0f1d7019325/526de/windbg.png 885w,\n/static/4e04a32e24d8faa1afb8a0f1d7019325/77244/windbg.png 1164w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h5>Registers</h5>\n<ul>\n<li>eax - likely stores return</li>\n<li>eip - instruction pointer</li>\n<li>ebp/esp - stack frame pointers</li>\n</ul>\n<h5>Program memory</h5>\n<ul>\n<li><code class=\"language-text\">!teb</code> - stack - thread - pay attention to stack limit and stack base (refers to entire program)</li>\n<li><code class=\"language-text\">!peb</code> - heap - process - pay attention to process heap</li>\n<li><code class=\"language-text\">!address</code> - will tell you where it is</li>\n</ul>\n<h5>Memory corruption</h5>\n<p>Accessing (reading/writing) memory (usually stack or heap) in an invalid way which results in an undefined behavior (that we then take control of! - exploitation)</p>\n<p>As kind of an inside security thing, as a proof of concept you try to get the calculator app in Windows to launch when you launch your payload when exploiting a vulnerability.</p>\n<p>Metasploit has a lot of vulnerabilities and payloads you can use by mixing and matching to exploit programs.</p>\n<h5>Stack overflow explained</h5>\n<p>In an overflow, we can overwrite what is on the stack in memory, such as saved EBP, saved return address, next function parameter, local variables… so for example, the saved EBP value is whatever we had put in there, which can correspond to an address. </p>\n<h5>Taking control of program</h5>\n<h5>1. Crash triage</h5>\n<p>What registers contain attacker controlled data? what registers point to attacker controlled data? Is attacker controlled data on the stack or the heap? Do we control critical data such as stack frames?\nWhere are we in the execution of the program?</p>\n<h5>2. Determine the return address offset</h5>\n<p>How many bytes between our buffer and the return address on the stack?\n<code class=\"language-text\">msfPatternString</code> will tell you what\nIn WinDBG <code class=\"language-text\">!load byakugan</code> then run program and <code class=\"language-text\">!pattern_offset 2000</code> to get the address</p>\n<h5>3. Position our shellcode</h5>\n<h5>4. Find address of our shellcode</h5>\n<p><code class=\"language-text\">ffe4</code> is a jump instruction. We can look for that anywhere in memory and replace the return address with that jmp esp instruction. ESP is pointing to our code, so it will execute off the stack.</p>\n<hr>\n<h4>Lab</h4>","frontmatter":{"title":"Thoughts on Software Vulnerabilities (Defense Against the Dark Arts)","date":"January 30, 2019","tags":["school","security"]}}},"pageContext":{"slug":"/security-software/","previous":{"fields":{"slug":"/security-defenses/"},"frontmatter":{"title":"Thoughts on Security Defenses (Defense of the Dark Arts)","tags":["school","security"]}},"next":null}}