{"componentChunkName":"component---src-templates-blog-post-js","path":"/defense-against-dark-arts/","result":{"data":{"site":{"siteMetadata":{"title":"Thoughts on Things","author":"Michele Larson"}},"markdownRemark":{"id":"160bb8db-6ce3-57ac-a6af-c1d48d10027a","excerpt":"As part of my effort to obtain a Computer Science degree, I took a class called “Defense Against the Dark Arts” on Security topics where I was required to write…","html":"<p>As part of my effort to obtain a Computer Science degree, I took a class called “Defense Against the Dark Arts” on Security topics where I was required to write weekly blog posts. This is a summary of the most interesting information from the course.</p>\n<h2>Malware</h2>\n<h3>Types of Malware</h3>\n<ul>\n<li><strong>Viruses</strong> (parasitic - when it depends on another file, polymorphic - code keeps changing) and Worm - (spreads quickly)</li>\n<li><strong>Trojans</strong> - backdoor (has remote control of system, attacker will be active so it’s more targeted than a bot), downloader (has remote control of system), password stealer, keylogger, bot (waits for remote commands) </li>\n<li><strong>Potentially Unwanted Program, Adware, Spyware</strong> (PUP, PUA, PUS) (commercial, can install other programs along with one you want)</li>\n</ul>\n<h3>Malware Definitions:</h3>\n<ul>\n<li><strong>White listed</strong> - clean</li>\n<li><strong>Black</strong> - dirty</li>\n<li><strong>Grey</strong> - trying to discover what the malware is doing</li>\n<li><strong>Sample</strong> - piece of malware</li>\n<li><strong>Goat</strong> - machine used to investigate malware. Some malware knows when it’s running in a VM, so sometimes you want to run on a real system. Goats are sacrificial machines that are on purpose infected.</li>\n<li><strong>Honeypot</strong> - sitting duck waiting for it to be infected</li>\n<li><strong>Replication</strong> - what is the malware doing? So we can study its behavior.</li>\n<li><strong>Hash</strong> - calculating using cryptographic algorithm (commonly md5) the value of a file. It’s used to verify values of files. (Is it the same file?)</li>\n<li><strong>Trojan horse</strong> - users tricked into opening a program because they think it’s legitimate software. Can also create a backdoor that gives users access to your system</li>\n<li><strong>Spyware</strong> - programs that collect personal info without the user’s knowledge. </li>\n<li><strong>Ransom-ware</strong> - encrypts your files and asks for payment to unlock them - bitcoin</li>\n<li><strong>POS malware</strong> - (point of sale) trying to steal your credit card (Target, Home Depot, Staples)</li>\n<li><strong>Patient zero</strong> - first attacked</li>\n</ul>\n<h3>Strategies to replicate/investigate malware:</h3>\n<ul>\n<li>Transport it in an inactive state by renaming it using the command line (ie remove ‘.exe’ so it won’t execute)</li>\n<li>Have isolated environment so it doesn’t destroy anything you need</li>\n<li>Take a snapshot of your machine before you start, so you can easily revert back to a clean state.</li>\n<li>Upload/check sites: You can hash the file and upload to different sites to see if anyone else has encountered the malware. Virustotal, Malwr, Wepawet, Comodo are examples of sites.</li>\n<li>Compare snapshot before and after running it to see what is changing</li>\n<li>Bait the malware with what it’s looking for (ie if it’s trying to steal credit card numbers, feed it some fake credit card numbers)</li>\n<li>Check PE file (starts with MZ) - headers, directories, section tables, code, imports, data</li>\n<li>Do a text analysis by searching google (maybe someone has a username and posted online, or you find an IP address you can investigate)</li>\n</ul>\n<h3>Tools you can use to investigate:</h3>\n<ul>\n<li>Windows Task Manager</li>\n<li>Windows MS Config</li>\n<li>Windows Command Prompts - IPconfig/displayDNS</li>\n<li>Windows search for the time when last files were added to system </li>\n<li>Windows Task Scheduler</li>\n<li>Windows Registry - because malware wants to survive a reboot, it might add run keys in registry</li>\n<li>attrib <filename></li>\n<li>Windows Process Explorer - Task manager/system monitor</li>\n<li>Windows Process monitor - monitor all changes on system like opening files. File and capture events, search for Evil.exe.</li>\n<li>Flypaper - block TCP/IP connections and blocks program from exiting</li>\n<li>Fake Net - listening on several ports</li>\n<li>Antispy - detect spyware</li>\n</ul>\n<h3>Static analysis techniques:</h3>\n<ul>\n<li>Open the program in text editor and analyze source code</li>\n<li>Open in IDA Pro - tool to disassemble code and to see how it is running</li>\n<li>XOR encryption - check for bit flipping (sometimes authors will flip values to hide things)</li>\n<li>File Insight - A Mcafee tool where you can try to make the code more readable by checking for bit flipping, swapping, and string dumps</li>\n<li>Packer - some malware is compressed and/or encrpyted, so you need to use a packer to return it to its readable state</li>\n</ul>\n<h3>Reconnaissance</h3>\n<ul>\n<li>You can research people at the company on LinkedIn to find out who works there and the way the company structures their email addresses.</li>\n<li>You can research what those users visit, what vendors they use, and send fake emails where you get people to click (water hole attack)</li>\n<li>You can find a lot about what technologies a company is using (on job listings you can see what software they are using; check metadata in files published online (version of pdfs, word, OS, etc)</li>\n<li>Delivery - you can implement a fake wifi, something that requires Facebook login, that people at the company may use and you can then infect them</li>\n</ul>\n<h2>Forensics</h2>\n<ul>\n<li>Includes: Identifying, preserving, analyzing evidence and presenting results.</li>\n<li>Could find evidence in network, operating system, databases and applications, peripherals, removable media, human testimony</li>\n<li>To keep in mind: It’s not up to you to judge guilt. It’s up to you to show what happened. If you think someone is guilty, you look for information to prove your opinion, so it can make you biased while investigating.</li>\n<li>Need to describe results in a way that a judge will understand. Something the lecturer does is ask questions like an attorney to see if there’s anything a judge might ask that they can clarify now.</li>\n<li>Always check times and keep records of times.</li>\n<li>Any time you do anything, it affects the memory and could erase something.</li>\n<li>Locard’s Exchange Principle - when two things interact, there is always transference of material. Thoroughly document anything you do on a live system.</li>\n<li>Triage - There may be different ways to do something. You should check multiple ways to make sure you can come to the same conclusion.</li>\n<li>You can’t log into accounts even if you come across the username and password. You need permission from a judge. It has to be relevant to the case.</li>\n<li>Harddrives are giant and there may be a time limit. You also might get additional harddrives, portable harddrives, cell phones, etc. It takes time to process the data.</li>\n<li>Whitelisting is good to match checksums and verify files are ok and you don’t have to waste time investigating them. The person processing the harddrive will do a checksum of the entire harddrive. The first thing you should do is check that to make sure the evidence wasn’t tampered with.</li>\n</ul>","frontmatter":{"title":"Thoughts on Defense Against the Dark Arts","date":"January 11, 2019","tags":["school","security"]}}},"pageContext":{"slug":"/defense-against-dark-arts/","previous":null,"next":{"fields":{"slug":"/security-forensics/"},"frontmatter":{"title":"Thoughts on Forensics (Defense of the Dark Arts)","tags":["school","security"]}}}}}