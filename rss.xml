<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Thoughts on Things]]></title><description><![CDATA[Thoughts on Things]]></description><link>https://michelelarson.com/blog</link><generator>RSS for Node</generator><lastBuildDate>Thu, 21 Mar 2019 06:29:59 GMT</lastBuildDate><item><title><![CDATA[Thoughts on Mobile Security (Defense Against the Dark Arts)]]></title><description><![CDATA[OS Overview This week starts with an overview of mobile devices and operating systems, the main ones which are: Apple - IOS 2007, is closed‚Ä¶]]></description><link>https://michelelarson.com/blog/security-mobile/</link><guid isPermaLink="false">https://michelelarson.com/blog/security-mobile/</guid><pubDate>Mon, 04 Mar 2019 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;OS Overview&lt;/h4&gt;
&lt;p&gt;This week starts with an overview of mobile devices and operating systems, the main ones which are:&lt;/p&gt;
&lt;h5&gt;Apple - IOS&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;2007, is closed source, found only in Apple devices, and integrates with all Apple services and software. It contains XNU Kernel, is programmed in Objective C/C/C++/Swift, Mach-O file format, .ipa app file format, .app app compiled code.&lt;/li&gt;
&lt;li&gt;Manual approval reviews, vendor-controlled app signing, no third party installs, app isolation: directory sandbox with same privileges for each app, dynamic app permissions.&lt;/li&gt;
&lt;li&gt;Users can bypass system security by ‚Äújailbreaking‚Äù their phone to run any software, open security backdoors, unlock carrier-locked phones.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Microsoft - Windows Phone&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Also closed source and integrates with all Microsoft services. It contains Windows NT Kernel, is programmed in C# .NET or HTML5/JS, PE file format, .xap/.appx app file format, .dll app compiled code.&lt;/li&gt;
&lt;li&gt;Manual approval reviews, vendor-controlled app signing, no third party installs, app isolation: chambers model (kernel/drivers, system apps, standard apps), static app permissions.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Google - Android&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;2005, acquired by Google in 2007, open source, supports ARM, x86, and MIPS CPUs. It contains Linux Kernel, is programmed in Java, ELF file format, .apk app file format, dex/ELF app compiled code.&lt;/li&gt;
&lt;li&gt;Automated approval reviews, self-signed app signing, third party installs configurable (but disabled by default), app isolation: user ID sandbox and permissions by owner, static app permissions.&lt;/li&gt;
&lt;li&gt;Users can bypass system security by ‚Äúrooting‚Äù their phone to get root privileges, execute privileged operations, bypass restrictions such as tethering.&lt;/li&gt;
&lt;li&gt;Over time, Android has added security enhancements with each version, such as a fix for OpenSSL man in the middle attacks, encryption by default, and app verification.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Other - Firefox, Tizen, Ubuntu Touch&lt;/h5&gt;
&lt;h4&gt;Malware Examples&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Symbian Worm Yxes - 2009 - targeted Symbian OS 9+; spread via URL sent as SMS; signed with a valid digital cert; exported contacts to a remote server üò±&lt;/li&gt;
&lt;li&gt;Ikee - 2009 - IOS on Jailbroken phones - demanded $5 to remove the malware; used default SSH password to remotely infect users.&lt;/li&gt;
&lt;li&gt;FakePlayer - 2010 - Android - pretends to be a media player application; sends SMS messages to premium numbers&lt;/li&gt;
&lt;li&gt;Tapsnake - 2010 - Android - found in Android Market; tracked GPS coordinates and sent them to a remote server üò±&lt;/li&gt;
&lt;li&gt;Geinimi - 2010 - first Android botnet - leaked GPS coordinates, device ids, list of installed applications to a remote server; used TCP sockets, encrption, and tried silently installing an app&lt;/li&gt;
&lt;li&gt;PJApps - 2011 - Android - intercepted SMS messages&lt;/li&gt;
&lt;li&gt;Droiddream - 2011 - Android - attempted to root device and then silently install APK; was found in Android Market and spread quickly&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Note: The lectures go on to give MANY examples of Android malware. Makes me glad I have an iphone‚Ä¶&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Android Basics&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Dalvik Virtual Machine (Android &amp;#x3C; 5.0) - sandboxed environment for security, performance, and reliability; executes files in .dex&lt;/li&gt;
&lt;li&gt;Android runtime (Android &gt; 4.4) - compiles apps using on-device dex2oat tool to convert .dex files to .elf files&lt;/li&gt;
&lt;li&gt;Application components include: Activities (user interfaces), Services (runs in background), broadcast receivers (respond to system-wide broadcasts), Content Providers (manage shared app data)&lt;/li&gt;
&lt;li&gt;Inter-process Communication happens via: Official Android through content providers (expose data to other processes such as photos), intents (messages between Android apps)
, Binder (allows one process to call a routine in another process); Non-Official through signals (from/to a process with the same UID or GID or in the same process group), pips (unidirectional byte streams), sockets (Bidirectional byte-streams), message queues (process can write message to the queue that is readable for other processes), semaphores (shared variables can be read and written by many processes), shared memory (location in system memory that can be accessed by two or more processes)&lt;/li&gt;
&lt;li&gt;Messages between components are called Intents - asynchronous, can be used to start an activity, service, or deliver a broadcast&lt;/li&gt;
&lt;li&gt;APK files: &lt;code class=&quot;language-text&quot;&gt;/assets&lt;/code&gt; - raw files used by app; &lt;code class=&quot;language-text&quot;&gt;/lib&lt;/code&gt; - native library files (ELF); &lt;code class=&quot;language-text&quot;&gt;/META-INF&lt;/code&gt; - RSA digital cert; &lt;code class=&quot;language-text&quot;&gt;/res&lt;/code&gt; - images and frontend xml; &lt;code class=&quot;language-text&quot;&gt;AndroidManifest.xml&lt;/code&gt; - encoded manifest; &lt;code class=&quot;language-text&quot;&gt;classes.dex&lt;/code&gt; - Java Dalvik executable; &lt;code class=&quot;language-text&quot;&gt;resources.arsc&lt;/code&gt; - XML data from views compiled&lt;/li&gt;
&lt;li&gt;Manifest file - Java Package Name - unique identifier of app; describes components; lists permissions&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Mobile Malware Analysis Tools&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Linux VM&lt;/li&gt;
&lt;li&gt;Development tools - Android SDK Manager&lt;/li&gt;
&lt;li&gt;Android debug bridge&lt;/li&gt;
&lt;li&gt;AXMLPrinter2 and APK Tool (reverse compiled files)&lt;/li&gt;
&lt;li&gt;Androguard = tool for reverse engineering Android apps, includes DEX/ODEX, apk, Android‚Äôs binary xml, disassembly of DEX/ODEX bytecodes&lt;/li&gt;
&lt;li&gt;Dex2jar - dex code to jar, then can be read by JD-GUI&lt;/li&gt;
&lt;li&gt;JD-GUI - reads Java code (see above)&lt;/li&gt;
&lt;li&gt;JadX - DEX to Java compiler&lt;/li&gt;
&lt;li&gt;Malware can hide binaries in the assets folder. You can use a hex editor like VBinDiff to check the file header.&lt;/li&gt;
&lt;li&gt;To execute Native ELF payload - load the binary as a library and execute it using shell commands&lt;/li&gt;
&lt;li&gt;To do static analysis of native payload - use ARM Disassembler and ARM Decompiler&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4&gt;Labs&lt;/h4&gt;
&lt;p&gt;We learn how to take a &lt;code class=&quot;language-text&quot;&gt;.classes&lt;/code&gt; file and convert it to &lt;code class=&quot;language-text&quot;&gt;.jar&lt;/code&gt; to make it readable:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/c00758cef094c7266e4fdbdf4312e754/05b6e/1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 36.06158833063209%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAB9ElEQVQozyWPz0/SYRzHv/9ErUNHRahDq9wAcZ4apw5da9NLdmhuKAgR2KJam0sRRPj6Yx1c89RmU7KaF1tbh9bKVocsBEOULwLf7xe/CHLBePVIz/ba5/k8z57X8/5I3nCM+ecLxOZkIokZZuQ4UTnB9KzMs+kok4kF4i9WkJdWmF1aZSIxz3hkivFoBMfgbcy3bmK7M8jlgQGu9PcjJV4ukfmd4uvmNzI7fygWChwUFPL7+xQVBa1cxqioVLRyG+OwQtUw0FWV65EYprHHXAiE6PKN0THiR4ovvyK1neXHrwy5fIF0vsSOIh4bVb5nFI6Pj1E1jaNajUMhKosPGo0GNdHfiC5gDo5zSXDR9wSL+yHSXHKN7G6e7V2RrKxTqdYwanWaJyfsq1WazWZbUq/X23JDSFutFn/F/bWpRc56w5z3TnDO9ZQzd0NIseUk6cwuqWweTTd48/kn775s0RAJdE1F13U0kbBUKrU5lZ+iipEXNz4x+fo9028/kFj/yIyokpxcJ5tTyOwdkCtorG4WSG4qhKMxXC4Xfr+fEbe7vR8eHsbj8QhG2zUUDPDgnpegb5RQ4D6PRC/JaxtiZIWtdI49pcj/1WJoaAir1YrT6aSvrw+73Y7D4cDR00Ovoxeb1cbV7m6s4txssdDRaaLT1MU/+ueiMuv2rOAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;JAR conversion&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/c00758cef094c7266e4fdbdf4312e754/fb8a0/1.png&quot;
        srcset=&quot;/blog/static/c00758cef094c7266e4fdbdf4312e754/1a291/1.png 148w,
/blog/static/c00758cef094c7266e4fdbdf4312e754/2bc4a/1.png 295w,
/blog/static/c00758cef094c7266e4fdbdf4312e754/fb8a0/1.png 590w,
/blog/static/c00758cef094c7266e4fdbdf4312e754/526de/1.png 885w,
/blog/static/c00758cef094c7266e4fdbdf4312e754/fa2eb/1.png 1180w,
/blog/static/c00758cef094c7266e4fdbdf4312e754/05b6e/1.png 1234w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/8316d1d8e26a57af4c8b9bca9f342f38/e57a0/2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 78.67768595041322%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACgklEQVQ4y42S608aQRTF9///2Kj1UXyQGNNntCCgado0Wv1ihCporSygsCwr+5jdZd8Lp3cGtCiadsPJndf9ce6dkfLFHPYPjrD75RDFrz9Q+naIwv4eCnulifaQLxawnfssxrulEnKFAnK0JiLp4/Y2Pu3siCitv88j+2EXq+/yWON6u4O1zU282VjH0moGr14vYG5pEfPLy1hYWcZiJoP5lZUHzdH6Ip3Lbm0hk81C+lk5RfnkCOeVE9SqZ7ioneP31RUajQaazSYacgOyLKN+fS3UoHGT702Jr9XrdcgkSb7+hcuLGpqtFtReD5qmiVgpV3D4/QDHx8col8uo1WpC1Wr1eU32pNCzYWgKmOMiimNgBMRJgt6tit5NF0pXgaqqME0Tvu//UxJPtrQ2ApcBw5R+Q4RRCKPTh6+7YIxBN3Rx+H8+aTgcioTiaQdnNwwJuQyjCEw3YVx2YckajJYBWx/A9yKEwYjOgCJA/4vQHyGYiI+lNE1hWhbO5B5uNYaITnGgbTABZATs3/ahKzr6vTskUUKwkGI8jlQh/0ajkZAAMmZiGId8GdwxL9lhDjzdgcuj5yEOYgRBQDES5YvoUeR9nwB5vgDatiUOJzTm8yAMBYiRK7Xrot2mS7PtF/s2huGvQ4sccmD6BGi2NCiKhk5HgU3tCP3gUXn3mgZLvAfsCTAk4MAZ0O0bMEwdEZWX+JFoB9e0oxmHgedSsjULHAzgMY+c0vsKfNFHx3Eens+0u0dA7jClt8dB43Eq4DzRtqmPtivmoRe82LcZ4LTugVyuaeOurWLgDsAsJlwH/riSaehMD5OJu3sgL9ml5CSmeTRejyf7/JnwPj53OVx/AK11rAbRdbvBAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;JAR conversion&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/8316d1d8e26a57af4c8b9bca9f342f38/fb8a0/2.png&quot;
        srcset=&quot;/blog/static/8316d1d8e26a57af4c8b9bca9f342f38/1a291/2.png 148w,
/blog/static/8316d1d8e26a57af4c8b9bca9f342f38/2bc4a/2.png 295w,
/blog/static/8316d1d8e26a57af4c8b9bca9f342f38/fb8a0/2.png 590w,
/blog/static/8316d1d8e26a57af4c8b9bca9f342f38/526de/2.png 885w,
/blog/static/8316d1d8e26a57af4c8b9bca9f342f38/fa2eb/2.png 1180w,
/blog/static/8316d1d8e26a57af4c8b9bca9f342f38/e57a0/2.png 1210w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Next I try setting up and running some malware that sends a malicious SMS:&lt;/p&gt;
&lt;p&gt;I first create a new instance of an Android Virtual Device:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/af37c412270336a32bcd3036b6a11d5b/f771d/3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 71.36963696369637%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACaklEQVQ4y4WT2XLaQBBF9fepJLbDFsflvOQD8gV5yUMMBiM2LSzCCAnEbpMyFvty03cEriSVZaq6ZjTqPrq9SHv/6SPepS5wlojj1cU5zpMxXKQSSFxd4jyVREzOfHeWSOBNPIa38TjiH+RdMon45SVex2JIXV8rS1xdQQu6HfSCPjodD53Al72Daq2GWrUKt9VCV54n4/GLTR+n+D6dwmu3MR6N5PlR7UG3i+FgAM33PbQ9D644+BI8HA5RqVSQub2FYZrI5/PI3d3hTqxQLMKWD5lyT5+BAIJeTwnQi7rEt6GF4TOeZjNM5atVcbZtO4LkcrAsC7quI5vNolAoKBDvDMMQHx1Og5lYKqvFYoEwnEPb7/fgWq1WCthoNFAUJQQSTmA6ncatQAkulcoCtWGZAjWb+KZXQVFcu/0O2na7xW63wzwM4XYCTJ9mcF1XAZkW4dypjh+gQt613RaKVRdfbooSGwEPhwM0wqgyFOBQisvlSU0zmQzK5bJK1RJQs9lU4FMWbal5V+pvVkp4fv4bUBrC5fu+UkgY68XgIAiUwobjKDh9HKepGsbYfwKpMJ3OSL1KKkWWgEC+J4gd5939/b1q4H+BXZkppleTcWDaZTl7fjSjVMfmtGRG6V+v1zGTKfkjcHSsIQNzuWhUCNa5q1HJvzSJCscy6I6U4NRlrl+A/X4P7DprdgqkUeXpHA21gaakSyjLMnl4xGazwXK5jIA0PjTqNdVFwk5D/LvZtoW6DHPp6GPKPE7kd9xufwJSFW2xWKqJZ32ohoAo6LgbFdzoFj5/NVCyHCwXc4TzuVK32WyxXq/xAwy95tQMiWMEAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;AVD&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/af37c412270336a32bcd3036b6a11d5b/fb8a0/3.png&quot;
        srcset=&quot;/blog/static/af37c412270336a32bcd3036b6a11d5b/1a291/3.png 148w,
/blog/static/af37c412270336a32bcd3036b6a11d5b/2bc4a/3.png 295w,
/blog/static/af37c412270336a32bcd3036b6a11d5b/fb8a0/3.png 590w,
/blog/static/af37c412270336a32bcd3036b6a11d5b/526de/3.png 885w,
/blog/static/af37c412270336a32bcd3036b6a11d5b/fa2eb/3.png 1180w,
/blog/static/af37c412270336a32bcd3036b6a11d5b/f771d/3.png 1212w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Then I launch the simulator and put in a fake contact:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/331ecbff380d0fe6a507469084ddb841/2e83d/4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 86.58410732714138%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAADc0lEQVQ4y32TW2hTWRSG8+KbzIOCw6AMqKVM0b6kzZRS6MVekjah92IoYoSqRcUaHUozHWEE6wVEH7RK8yKoAxZ18EHsDILWXoRWfbEVRGONTWKak9tJTnM5SWN/91ppRNG64Wfvk3C+8/9rra35o68HZy+exKmzZ7DHdgLr9pzGlkPnsf3wBeSLffOBc9CduAHt33fwi/UfbOi5jq1H7fhtVy8aDHrU1zegqqoK1dXVKCsrg8bpdMLhcOKD04Frk7P46aoHP1/3QnfXj+23fdh2S4L2thcFN91YMzSHtfa3WH9Dwq+n/sPB/V3Yu28furq6YLFY0N3dDY3b7YLb44HH48bMq9cYm3mDxy9e4+GLNxidceCReObz7Fu8nF/AvVk3Lj3z4t+RB2hra0NnZyc6OjrQ0tLCu2ZqagrT09Osp0JKOIRoMICIX0JY8rFkOgupSgTzUhjPvQqejI2iz2bD4OAgzGYzKisrUVNTA017ezuTjUYjbLY/4fNKrFRyCSl1RckVqRkEfBI87+cwMvI/rFYrBgYG+H29nupZD015eTmMDQ2gvb+/H1FZgRyKIK7EWTGhxGICcaFUIs3/BYIh3L93nyEmk4nNNDY2ZoFFxTo0NzeLLu3AsaPHGCAHZQSlIIL+IMKBMNLC3VIqgzS5TaRAa2JsAhUVFQytq6tDbW0t75ri4mIGUn7rESvc8+5sZOEmlUxDFQASgdL0HM8BJ3lcDAYDQ3NgAdShtbUVpaWl6DncIxyFIHl9UCi6cJoQjgmWjKtYjMQQEZGXM8DY6DgD9XrDZ1gWqPtdAFs4cm9vHyS/jHfzXrg+SHDMuSAFIlBiKY5NHwn5Q8BHYPxxDqj/GmgymtDU1MTWj/91XBQ/KQofhRKNIZNe5u6qIj7FzVAdxU5rcnySRyUX+TOQfqAvlZSUcA39C35uRDKW5Je5IaIZ1JBsDdVsDVcDFhUVQavVoqCgAJbdFm6KHJK5KQRVYyqLzlTHhEjwZeRvgDqdjt0VFhaKO7kXMVF4Kj45IUBuJ6cxUQZJTAABV42cl5eH/Px8bNq0EeadZix4FoRLj4AuZmErzghIykVeFTg0NAS73Y7LVy5jeHiYYa73LigEXBmXLFgVNyeBSDiK5SWKPIHKqu8A8cVSkyrkgMyzRteNhzqeFbmj60c36EeRPwHMJ+JJXX+2YQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Simulator&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/331ecbff380d0fe6a507469084ddb841/fb8a0/4.png&quot;
        srcset=&quot;/blog/static/331ecbff380d0fe6a507469084ddb841/1a291/4.png 148w,
/blog/static/331ecbff380d0fe6a507469084ddb841/2bc4a/4.png 295w,
/blog/static/331ecbff380d0fe6a507469084ddb841/fb8a0/4.png 590w,
/blog/static/331ecbff380d0fe6a507469084ddb841/526de/4.png 885w,
/blog/static/331ecbff380d0fe6a507469084ddb841/2e83d/4.png 969w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I install the malicious program, WalkText.apk to my simulator:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/334e7870e5b30f3830a8a2017b371da3/a189f/5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 27.83109404990403%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABNUlEQVQY03WOv2rCUBjFL01M1KCDWJHSCO0QodSpJra0RZKYfwqKj9FOfZrSwc7RZPElslVDNU55mNObD0pB7PDjHLh85/5Yt6uhXKmg01GhqpcQRRGCIBBFZ4yh0WggSRLkeY7v3Q7b7RZpmuJrs6G+32c4HA7Isgzs4dHERbuNVquNq2sNFT5erVYJRVEgyzJ/a2GxWGC5XBJhGGK1WiGKIkRxTBnzXK/XYE/P9zjjFi+vb3j/+CSjYyRJwmQywWw2w3w+x3Q6xWg0gs0JggC2bVP6vg9m3N1AqdWgaRp6vduTg7JchuM4dOS6Lo3SkGXB5HieB4unYRhgoijRUb1eR7N5/s+gjPF4zA08shkOhzBNExbvxUe/w4U1OzVwTKlUIqMg8KHrOgaDAc8+GRW93//rP+BNzV+oP1JiAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WalkText&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/334e7870e5b30f3830a8a2017b371da3/fb8a0/5.png&quot;
        srcset=&quot;/blog/static/334e7870e5b30f3830a8a2017b371da3/1a291/5.png 148w,
/blog/static/334e7870e5b30f3830a8a2017b371da3/2bc4a/5.png 295w,
/blog/static/334e7870e5b30f3830a8a2017b371da3/fb8a0/5.png 590w,
/blog/static/334e7870e5b30f3830a8a2017b371da3/526de/5.png 885w,
/blog/static/334e7870e5b30f3830a8a2017b371da3/a189f/5.png 1042w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I launch another instance in the emulator:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/7a0ed967c94a8ee21898bf7cd2faebd5/bfcdc/6.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 64.34426229508196%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACYUlEQVQ4y3VS227aQBD1v7e5VECT0ERVpD6lT33sU6W+pImUVhDMJTbGQHzDNsbYXBruGHM6swSpipKVjnZm5+zZ3dkj5b9cIXuWw8dPZ8hkMjg6OkQum6X5PXInBzg8OMLxMeHDMU5Oszg7PcXni3Pk83lkiJeh/OTiAvnLS5rPIfmug64fwOnYcFwbrufB7nRgdix0HMppzemY6AU+oihGv99HGIZijuMYw8EAcRTB91ziBJAc2mTbNiyLBEjI73aFqOd7dJAHn+AR2RNrPuW+iF3XRUACzG+12yiWirAdC9Lk6Qnj8RjD4RCNRgNavQ5N06CqdVSqVSiKCl3XBbi+j/dQVBWmaWEymWA2m0HapCl4rNdrQdAaOup1DcpDjVBFtVKGLMsC1VpNHPTYbqLdbsF4fISuqeIyPDabDSQWSpIN0tUcP2Qb734OcXVj4vb3PX79KeP6roTifQnlchmVSgUPJHpXrODbbRNfbyx8v5YxGo2E4Ha7hZQkCVK65WI+h+EG6P1domW5KKgmSroLWae+Bj0MqPkRNX80iFE3fMiaBcPxUCzXXheczeYIe4EoDOIIyXpJEbUj3RAxFeQdeGeKqN+DbZm4LxZeF5zTDfnXeANbYrFYIKGerKnOHG7Nrj0JFsslusQ1DAOFQkF86puCPNhnq9VKELj2EryH7cN8/vn9p7wpyP3ieG/i/8FrXGNwT5vNJsbPT+bxQrArnsVPYk8x5oTpdIrpcy5iAvPY4PzzYdgXt17SPiHI/uGkqe+MzT7kpzBajV2sPeds+n1NURSyk0wuCElwLfr+D/MasU5lvvszAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Second instance&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/7a0ed967c94a8ee21898bf7cd2faebd5/fb8a0/6.png&quot;
        srcset=&quot;/blog/static/7a0ed967c94a8ee21898bf7cd2faebd5/1a291/6.png 148w,
/blog/static/7a0ed967c94a8ee21898bf7cd2faebd5/2bc4a/6.png 295w,
/blog/static/7a0ed967c94a8ee21898bf7cd2faebd5/fb8a0/6.png 590w,
/blog/static/7a0ed967c94a8ee21898bf7cd2faebd5/526de/6.png 885w,
/blog/static/7a0ed967c94a8ee21898bf7cd2faebd5/fa2eb/6.png 1180w,
/blog/static/7a0ed967c94a8ee21898bf7cd2faebd5/bfcdc/6.png 1220w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I run the malicious program on the first instance, that then sends a malicious SMS to the first instance.&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/08552b349576d026b676f28db69da150/3d701/7.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 99.53051643192488%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAACxklEQVQ4y5WUW08aQRzF+Ri+KjVtRCzRpK1KICxXMWrTVMsDGtgaY6HoW2lM+sBbH/0AfhqbtPVCQEAEJIKhJsh1TUHunM4MaIjaFTc5mdnN7m/Pf85/RjI4OIgxuQz2z0oo1QooVWNEryCXj2Fc8RKTk1OQyV7AZOYwOiLDG60OnMUJbvETFhbewmQ0QK1WQ6VSQTk9DcnAwAAU5EOrYwRqvRxTr9XQclpMjE9gaEgKTsNBKn2G6SkleU8BKXn2fHgYi+/fgf/Iw2q1wmKxYOnDEptLRuVyfHF/xZEvjF8/97G/v4e933s4ODiA1+tl8vl87P7w0Au//wi7uz/g2thgIJvNBrvdjpWVFayvr0NCLnzzfMdTrvJ1GS6XiwFWV1dhMBig1WrZyIBut7vzYrmMarWKaq12X+R5hajZaiGdTsPj8WBnZwfb29uYn5+HTqeD2WzuALe2thiwUqmgXq931Gjcm9eI2u028vk8c7hByl5bW4PJZMLMzAxmZ2c7QKfTeR94VwRKgS3isFgsgud5GI1GzM3NMYdUdM6A9E+iDrvqBdJENRoNg+r1elYydfl/4APqBS4vL4PjOFYuhdJAbtfwUWDPGvYFpAvcl0OS9pMc0tZ4KN1bhwzYfhzocDgYUCgK7KNms4kGgdyo3jNSh4VCQRzI23gIOQGpRAqXlxkEgkGcnJwgEong+PgYQXIfjUYRDofJGEM2m2VbTRR4RYCJeALJRIIAAgwWCoYQJuBYLIZQKMT29Wk8jkwmIw68KblYKCL15wL+QBCR0zgCgQA5DPzMWTKZJO4vUSqVkM3lxIE3oTTqNWRLVURzfxEvlHCRzuDs7Azn5+dIpVLIERD7cd9tQ1KudQ8Clng37UY3ZXpItNrt/ttGuLpCiZw4tKxeYG8flsvXzKloyZubmwxI0xMEgY30KGvc6UOqfC4vGso/8K6K1CUXDZUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Malicious program&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/08552b349576d026b676f28db69da150/fb8a0/7.png&quot;
        srcset=&quot;/blog/static/08552b349576d026b676f28db69da150/1a291/7.png 148w,
/blog/static/08552b349576d026b676f28db69da150/2bc4a/7.png 295w,
/blog/static/08552b349576d026b676f28db69da150/fb8a0/7.png 590w,
/blog/static/08552b349576d026b676f28db69da150/3d701/7.png 852w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I can also inspect the traffic in Wireshark:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/875f819f35e241addf9ea705869be883/8efca/8.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 53.603238866396765%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACfklEQVQoz02SW08TURSF57cbExBFY4goGjUqioBQAimlLa290GF6m1tpO9Mr7VAKLdB6A9SYzz0TH3z4stZZZ+8z62EUy7IwLRNbMG1bvIVuGJimhSFqmDaW5WNRKpUol3WhHNzruoFl6BhWhaNaHcdxULKpFIdairKaoqCXKBaLqAcZCppKMa+RyeZI7sf5LMQiuyTiUSFGOpUkHo1QyCZIqXmyOY1SXkVJFU2c/imt4Zha18MV3xbvemfUj08o15r4MxkhqZVJHJbI6RXylTqFI0fUoSjeP6tWDSVt/CKmXhA/vCSrX3No3qDZP0kWvxM9GJEofCNt/iauTYio0yDfy41JFr5IdhXkMdndzV2SLN+gML7Cs2sMjly+djzGTptJq8cPade3qkzbPf4MR4zqzSC76Q/oGhUG0siTe197ZpVh1WXa6sqDX24ZNnqcNfuM2h7dSoNT95ix+JN6h+vTCUxuuewMxF9yO7z6d38ie8eB9+fO5I0LmVEO9kpsr8XZ+hhjd+Mz26tx9kJpdtb32VnbJx0poCVMwp+S7G1lSO6ohFaihNcTgfrzvvpENlIoMwuvmH34nJn5Z8w8esGDhdfcf/qOucW3QXZXspknb5h9/JK5J5KJ3nu4xLzonblF7s0vyfl5wKx4JRTW+CBNlqXhqnxhLZRha7fApuQr0mJDGm1Hy0G+Gc6zupkJZleCnTjvpNnySizI3gtKr3tBtdrDsjs47gDXPWXgTfF6V/Jjt2g2hpz0p7jOgNH5NZ43wW3Ib9Y6o9EcBrTa5zTl7KOYpk6lYlGrVrFtC1u8aRqy5NButwI6nXag3W6Hfr8nj/YDRqNzxsLoP/4CgMrmP0tRvugAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Wireshark&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/875f819f35e241addf9ea705869be883/fb8a0/8.png&quot;
        srcset=&quot;/blog/static/875f819f35e241addf9ea705869be883/1a291/8.png 148w,
/blog/static/875f819f35e241addf9ea705869be883/2bc4a/8.png 295w,
/blog/static/875f819f35e241addf9ea705869be883/fb8a0/8.png 590w,
/blog/static/875f819f35e241addf9ea705869be883/526de/8.png 885w,
/blog/static/875f819f35e241addf9ea705869be883/fa2eb/8.png 1180w,
/blog/static/875f819f35e241addf9ea705869be883/8efca/8.png 1235w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Week‚Äôs big takeaway: It‚Äôs much easier to add malware to Android‚Ä¶&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Thoughts on Email Security (Defense Against the Dark Arts)]]></title><description><![CDATA[Terms Spamtrap/honeypot - domain or address that only receives spam addresses (no legit emails) Botnet - machines that have been taken over‚Ä¶]]></description><link>https://michelelarson.com/blog/security-email/</link><guid isPermaLink="false">https://michelelarson.com/blog/security-email/</guid><pubDate>Fri, 01 Mar 2019 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;Terms&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Spamtrap/honeypot - domain or address that only receives spam addresses (no legit emails)&lt;/li&gt;
&lt;li&gt;Botnet - machines that have been taken over and the user doesn‚Äôt support the end goal&lt;/li&gt;
&lt;li&gt;Showshoe spam - spreading load over many ISPs&lt;/li&gt;
&lt;li&gt;Phishing/Spear Phishing - email targeting specific individual or department that appears to be from a trusted source &lt;/li&gt;
&lt;li&gt;RBL - (realtime blackhole list) - tests mail server IP to see if it is known to be malicious&lt;/li&gt;
&lt;li&gt;Heuristics - you can build a list of rules, example - ‚Äúsubject like xxx‚Äù AND ‚Äúfrom email like xxxx‚Äù AND ‚Äúno attachment‚Äù&lt;/li&gt;
&lt;li&gt;Fingerprinting/Hashing - way to sign emails to ensure authenticity&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Examples of malicious emails throughout history&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;419 phishing - ‚ÄúI‚Äôm a prince, send money‚Äù etc&lt;/li&gt;
&lt;li&gt;Canadian Pharmacy - Putting text in html span tags so it isn‚Äôt caught by heuristics, created a website that looks legitimate&lt;/li&gt;
&lt;li&gt;Pump ‚Äòn dump - artificially creating demand for stock and then spammers dump the stock and the value goes down&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Tools&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;DIG - DNS records &lt;code class=&quot;language-text&quot;&gt;dig mydomain.com mx&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;WHOIS - IP/Domain registration &lt;code class=&quot;language-text&quot;&gt;whois google.com&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Databases - gather data, able to write sql queries to identify and group emails&lt;/li&gt;
&lt;li&gt;Regex - write rules for identifying spam&lt;/li&gt;
&lt;li&gt;Trustedsource.org - based on McAfee data&lt;/li&gt;
&lt;li&gt;spamhaus.org - reputation data&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Techniques for understanding data&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Parsing data&lt;/li&gt;
&lt;li&gt;Grouping - by timestamp, source_ip, subject, URL, etc&lt;/li&gt;
&lt;li&gt;Aggregation - count distinct values/time&lt;/li&gt;
&lt;li&gt;Identification of outliers - why may something highly similar be classified differently?&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;This week was pretty light in terms of the content presented. Most of the examples were about how to write Regex and MySQL queries, which I have covered in other classes. This was probably my least favorite week and topic in the course. Most of the techniques and examples talked about here we‚Äôve already touched on before so I didn‚Äôt learn too much new. Plus, after doing the lab last week about classifying malicious URLs from data, which was really fun, this lab seemed too similar, but not as fun.&lt;/p&gt;
&lt;p&gt;I also really didn‚Äôt like that the majority of the time was spent talking about how to write regex for Viagra. I wish that they had used a different example. I know this is what you think of when you think of stereotypical spam content but I didn‚Äôt really enjoy to listen to the lecturer say that word 50 times, and there are so many other examples you can use.&lt;/p&gt;
&lt;p&gt;What I did learn is some tools for checking to see if emails are malicious, and if I ever do get an email that I‚Äôm not sure is spam or not, I can now read more information about it and look up the mail server to see what I can find from the message data. Other than that, I think I prefer other topics in security.&lt;/p&gt;
&lt;p&gt;Finally, I thought it was interesting and never really thought about how it‚Äôs worse to have a legitimate email go to your spam than vice versa. Lately I have had many emails go to spam on my Google email at work. Lots of legitimate ones including some sent from third party websites that my company uses, such as event planning sites. I think Gmail is stepping up their spam filtering but I do occasionally see emails go in there that shouldn‚Äôt.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Thoughts on Web Security (Defense Against the Dark Arts)]]></title><description><![CDATA[95% of malware is sent over the web! üò≥ Injection Points De-obfuscated Content ‚Üí Browser/Extensions JavaScript ‚Üí Script Engine HTML (Dom‚Ä¶]]></description><link>https://michelelarson.com/blog/security-web/</link><guid isPermaLink="false">https://michelelarson.com/blog/security-web/</guid><pubDate>Tue, 19 Feb 2019 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;&lt;/h4&gt;
&lt;p&gt;95% of malware is sent over the web! üò≥&lt;/p&gt;
&lt;h4&gt;Injection Points&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;De-obfuscated Content ‚Üí Browser/Extensions&lt;/li&gt;
&lt;li&gt;JavaScript ‚Üí Script Engine&lt;/li&gt;
&lt;li&gt;HTML (Dom Tree) ‚Üí Browser/Extensions&lt;/li&gt;
&lt;li&gt;HTML (Raw HTML) ‚Üí WinInet ETW/ETL&lt;/li&gt;
&lt;li&gt;HTTP ‚Üí HTTP Proxy Network Layer&lt;/li&gt;
&lt;li&gt;Users ‚Üí Social Engineering&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;User Attacks&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Direct a user to install malicious content on their own - executables, browser exploits, malicious forms&lt;/li&gt;
&lt;li&gt;Phishing - fake website, can get users to enter information on their own, valid SSL cert does not always protect the user&lt;/li&gt;
&lt;li&gt;SEO Poisoning - identify search engine trends, game the relevance results to get malicious site to show up high in results&lt;/li&gt;
&lt;li&gt;Fake AV/Fake Updates - look like security updates and may be designed to look like well known security brands&lt;/li&gt;
&lt;li&gt;Social Media Link Insertion - URL shortening services or URLs that look like another well known site but are made of different letters (rnicrosoft.com) make suspicious URLs look legitimate; Catfishing&lt;/li&gt;
&lt;li&gt;Malvertising - advertising networks can deliver malicious ads&lt;/li&gt;
&lt;li&gt;Waterhole attacks - targeting developers. Can hack a resource known to be used by developers.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;User Attack Defenses&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;URL/Domain Reputation Systems&lt;/li&gt;
&lt;li&gt;Site Certification Services&lt;/li&gt;
&lt;li&gt;Client and Gateway AV/AM&lt;/li&gt;
&lt;li&gt;Safe URL Shorteners&lt;/li&gt;
&lt;li&gt;Content provider education&lt;/li&gt;
&lt;li&gt;End user education&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Browser&lt;/h4&gt;
&lt;h5&gt;Security Features of Browser&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Content Security Policy - Same Origin Policy (DOM, XMLHTTPRequest, Cookies, Flash, Java), Cross Origin Resource Sharing (CORS)&lt;/li&gt;
&lt;li&gt;URL Scheme Access Rules&lt;/li&gt;
&lt;li&gt;OS Isolation/Sandboxing&lt;/li&gt;
&lt;li&gt;Redirection Restrictions&lt;/li&gt;
&lt;li&gt;Content handling/sniffing&lt;/li&gt;
&lt;li&gt;Disruptive Script Handling&lt;/li&gt;
&lt;li&gt;Built-in and Plug-in URL Reputation Client&lt;/li&gt;
&lt;li&gt;Add-on AV/AM Content Monitoring&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Browser Exploits&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Browser downloads, renders, and executes malicious web content&lt;/li&gt;
&lt;li&gt;Exploits vulnerabilities in the browser&lt;/li&gt;
&lt;li&gt;Obfuscates the code&lt;/li&gt;
&lt;li&gt;Man in the middle attack - intercepts and modifies traffic in real time; DNS poisoning, Wifi hacking, ARP attack, Rogue or infected router; HTTP can be intercepted and the content rewritten on both proxy and packet levels&lt;/li&gt;
&lt;li&gt;Man in the Browser -  same as MiTM but from within the browser; can be infected by browser exploit, plug-in exploit, HTML5 features such as web sockets/web workers&lt;/li&gt;
&lt;li&gt;DNS spoofing - DNS server returns malicious IP and browser fetches content from it&lt;/li&gt;
&lt;li&gt;Clickjacking - trick user into clicking link in HTML, can be ‚Äúhidden‚Äù and the user doesn‚Äôt realize they‚Äôre clicking it&lt;/li&gt;
&lt;li&gt;SQL Injection - submitting SQL code through a form that can cause harm to your database, circumvent authentication, or read private data; some SQL servers can have access to other things too such as shell commands&lt;/li&gt;
&lt;li&gt;Same origin policy attacks - when a different domain requests something from a different origin, there needs to be a permission check to protect users&lt;/li&gt;
&lt;li&gt;Cross site scripting (XSS) - inject client-side scripts into other user‚Äôs browsers; example - using url params to inject scripts that will run&lt;/li&gt;
&lt;li&gt;Cross-site request Forgery (XSRF) - exploit server‚Äôs trust in the browser; example - authenticated user is trusted, trick browser into sending requests to the site&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Classifying URLs as malicious or not&lt;/h4&gt;
&lt;h5&gt;Toolbox&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Alexa ranking - if been in ranking for a while it‚Äôs probably ok, since malicious sites will pop up and down quickly&lt;/li&gt;
&lt;li&gt;archive.org - can check site changes over time&lt;/li&gt;
&lt;li&gt;IPvoid - IPs change but some bad actors reuse the same ones. Legit sites might have more to deliver content faster to the user; so they may use load balancing, while malicious sites typically only have one IP and no mail server. Some malware could use fast flux to change IPs, but these can be detected because they‚Äôre usually user/consumer IPs. On IPvoid you can check IPs against a list of bad ones&lt;/li&gt;
&lt;li&gt;Checkshorturl - expand a short url into the real one&lt;/li&gt;
&lt;li&gt;Site dossier - tells you general information about a site&lt;/li&gt;
&lt;li&gt;Webutation - you can input the URL to this site and see if it‚Äôs been classified yet as reputable&lt;/li&gt;
&lt;li&gt;Web Inspector - you can input the URL and it will run some tests for you and see if it‚Äôs been classified as malicious already&lt;/li&gt;
&lt;li&gt;Virus Total - search for URL and this tool scans it. A way for security researchers to share info.&lt;/li&gt;
&lt;li&gt;Linux JWHOIS - provides information about domain registration. The info malicious users input for domain registration can be reused or they may put in fake data that can be detected.&lt;/li&gt;
&lt;li&gt;Linux DIG - checks if DNS resolves&lt;/li&gt;
&lt;li&gt;Indicator of Compromise - from logs you can see patterns of malicious objects such as URL, hash, process id, etc&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Research tools&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;PhantomJS - headless webkit/browser, use by rendering the content of pages automatically and then try to determine if it‚Äôs malicious&lt;/li&gt;
&lt;li&gt;JSUnpack - de-obfuscates scripts and detects exploits/browser plug in vulnerabilities&lt;/li&gt;
&lt;li&gt;Burp Suite - can act as a proxy to intercept traffic, can follow links linked within the website (spidering)&lt;/li&gt;
&lt;li&gt;Webscarab - also can intercept and modify requests (very similar to Burp Suite)&lt;/li&gt;
&lt;li&gt;Firebug - gives you ability to inspect elements, modify DOM in the browser for Firefox&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Content based classification&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Manual - a person goes and looks at it manually (time consuming, only used when it‚Äôs really important). Make sure you document everything and store the content! (it may disappear)&lt;/li&gt;
&lt;li&gt;Static - get the page and scan (not render)&lt;/li&gt;
&lt;li&gt;Low Interaction - PhantomJS or similar, where it‚Äôs rendered but no human involved&lt;/li&gt;
&lt;li&gt;High interaction - malicious actors can detect you using a web kit, or they could delay the malware from being loaded, which will cause these fast techniques to not detect it. You have to make high impact sandboxes that looks similar to the environment where it would be running on, to bypass any of these tricks.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Lexical URL classification&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Classify a URL without looking at its content (the content may not be available, crawling URLs takes a long time, there are things we can look at without having to do this)&lt;/li&gt;
&lt;li&gt;Can use human authored rules or machine learning or both!&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Host URL classification&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Check info about the host: IP addresses, DNS data, Domain registration&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Graph based URL classification&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Graph databases, make it faster to search and find&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4&gt;LAB&lt;/h4&gt;
&lt;p&gt;Web Goat is a web server you can run in a VM without internet connections. It contains lessons of insecure practices, so we can practice on it.&lt;/p&gt;
&lt;p&gt;I work my way through the lessons, practicing what we learned this week. Here are some examples:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/79dbca72fcf184ef77a4ef1234cbc58b/a772f/a.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 72.62845849802372%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAADB0lEQVQ4y3VTyW7TUBT1dyCxRYhBgg0SUISqSnwMgxgFC6ACfqGwYt6xBFUMG5ZMbUISZ2paSkISvySeZzuDfTh2SQEhnBzd+/z8js8991qSKxU0azXUq1XUKmW0GnU0mJeLX1EpF1FY/5TnpUIhR12W8+dbjQaazSbq9XqOGu/J3JMUXYdwPQjfh/A8dG0bgyCEOZvBAWCnCZw0hZ2kUKMYakyMx/mzw9EIDZJtbGzkqFKI9OLCORTv3ELx+lWs37iGj1yXr1xG494y6su3UFu+idrd2zvgvead21g/fxYfL17A2LKQXWmSIOVLoyiCdGnvHjxZOIYHRw8Th/DgyEHcP7QfKwf2YYXx4ekTeLS4gEdLp/D0zGk8XTyJx8eP4dmZJdhC7BJmV0z1klws4ruioDccotVu41OphDV6UWm1UMrK2NqCvLmJWhZ5r0zfCvSrwPIiEuSEVJcrjKlwpGkY05NfO4hVFWN6kxgGUvqbcj0xTbiui9l0iulkgsAPELO8nIi//J+dzRQKpQ/fc5GwCdkB0e2i2+4w9qCTWKdyjVHNcr5Ao4AsRmG0q24ecw/bugfVmcKPMx9SjHlgQlVgF+E4O2DnYdlIqXJO8CfZPM8V/lCGsBwPCcdiRpUqyUyW6JHQI8EcWYm/D+dV7no3x5QVSproIrD13bcEQYD/XWEYYhzF2DEt+Wc/Ybelhx86ePJFYEvR6Y0G03agajoGIyq1HIghvTMtrkcolspof9tGq6Ogtt2HzQ/CYPOyATdYlWGYkF6ub+P55x8cmT40pQPX1ODoI9iEZ+l5zGBpQwSOCUwjrG0NsCoPIFSDIgw2ysgFdPsC0hdubigGqj0Tcs/AWsdEeRChMowYw7+iPAzxVfHR1V1OgIBuCAShCz9wYbkO++ZAelXqY7WwjTdVgfcNgXfVPt7IPbxlfF3pMe//Qg+rFQWrDQNNYSFwTTZfg+dbcDybjXW4JmFocUR8DVNXx9TneIy9HUzm0f+dx8wxw4RfxEAoUESbntMWxyZxyAlz8RMKVD1t541svgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Webgoat&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/79dbca72fcf184ef77a4ef1234cbc58b/fb8a0/a.png&quot;
        srcset=&quot;/blog/static/79dbca72fcf184ef77a4ef1234cbc58b/1a291/a.png 148w,
/blog/static/79dbca72fcf184ef77a4ef1234cbc58b/2bc4a/a.png 295w,
/blog/static/79dbca72fcf184ef77a4ef1234cbc58b/fb8a0/a.png 590w,
/blog/static/79dbca72fcf184ef77a4ef1234cbc58b/526de/a.png 885w,
/blog/static/79dbca72fcf184ef77a4ef1234cbc58b/a772f/a.png 1012w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/9a6b8ab6cc54067005ac786e3c6cf088/0e195/b.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 51.62907268170426%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACM0lEQVQoz3WRy04TYRTH5wFIvCFUCEJM1DfwAVibuDTxLVwYhGLcgDFKdGlCISHSViqpQa7GjQkbF65MTEChFzudzpR2WphLO51efp5pDYqJJ/nnfPN9c37npsTDYZIzM+ytveP7aoLDeIyDlThfFxf4Fomgra+hf9zB2N7E2NxA/7CNsbOFLt/aziZFucsmEnx+/owfG+sot/v6uKMoLF2/SnzsCsvDl4mKVkYGWek/T6z/HLGBC8QGLxId6ic6MkB0NETs2hBvb4yyenOM5OgwydAlPt27i3IrFOL++DjvX8yReDJLUjLFZ2d4NfGA+fBD5icnWJzq+YXpKSLTk0QeTbH4OMzy01nevJwjLjFLErsVfY3yZXcXNZulbDtUXBe70aDquOyn0+yl0qTyeQqVCupRCa1cJl8qo/1WvnhERt73Uyn2Dg7J5HIo7U4HrVDgWILarRanVq1CqQRls+flvatiEZpN/meK49jkhFw2TTzPo91ugyQxDIODoMJ0hkz2J4dyTksngc/kVPK6gSUdBf92/pLiSnuaqglAx7KsHlCsdXKCJ1BfKvQlWbNSxZdKG9J6cI+8Y9t04Cyw5gnQ1KXCYwHa3cvAHIHUBeCIXDlbArGkKk/A1Gp0gurE8y+w4ddRzTLpgoNV+zMbRwKKsgRdZnYk3q3XRR6W4+DJDD3f78oXnZ2hbDevqhh6odtys9lbTEsWVDErIlM6s08Dgjl7Ag9UFzUF7kryqiwxqPAXoF6vkgm0EmwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Webgoat&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/9a6b8ab6cc54067005ac786e3c6cf088/fb8a0/b.png&quot;
        srcset=&quot;/blog/static/9a6b8ab6cc54067005ac786e3c6cf088/1a291/b.png 148w,
/blog/static/9a6b8ab6cc54067005ac786e3c6cf088/2bc4a/b.png 295w,
/blog/static/9a6b8ab6cc54067005ac786e3c6cf088/fb8a0/b.png 590w,
/blog/static/9a6b8ab6cc54067005ac786e3c6cf088/0e195/b.png 798w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/51af563e419cf0a9fb50f98c3b996e1f/6588f/c.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 72.00504413619167%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACy0lEQVQ4y32SS2sTURTH5xuIio/6rCkoCi7cuHDjZ3DjpxDxAW5ro7W6FUQsVNS22jYVtRVsFXHhTrBUabQ0aSaveSaZPJt38vPcqZH6wAN/zsydc3/3f84d7fXdu8wGg4TnXxGde8l6KER0NsTK5Dhfx8Yw5udwPrzHfruAvfBmM79bxF5cwJTsyLspNcujD/j8cAztwunTnNU0Ro8dYXpgP5MH9/B0/y6m+vuY3r2dZzu28WzvTkIH+wgFDjBz9DAzx/qZOR5g9sQAz08EeN6/j5eH+nh16iTauTNnOB8I8OLOCFNDg0zfCDJ1M8i9yxd5cO0K969eYvTKZR5dH+TJcJDxWzd4rPLtm0yIJm8PMzEsa8EhHo0Mo336+JHIygpusUhG5G1sUKhW+a7rhGM6q4kkqVwO3baJK1ki0yRhWeiG4etbNMr39XXCa2toXcB2XPI5j1azya8QCOk0JJMgABwHBEImA54H5RKUipt1vTUxolUqFVKplNQ78l6l3Wr5PE/WMnJyJhLBEbniwBIHbjyOKa5t08K1HRxxnJG9rrhv1OtoCmKaBq7rUCyWaP0EWlKUkk3ZQoF6syVqUm00/FyTjbVanbrKomqtJmZqdDpdtKYUROwG34wGuUobul0fmJE21sWhcp/NZnFlLI44Us/qm+u6fldq3fPylEolX1pN6GkrQ9JwZBye8DaBaqMpA7ekJUOyKW4TiQSW5JzMTX1XWcGLcpnlcsV3rG3IraZTSdmUJp8v0Px5MXGZ1fLyF8IrYcLhMEtLS6yurhKLxfhfaIqqTiuVy7TbbV8qbBmyLr+OKTesWlPQfD5PQWba6XT8Tv4lrQf4MxQoIreblBmqVnU9TlZa9ATaFaCKHqT37DvsAbeeosIVV5FoDD1lEksqGaTsLJVa4y/Yby1vBW7NjrScTht05L3d7vhtNuWXarV+r/8zfgDg9t8lgAuMJAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Webgoat&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/51af563e419cf0a9fb50f98c3b996e1f/fb8a0/c.png&quot;
        srcset=&quot;/blog/static/51af563e419cf0a9fb50f98c3b996e1f/1a291/c.png 148w,
/blog/static/51af563e419cf0a9fb50f98c3b996e1f/2bc4a/c.png 295w,
/blog/static/51af563e419cf0a9fb50f98c3b996e1f/fb8a0/c.png 590w,
/blog/static/51af563e419cf0a9fb50f98c3b996e1f/6588f/c.png 793w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/f5380300634c17661fe16ed639c06325/df86e/d.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 70.7943925233645%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAChklEQVQ4y32Ty27TUBCG8w6IgiJ6kSACARK8QN+ALaz6NEUCqagNiAIC2ir3tlJpEiokFqzphsKCTUvTRJD4El9yc2I7ju2fGTuumqJypF9jj8985z9zjmOlpSXsLC7iV3kXx5t5VHJZHOYyOFh9iZN0CvKnPUh7ZcjlEsSPY5WLaFCUS0XUcjnsP30C+eAbeMQezszgQSyGzN0EsjemkZ6NIzMXR276KjJXLiEVv4w0KXVtCtnELPJ3Eijcu4mt+7ewefs6thNzKMSn8ONFMgQ+mp/H44UFfCFnxTev8TmVwja5S688Q3ZlGVvPkyhQzCeXsfP+LT5srKGU3kCR4u76OxTX11B4tYrv+19DoNRoQFUUDIY2bNeFS0nDsvBbECE0m2j1emgbRqBWtwu90wnEz2qrhbokBXO7PSMEOr6Dqq5SoQvHDXIYOUOoqopmU4FCUlUNiqIGOU3XoWk6vSvQ6F2l732jD9/3Q6BLrn5WBFT+KJAVHZ7nwRuNYNPKLsknFx5BPCr2NA0+gXyCe+02vDGExwSwenKMpizBoq3ycBwHXQJZ/T5GwyEcygey7YnnIc/rdTEiAxE0xo6qtRokWQ5AnHRoQod6xwX8fKHou07uOZ4C2WGNgIdHRxBFMewhTTbZBQP/oyG5/2fLlmmiXq9TozWaFFrnRVyCcmR4pPPvDOTcBNAkIDtj633qWeSQF2hRH/lkO3RNBgMzPDCSf+Ywzo5gy+ZgAEEQAkVAdmfQvWP1qJcc+RsfGgN5Qb5KBt3F0Xjr3thpbMDAhgCRrggXRatzPC+G8bDphBv0QyiiBEWSIVEtc8IeWiZkuRkkuB9RkUOXmx1xsWXZpzHq2UVb/gtUfPWyoteVyAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Webgoat&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/f5380300634c17661fe16ed639c06325/fb8a0/d.png&quot;
        srcset=&quot;/blog/static/f5380300634c17661fe16ed639c06325/1a291/d.png 148w,
/blog/static/f5380300634c17661fe16ed639c06325/2bc4a/d.png 295w,
/blog/static/f5380300634c17661fe16ed639c06325/fb8a0/d.png 590w,
/blog/static/f5380300634c17661fe16ed639c06325/df86e/d.png 856w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/11f9de5b8e4ed6dba51a9951d82c4fa1/4bdf2/e.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 71.3436385255648%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACYklEQVQ4y51S22oTURSdb1ColTbFoBWqfoM++gEK+he+qI3ii0ppDVbwSYtCLVaai9WXotGARU2jefHypG2MSczMZGZyM8nM5DIzZ7nPSQIhVkQ3LM7sc+bstfbaR3qxtITY3TvIvHmNTPwlvsdiSMee43MkjMzGBozUO+jvk9ATb6FtJaAlE+JbTW7BoFzdfIUPqw+xHY/D9TxIZ30+nJIkPDo2jcj0FNam9iPkn0DYN47w2B6EJsYQmtyHqH8SkcMHED16SOAxYf3IQTzx+7A+vhebZ06DAZBOzszg3InjeDo/hweXAghdu4qVK5dxb/Y87gcu0N4slgMXsRZcQHgxiPCtm4jeXkQoOI8Iz28sYHXuOp6tLIMxBuljKgWlUIBNcjkcYik3m/iazSFN+3K5DLVSgWwYPeg6wRD4USxiO5sVyMkKeEgePORLKhp1C57r0hYDo9WsVmHXamg3Gui022jbdm9ttWASoes4ogDJwnBIjufiU9HDFx1QflJ5OvfoZ6dUgmPoaGsabMuCTQU5ut0uHH5O8Kgj3uYwJNelYhkVqmag0bSEsfznErVplDnKqJJajhopdgbKdglRkLNkvu1AIyWsz+hSyzyXZVkUGQ1+p0xEFeqiY9lokxXdTqfvIR3mcnnspNOQFQVsF2ZOMAAn5HeKNBCDBlQh6DSger3eK8hNzufzUFVVeDSIDjHynLNztFq9dbRl1m+V9YcjWWS4XJCFRxbJZ4zhbzE8hN88tG1LqOOemaa566VR/Om8r9CEosgokMomvS+MtPCvIVkmL6hQyzXhkSseN/674C+Js/fcSWNl0AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Webgoat&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/11f9de5b8e4ed6dba51a9951d82c4fa1/fb8a0/e.png&quot;
        srcset=&quot;/blog/static/11f9de5b8e4ed6dba51a9951d82c4fa1/1a291/e.png 148w,
/blog/static/11f9de5b8e4ed6dba51a9951d82c4fa1/2bc4a/e.png 295w,
/blog/static/11f9de5b8e4ed6dba51a9951d82c4fa1/fb8a0/e.png 590w,
/blog/static/11f9de5b8e4ed6dba51a9951d82c4fa1/4bdf2/e.png 841w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/b2f0932c6bcf8c7a9ec18ba582e23949/392c8/f.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 64.27145708582835%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACR0lEQVQ4y3WS63KbMBCFef/X6fRX03Zix048bZrGTrBxuNsgIy7i5mDA5GSljt1JmmrYWbFCH2cvWtM08DwPQRBgGAYcj0dUVYUsy+C6LsIwVPu+78/WdR3atlXfy/Xy8oLT0sqywGazUZC/wBLL5RKPjzoMw8BisYDjOPh1ewvTNDGfz1HV9Rn0DlgqdVkmFOykUIIsy4Jj23h6MuFTFuPxCLq+xP39Per/AosCvu+D8/isUH68Xq+xWhmwCSgVyiymkwkMit3d/VY//RAoDxjbYb/fn4FCCDw+PKiLuq7jenpNJVhhdnOj3mezmarrCfYG+D4goVEUKdXSGGNKHaPmyPR3O6ZKEcfxG+DJFHCQNvwJSKBMWSqXvibleVGSf0ZzaNF2PUo6y/NcZfMequGD1dNYdMp6utRj/9yg6weCHUkhx5YaFFMWXfP8z11t7if4vMzwZS2wTXKkVJu8qJCQT9IMPMthBjF8nsPwGX4uVvBcHwvDxNLeqAzknThJUFAmWsQTWCzFgx0ioDqJKECdRkg5o30In8W40BmunjhGa44bO8FhX+Fi4ePTnYeQaionJOIcAYugfbdLXNo5vq4iTL0SU7/GpVNi5FQYuTXGbqViV+QnXqXeR06BKE6Q8B0piyFnWdZc5AW0qVtA2jcJtAVZhrGVYWRmuLKkCUzMhGIpxlIlxX/4BbakJksJmnJKOUacCtoL2RQ5Mkc1Bnvq5NAd0LUHHNtG7QfyaGlGD9SAvpGDRU+HkGbXcmyw3VYpFCJXwFeo29LBrL6cOwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Webgoat&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/b2f0932c6bcf8c7a9ec18ba582e23949/fb8a0/f.png&quot;
        srcset=&quot;/blog/static/b2f0932c6bcf8c7a9ec18ba582e23949/1a291/f.png 148w,
/blog/static/b2f0932c6bcf8c7a9ec18ba582e23949/2bc4a/f.png 295w,
/blog/static/b2f0932c6bcf8c7a9ec18ba582e23949/fb8a0/f.png 590w,
/blog/static/b2f0932c6bcf8c7a9ec18ba582e23949/526de/f.png 885w,
/blog/static/b2f0932c6bcf8c7a9ec18ba582e23949/392c8/f.png 1002w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/3a4573d77ce5bfff6d32ee51404d2c5c/c3b2a/g.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 64.5%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACjklEQVQ4y41S204TURSdPzD+AVEUSDAmhgf1L0x81w/w2U/gF7wkWgUkAumNlouYoPGpMTFFRaVpgTL3Wzu3TjuXziz3mVJSjQ9OsrJ35pyzzlprH25jcRGfXr7AUX4djdU3+LW6gvrzZ2hRL21VIJZLEDbLEKubECtl8FXqSwV8ffoE32lPFEUIw/AC3G2Ow6PLl7Bx5xaW52cJM1iavYrX01N4dW0KuZkryM1NIzd/Hbmbs1hZmMf63QWs3ZjD1v17SOIYkx/3+MFD7Cwto/bxA2r7+9jfqqLwdhXl9TXsFgrYzuexWypiu1jAu3IRe6R2r1pBpZDH+51tDIfDjChN0wxcGAewPAdRko4WCI7rwfE8DMjCGP0gIFBPsB0XtutSH2QkY8JMoUsbfigDaE6CmEjjKETj6AitZgsnxycQeAH82RlEQUC73aYqQlNV6JqOXq/3h7qMsBemOFQA3gIGLI40gW07BBudTic75JFa3+9nocd/ZTapLrPsRwEORA+GExLXaDObXEB2GCmrDJNEY0X/ApfEESSBhyYJRDgKWNc1KIoC0zRhWRYMw8D/fty3UxX5z8fYPZSg2x7ZNMFTXoIootFooNU6RrPZJNs9mF0i73SzvmvZNBiKot/PnHTpYhYN97OtoNbSUWuq4GUNApEZZgeyokKS5axnSnlFR7EuYfNAzP6Vv5yiVBeh0nCYG5kgyQq40UNJEfij4FnP3laSJBfI8qGKNL1YN+gSk6JgkbiuA4tU6mYXXERhx7TBosnqHQs9h6Q7NjyLlNGUfd/HYDBAn4Hssd4la4zI7hpkVaN3ScQEm85ybHrsxvEkh8NzsIvO1ybBFLNLREmmrEWqEtmVIVAVZRW/AZ52r8aOhTnwAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Webgoat&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/3a4573d77ce5bfff6d32ee51404d2c5c/fb8a0/g.png&quot;
        srcset=&quot;/blog/static/3a4573d77ce5bfff6d32ee51404d2c5c/1a291/g.png 148w,
/blog/static/3a4573d77ce5bfff6d32ee51404d2c5c/2bc4a/g.png 295w,
/blog/static/3a4573d77ce5bfff6d32ee51404d2c5c/fb8a0/g.png 590w,
/blog/static/3a4573d77ce5bfff6d32ee51404d2c5c/526de/g.png 885w,
/blog/static/3a4573d77ce5bfff6d32ee51404d2c5c/c3b2a/g.png 1000w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/83a776196ee19102cbd31a26bdecf094/826f9/h.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 72.30255839822024%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACJUlEQVQ4y21TW28SURDe/5/0RYvRB33kxUZtYqi11UT7UoNAAWtpSwUFFrr3w96vnzMHtlwnmcyZnTPffDNzVnl9cICL2gn6wwHu+30MhkP8bDbxo15HvdFAu9tFs92WtkX2qtvBFdlWp4MG2Uu6d//wAJaiKKDwwfYE/DBBKa7rYjSeYKZpsGwbtiNIHamWTVYICFKd4rqmIwzCFWCYRGhNXKgOAYW5DHhiDu3vP+jjMbRSR+OFT1YdDOFQIc/z4Lke4jheAaYZ0JkAAxPQ3UIG8ihCbhjITBMZMcopOTMtpLqOgljC8zkb61IsfSXNE/x+tPAoVkHP92HNXVIBg8B0y4ZDYxDEKCA2xRZQCSYZZlmG3u0Nbu/uYBILliRN5XL+UGsWgQVhtMPIMMyNVktRYmpvTLNRVRVhuBhuSoA3vR5+XV9DnaiUmGBbRqMRHEfsAvq+R4ATubUyMU4SCGrZpdYjKsgFWHzyQ/ITirPmeb4LyJviarPZDMFy/TwGTuYNzudzqZzM37hNPvOd9dmtMfRlu+p0+tQyV+cCDm2UGfL3lJ/DHim2ZvsEyCwYiONZlkpAg55OyAvZ2ug+3dhyOaMyGMeRLMLLmk5nkuV2sry/5/ko+9oIgkCClbPK88124yRGFAZARH8J2WwtrlQOX+DwWWWhz5e69F9WXqF2dI6zDxf4/O4bzt5/l/a4eoqjN8c4rdbwsfoJJ2+/4gvdOaf4fxnAJaWHl8YnAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Webgoat&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/83a776196ee19102cbd31a26bdecf094/fb8a0/h.png&quot;
        srcset=&quot;/blog/static/83a776196ee19102cbd31a26bdecf094/1a291/h.png 148w,
/blog/static/83a776196ee19102cbd31a26bdecf094/2bc4a/h.png 295w,
/blog/static/83a776196ee19102cbd31a26bdecf094/fb8a0/h.png 590w,
/blog/static/83a776196ee19102cbd31a26bdecf094/526de/h.png 885w,
/blog/static/83a776196ee19102cbd31a26bdecf094/826f9/h.png 899w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Thoughts on Network Security (Defense Against the Dark Arts)]]></title><description><![CDATA[Why do we need Network Security? Keeping dangerous data out Prevent exfiltration of data Protect hosts missing internal protection, like‚Ä¶]]></description><link>https://michelelarson.com/blog/security-network/</link><guid isPermaLink="false">https://michelelarson.com/blog/security-network/</guid><pubDate>Tue, 12 Feb 2019 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;Why do we need Network Security?&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Keeping dangerous data out&lt;/li&gt;
&lt;li&gt;Prevent exfiltration of data&lt;/li&gt;
&lt;li&gt;Protect hosts missing internal protection, like legacy or IoT&lt;/li&gt;
&lt;li&gt;Protect against threats coming into the network (DDoS)&lt;/li&gt;
&lt;li&gt;Protect against threats on the network (worms, botnets, espionage)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Protection Strategies&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Positive policy (whitelisting) - define what is allowed, don‚Äôt allow anything else&lt;/li&gt;
&lt;li&gt;Firewalls / security zones - sit between zones and filter traffic for the policy. Define what has access to each zone. Commonly used: Intranet, Internet, Extranet, Corporate, Testing Labs, Data Center.&lt;/li&gt;
&lt;li&gt;Defense in Depth - Isolate things so if you get a section breached, they only have access to that one thing.&lt;/li&gt;
&lt;li&gt;Intrusion Detection - Catches and blocks known threats&lt;/li&gt;
&lt;li&gt;Honeynets / Intrusion Deception - leave something open that we don‚Äôt care about, to see if it‚Äôs attacked&lt;/li&gt;
&lt;li&gt;Quarantine - Put you into your own network where you can‚Äôt touch anything else (ex - airport wireless logins)&lt;/li&gt;
&lt;li&gt;Reputation (also host based) - big data solution where there is a list of bad and good things that anyone can check (ex - IP addresses, URLs, files)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Network Threats&lt;/h3&gt;
&lt;h4&gt;Man in the Middle&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;network generates packets and needs to go through other networks. Someone can sit in the middle and change things before passing them along.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Examples&lt;/h5&gt;
&lt;p&gt;üôÅ ARP poisoning - can fool hosts into thinking the internet gateway is at your MAC address instead of the real one.&lt;/p&gt;
&lt;p&gt;üôÅ TCP hijacking - inject, delete or change data in a TCP stream.&lt;/p&gt;
&lt;p&gt;üôÇ Terminating TCP Proxy - terminate TCP connections on one side and create a new connection on other side or rewrite headers so an attacker can‚Äôt transmit protocol attacks.&lt;/p&gt;
&lt;p&gt;üôÇ HTTP Proxy - intercept all HTTP traffic and verify destination or check for strangely encoded URLs.&lt;/p&gt;
&lt;p&gt;üôÇ SSL MITM - Intercept SSL, decrypt and reencrpy  &lt;/p&gt;
&lt;h5&gt;Detecting Man in the Middle:&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Attach HMAC (Machine Access Code, using a crypto hash) to data. You would need to crack the HMAC to change the data. Private/Public keys are used to hash the data.&lt;/li&gt;
&lt;li&gt;You can trick people with SSL MITM by spoofing DNS or forging/stealing keys and certificates. Also, because people might not know what the browser messages are telling them.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Reconnaissance&lt;/h4&gt;
&lt;h5&gt;Active&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Scanning - trying to connect to many hosts and services to get the IP address and UDP/TCP port of a service you can attack.&lt;/li&gt;
&lt;li&gt;NMAP = common tool&lt;/li&gt;
&lt;li&gt;Kinds of simple scans - Ping, TCP port scan, UDP scans (UDP data packet/ICMP Dest Unreachable)&lt;/li&gt;
&lt;li&gt;Scan for vulnerabilities - try attacking ports one by one&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Passive&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;This is generally illegal ‚ö†Ô∏è&lt;/li&gt;
&lt;li&gt;Attacker waits and listens (Tap ISP, hide equipment, listening to radio signals)&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Defenses&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Setting up honeynets&lt;/li&gt;
&lt;li&gt;Checking logs&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Spoofing&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Attacker pretends to be another network entity.&lt;/li&gt;
&lt;li&gt;Can be spoofed: TCP sequence numbers, IP addresses, MAC addresses, Email addresses, HTTP fields&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Resource Consumption Attacks&lt;/h4&gt;
&lt;h5&gt;DoS&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Denial of Service - consumes resources for an extended period of time so the target is unusable&lt;/li&gt;
&lt;li&gt;DDoS - distributed DoS - uses large number of computers to do the attack which makes it harder to defend against&lt;/li&gt;
&lt;li&gt;Types - Network exhaustion (flooding network so service is unreachable); CPU exhaustion; Memory exhaustion; Storage exhaustion; Application vulnerability exploitation (crashing the app or OS); Crashing other finite resources (Sockets/TCP listen queue/connection pool/firewall session tables)&lt;/li&gt;
&lt;li&gt;Methods - Botnets, DNS or NTP amplification&lt;/li&gt;
&lt;li&gt;Defenses - network traffic validation - check for spoofed addresses and validate application protocols; traffic scrubbing centers (such as cloudflare) - only lets legitimate traffic through&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Bugs / Backdoors&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Common bugs - built in/default passwords, protocol design bugs, buffer overflow&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Network Defenses&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Packet filtering - Setting up a policy, Whitelist traffic, Defends against segmentation, fragmentation attacks, malformed packets&lt;/li&gt;
&lt;li&gt;Deep Inspection - adds inspection of the data portion of the packet in addition to the network headers&lt;/li&gt;
&lt;li&gt;Proxying - inspects data to prevent attacks. During MITM can terminate TCP connections and establish new ones&lt;/li&gt;
&lt;li&gt;NAT (Network Address Translation) - temporarily maps a connection from a local private IP and port to a public IP address and port to be used on the public side of that communication&lt;/li&gt;
&lt;li&gt;VPN/IPSEC - Security layer allowing IP packets to be encrypted between two endpoints under a security association. &lt;/li&gt;
&lt;li&gt;NIPS (Network Intrusion Prevention System) - watches for patterns of traffic or application data that is malicious&lt;/li&gt;
&lt;li&gt;Software Defined Networks (SDN) - can reprogram switches remotely using OpenFlow, so if you find something suspicious, you can quickly send it to a quarantined space.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4&gt;Lab&lt;/h4&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/d5b8079c7961c4290cb0ec22aea08c02/c674e/1a.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 24.199288256227756%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA2UlEQVQY01VRSRKDMAzjTTAcgCZQluwJ0/7/L6qVtIceNIpteU23riv2fcdz27AJaBPLskApheM4Krf3Ca11jY/jiL7vMQzDHzrvHK7rgrEGwQdYsa21lWOMCCFIzMI5KzrRBC/+gPM84UUfY4IxBrkUlHKjSynVpPfrBb4jIYWMsYJLRAU556pxztcYwQIxsGFrylwv3DnrxMjI4qCTXViIq3rfCpCZVO67MhtwMsa4DZum7yB1Qgp+SQRFrXhpK8tKTk6gedt5xvJ4YBZWSmOaJmhh3ph/8AEIB7WMZrbqXwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Question 1&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/d5b8079c7961c4290cb0ec22aea08c02/fb8a0/1a.png&quot;
        srcset=&quot;/blog/static/d5b8079c7961c4290cb0ec22aea08c02/1a291/1a.png 148w,
/blog/static/d5b8079c7961c4290cb0ec22aea08c02/2bc4a/1a.png 295w,
/blog/static/d5b8079c7961c4290cb0ec22aea08c02/fb8a0/1a.png 590w,
/blog/static/d5b8079c7961c4290cb0ec22aea08c02/c674e/1a.png 843w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Using the included .pcap file to find the meeting day:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/660b13c0eb5d73ee7b94fbec56b27b8f/6a8b3/1b.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 69.4789081885856%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAADH0lEQVQ4y1WSW3PaVhSF9ev60GkzzbTTl05/Qd/6H/qepz5kWlzPtImbNG3TBHOrbWEuAiGEEIirwGAEAgwY27h4jO2v20rcTs7M1lpn6ey1z9nnKJZlUbJMyhJmwC1M0ySv62SzWXJ5HV24pmkBGoaBbdtUqlUqFZt6TbDWoFav4zgOiqomyRtZ9KyKVjTFoEAmnSGXy4lJjoPDLPF4gmgkSjwWJxwOk5B5LBEnEY2SOdwneqiTSmfRZAOKIxVG/ojpbMpo5DGZjpkvZgEOvGPcTkuqO5QrsvNSEcsuUW/WAr3ltmi2m7hug5Zgs9VAsSdJ9F6cvIQ9VimNDuj9U+D4ygj09lmOGQ6tpcaYMvV5mrKvytoklqw1vX3M4QHG4G/sURqlMk3IZBe9H6Y236M8jjO8yeNtNDGP0VyqTCngnicFDRqnB6JHuc8repEg1xxGJP8NlpdA0bwUqrvPfnuPnJcm3U/inJewTw1SRyqFsUbjsowxyVEX1P1soD/k7Ume2lWDfLWdRHlVNXlRLvBS4vdaKeCv2zXedmrvNMckfNTgz4b9DusWryoGf4j+q1Vg29DZLuTZyufYMYsojUVCerFLaRiWPt0fOcL4VmOCJr2KSM8SLOTIvctkgJ3zA+xJNNBt+V+W3LK/izV8iz2Mo5jS2HQnRsqNYfpJMt0E7qVBb12US5Fi0vz+dYnqPCu9taSgSqYTDS4x40ZItXclIgFPt2Io9WaTfrfNUadBr9Nk0HMZez2OBwMsR7TBkPVqyaDf5djz5Xkt8CcnDMcTPF+e1sgPeID+BKXa7PBLfkYoPSGU8gllTgL+XXTKN79NeVO5IFye8WRvzHNjyf24u7uTD/+P93yz2aDoTpevd5Y8/mnGlz8veLQ14/H2nK+ezQNtS7/g27+WfBKa833mAm43XF9LSPLmfTzw9XqNUnA6YnjKo9CUz7dP+PTHEz7bOuEL4R89nfJUOxfDBR//MOVJ8kx2c/Of0c3NhzwwrLoDufIzXpQueGmt2CmthK8C/qx4QaG/5nV1xXNzRa635u72weTmA9N7vLq64l+t0cvpFnyLNwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Question 1&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/660b13c0eb5d73ee7b94fbec56b27b8f/fb8a0/1b.png&quot;
        srcset=&quot;/blog/static/660b13c0eb5d73ee7b94fbec56b27b8f/1a291/1b.png 148w,
/blog/static/660b13c0eb5d73ee7b94fbec56b27b8f/2bc4a/1b.png 295w,
/blog/static/660b13c0eb5d73ee7b94fbec56b27b8f/fb8a0/1b.png 590w,
/blog/static/660b13c0eb5d73ee7b94fbec56b27b8f/526de/1b.png 885w,
/blog/static/660b13c0eb5d73ee7b94fbec56b27b8f/fa2eb/1b.png 1180w,
/blog/static/660b13c0eb5d73ee7b94fbec56b27b8f/6a8b3/1b.png 1209w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Using the decode program to decode the day - Wednesday!&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/53fbf7872f2d2f4f647d880195db87b9/67462/1c.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 68.41230257689111%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAADYUlEQVQ4y02T22sjZRjG558RKoI9QOkhrW6zgvVGFEW8W0ulJ1pa0UsFlcbdTe2V4I3C4h7cC3VBd1V2S3cX17Sb40xmMpnJoUmapjk22TZJm7RJ+/PLdFkc+PE873fx8r3fPK8kKwpKUEZVZORgkE7tdrtRAgE0UZvhMOFQCEOoEYkQ1DSCqkrYNDGjUUxx1sEwDQzDQFpfX+cf10OePlln0+/H7fXyaP0huitI1K0Tc4eIPQ2RCBjU8jnqxaKgQDWfp1ooUCuVqJfLNBoNms0Gkq6HSSSSJFNptrd3yOXyRMwY3icxQr6MYAdDzhDVspRLdZ6VDykValT3D2kdH7+gfXoqOEPyBpK43BExrkEsnhRjbOH3BQm5xO08UbZ8McwNg4S8RbN+xPHhkdBOsxNO261zWi3ax00L6fvr9/ju2u/8eO0Gt3++xfWbN7lz4ycKd+9QuP83uXt/kP/zLsX7f1F5vMYziwdU3f9S821S9WxYehRSaIRVpHisjKZmmJtbxG4fY8xuZ2FmlvCah+SGyo5XI7UZJOPXqafT1FLbVAUH8QT7sTj70bjwW9Qyu9SzOaRfN8v84ioyMb3Ea6M2hoaGmJqaIeDPE9KKGHoBXaiuCg3myCT3KOxW2KscU95vsbd/QuWgRUnUnTPJreRwedNMTM4yLJoNCuamp9n1yuR8CjlvgKzbL7xMNZnkMJ3iKJOG9glwJjh9zpmFpIeLIodZJj+etUYeHx9nYWEJlyuFqmZFvvKo4g/HYntk8wfs5g7IZA/Y2akIyudkKhbpdBlJ1bbQQgnm5xe5eNHOyMgIMzMzBOUAHpFJt8eDR+D3BwgE5HO1vGLh98toYil0VcbQgkipVJJ8PisazlvvZxseFn4BzYxjmudbYIqtCIltiUYjRJ7Xuq5bm2EaOo+VJLcf6dxaU5CajSYtkaNPPv2MgcFBLoyN8e577/OFw8nlq05WVjqssLq6itO5Ynmn08nysgOHw8Hlbxwsfn6VKz/8xgNfAqmT8E4wHUvzvDM6zAdvXOBt2wBv9ffyZl833d2v0tPTQ29Pr6X/p6+vz9JXul7i2yvLdD6p1W5zKhLunPqIDwf7mLSPcun1ISbGbFwaHbCewGYbEdgYtrzthe807O/vp6vrZb786mur4X9XeHHg7H7OWgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Question 1&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/53fbf7872f2d2f4f647d880195db87b9/fb8a0/1c.png&quot;
        srcset=&quot;/blog/static/53fbf7872f2d2f4f647d880195db87b9/1a291/1c.png 148w,
/blog/static/53fbf7872f2d2f4f647d880195db87b9/2bc4a/1c.png 295w,
/blog/static/53fbf7872f2d2f4f647d880195db87b9/fb8a0/1c.png 590w,
/blog/static/53fbf7872f2d2f4f647d880195db87b9/526de/1c.png 885w,
/blog/static/53fbf7872f2d2f4f647d880195db87b9/fa2eb/1c.png 1180w,
/blog/static/53fbf7872f2d2f4f647d880195db87b9/67462/1c.png 1203w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/3b6bbd4ef5944b7a41dd8702419defff/d74a6/2a.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 16.281512605042018%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAkElEQVQI1z2OSQ7FIAxDuRHdIjHPQ8v9b+Mm9OsvIpuQvFjc60bvHXtvtNZQSkGtDXMOhBAw1yI/kXNGb/3vuay10MZAKYXruiClhMglw3lPy1Q+nCEGsTrnjvf077yDoWX2McbT11qftyG1NJtSglicgIqvjzEoYcWgxK1W7Of5JSpHuccwBjPsO/CBOQDDX32wao0ysyRQAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Question 2&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/3b6bbd4ef5944b7a41dd8702419defff/fb8a0/2a.png&quot;
        srcset=&quot;/blog/static/3b6bbd4ef5944b7a41dd8702419defff/1a291/2a.png 148w,
/blog/static/3b6bbd4ef5944b7a41dd8702419defff/2bc4a/2a.png 295w,
/blog/static/3b6bbd4ef5944b7a41dd8702419defff/fb8a0/2a.png 590w,
/blog/static/3b6bbd4ef5944b7a41dd8702419defff/526de/2a.png 885w,
/blog/static/3b6bbd4ef5944b7a41dd8702419defff/d74a6/2a.png 952w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Finding the file sent over TCP:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/e057a576c30159e47b47816fb52624de/77e94/2b.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 76.84449489216799%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACGUlEQVQ4y52UXW/aMBSG8/8vdtH/MWlX1W4mbetoRT6c74QAYbRrIAwIkIRQIOHdOSbV1mnVxiw9OfZr+8Q+to/iBT4YPwzQiyJE/Z+EvRCmacIwDAgh4HkewjBEEAQI2LY8a9yviC93CDQTftdA7IYYWDRJtdAXLh7vH5DOZkjTVDKdTv/IZDKR/ePxmBx+NBEbIwSdEGP3AbEYIbyN0FeHqPIKXE6nE3/wWjm1fXmek8NPAgN9QA49cjjGUAwRdSOplfkWDU441vVfacjpar0mhzcO+voI/m0PsfUVkTaET6sN73rYfM9wqCrst9uXlFscdjvJs3akcdliASVWDaSGhdT2kVoOEmpn9wlW3ybIkwTFY4JymqKgOBWT5Azp1WJOLKReUpxLsnPSlTkFsznscXzaoWa7f6Ll80ZB222h7Uh+0Wpq161etzFcbzZQsiyTkzkOdcvxeLyMwwFN02C1WkFZLpfylH4fdKnjFw65cfGqXnPIW+bCwv/Cu5Ex5GvDN70sS3kpC0LaopDav1IQFV2bGZ22wu9U0zTobHUDqqrCtm34vi/fp+u5ss7v1HXPdcdxZJvrZ+3cZ1kWFMsU0DUVlu2gqwuZCHRdR6fTkRP5ZzyQNYYn8k8NQ8ClflXtygUYugaTEojyQQvwWaXk4DlyMMOOGK7zShjb5smazDqCMpBjGXh7E+HN9RBX7wSurvu4eh/jB+WuXHbNgS6XAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Question 2&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/e057a576c30159e47b47816fb52624de/fb8a0/2b.png&quot;
        srcset=&quot;/blog/static/e057a576c30159e47b47816fb52624de/1a291/2b.png 148w,
/blog/static/e057a576c30159e47b47816fb52624de/2bc4a/2b.png 295w,
/blog/static/e057a576c30159e47b47816fb52624de/fb8a0/2b.png 590w,
/blog/static/e057a576c30159e47b47816fb52624de/77e94/2b.png 881w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Using Wireshark to save the file contents:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/f50666674dd8f708fcd201a1e10a68d9/6e8e0/2c.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 70.42253521126761%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAC20lEQVQ4y01U2XLaQBDU/78llT9JKjZ2bHLYRqBzdSB0IAkJCLhwwIAQAZxOa30kD10aaXd6u2d2pNi2DUfYcB0B23FgWdYbTMIWDoTgWrOP6w08z5PwPRf9fh9ef4DBYICAUL60r3B724Z6+x0dw8RdR0Wn04GqdtBRe7i4+or29TXOzs5xdn6OVquF63YbF5eX+HbVws3dHS5vNHRVlTkqFEEFYRQhimMURYGyHCPPc2RZKmGZhiTXdSb1VBkbhk7FJiybLrje7DEIXdeheK6A59CysCRsU0ev26O1gFYD+H6CIBgi6A/hujFLMYDrxbTavCeIkwzDYYY0zRFTlGL5EURUwolL+NkMOgkskaAY1UiSDaJozYQNN6+RECnjothhXFaYTndYLPb4+bMidpjfL6D8EBkunDla9gSfjAnOrDFueiH63komjEYbzGa1THh4qCWWy98Sq9VeYrmssV4339ZQ0jjEtMwxSiNMiwyzccaaBFS3papHTCc7qlpjPK4wn+0wI/Fq9Uy2WNR4fNxjvz/geDxhs9lAidiQLB+RYIj+IGQtUhY34DVoSHYYBCv0/SVtVrRO+8la2qyqI3HA09MJp9ORzydst9sXwiyniiGTStlZIUJ2eoc82yIKH2XtGoXjcssDn+OHhz3q+oDD4UjCE/78+Y/w9ZqUZck445UY8L1ivGUNK2TphmsVJpNKNuD+vv7XjGklbS+XTT3Xr4Qj2kmQZhlVpSRsFNZEReVbhLTv+yvM53uixq9fv9mEA2v2XLsDcTw2CisosaxhLmv3qlDTTI5izLELIajWskLeyyHCMOf9S0k+5P4R9xa0X2IyLti8UopRhOMyUbzNp2maULtd6IYGwzKhcUI0rUtSQ6KZkGZqbE6JpvWgmxZuVR13PYMwoXzrOejqJhthyR+A4MbvqoEbjYe4LqfBffkpNPHzobpuSNg84EL18e5ziPcfHXxoJfgLSgnnoRA0I3kAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Question 2&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/f50666674dd8f708fcd201a1e10a68d9/fb8a0/2c.png&quot;
        srcset=&quot;/blog/static/f50666674dd8f708fcd201a1e10a68d9/1a291/2c.png 148w,
/blog/static/f50666674dd8f708fcd201a1e10a68d9/2bc4a/2c.png 295w,
/blog/static/f50666674dd8f708fcd201a1e10a68d9/fb8a0/2c.png 590w,
/blog/static/f50666674dd8f708fcd201a1e10a68d9/526de/2c.png 885w,
/blog/static/f50666674dd8f708fcd201a1e10a68d9/fa2eb/2c.png 1180w,
/blog/static/f50666674dd8f708fcd201a1e10a68d9/6e8e0/2c.png 1207w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Checking the packets for the password to the file:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/db336dbf1c589af92ac4f48426d34198/cc4aa/2d.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 29.769392033542974%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABJElEQVQY0z2RzW6DMBCEeaaqSsDGJoXgX2ww9EKr5Nj3f4PprpX2YK1ZZr8ZrZucMpxzmKYJfd9DSlnr7XarVSlVj9YDNH3ftcIoBSatcb22GIYBbdui7TrSKDTjONYmHx6UQtY7w/6AmoYFGX23b3iIdzyHDj/yHUaThowEwVgnhEAzz3NNtywLQgiwxiClhOPY4X2o6UspCDHi9AZPP+PLTni4Oz7LBk8zIXikJZHeo7HWgVMyzBDMO1+B27YhxqVCrbXVcObVkObjPsMRIFIvk5ZNjbEV3qScsVEChjCwECiQU6REx3GQUSRYwr7vWKjHxgfdWVfKjvM8qxmb5ryiWekHw9iJKw9x9HVd6w554ZfLpT4W175Xrx2r/wfk2r32+AuektkN1lgIcgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Question 2&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/db336dbf1c589af92ac4f48426d34198/fb8a0/2d.png&quot;
        srcset=&quot;/blog/static/db336dbf1c589af92ac4f48426d34198/1a291/2d.png 148w,
/blog/static/db336dbf1c589af92ac4f48426d34198/2bc4a/2d.png 295w,
/blog/static/db336dbf1c589af92ac4f48426d34198/fb8a0/2d.png 590w,
/blog/static/db336dbf1c589af92ac4f48426d34198/526de/2d.png 885w,
/blog/static/db336dbf1c589af92ac4f48426d34198/cc4aa/2d.png 954w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Trying to use truecrypt to see the file, but the mapping fails üòû&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/ca8d0cc895dd2c30d1386fac906d9106/d74a6/2e.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 21.113445378151262%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAuklEQVQY001PWw6DMAzjROWNgAJ9wAqCQZmQxv1P4pFoTPuw4jqpZQd+3+G9x7Zt6LoOTdPwNMagrmtordG1LdoLpCuleKeU5tuyLFm7/wb7/sI0TZBSIkkSpGnKuPm/FobhFwJCiN/75lEUITiOA845LMuCvh/YfBgGGGsZ6/rEOI6sUQIpa1RVxYmoAWmUuChyxHGM4H2emOeZKy/XpIpkSiBOsJexeziuba3hAMTzPOfkWZZxEzL8AJi6iWnQfNH/AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Question 2&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/ca8d0cc895dd2c30d1386fac906d9106/fb8a0/2e.png&quot;
        srcset=&quot;/blog/static/ca8d0cc895dd2c30d1386fac906d9106/1a291/2e.png 148w,
/blog/static/ca8d0cc895dd2c30d1386fac906d9106/2bc4a/2e.png 295w,
/blog/static/ca8d0cc895dd2c30d1386fac906d9106/fb8a0/2e.png 590w,
/blog/static/ca8d0cc895dd2c30d1386fac906d9106/526de/2e.png 885w,
/blog/static/ca8d0cc895dd2c30d1386fac906d9106/d74a6/2e.png 952w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/b4d5c69899291c70e03028ebcebea130/5be35/3a.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 23.56020942408377%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA4ElEQVQY002PWbaEIAxE3ZGt+OUADswK6um3/63US+jh9McFUqRyKlUIHtd5IsYdxhh473AcCVprbNuG6zphnYOzDjklxH3H0PcYxxHzPGOaJgzDgObxQF3XqFhkI6OkwrquBTZIKbHQv1KqsCxLgQfwIKbvh9K7kl9STxVCwN/ziUwpc86475tSXdgpCd+see8RQsRJPZ764x5pi4O2ikUvb+q31qJKKcMaC0cm/0ZrUwaygWvFq41TScxwwldq0uX02oZqTlzxIUSLpmkKbdt+7w9CCHRd94Xrj/b7Zv4BCTWvr+J+9H8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Question 3&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/b4d5c69899291c70e03028ebcebea130/fb8a0/3a.png&quot;
        srcset=&quot;/blog/static/b4d5c69899291c70e03028ebcebea130/1a291/3a.png 148w,
/blog/static/b4d5c69899291c70e03028ebcebea130/2bc4a/3a.png 295w,
/blog/static/b4d5c69899291c70e03028ebcebea130/fb8a0/3a.png 590w,
/blog/static/b4d5c69899291c70e03028ebcebea130/526de/3a.png 885w,
/blog/static/b4d5c69899291c70e03028ebcebea130/5be35/3a.png 955w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Here I use File &gt; Export Objects &gt; HTTP to view the HTTP Objects List:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/eb05b6b482c881cf6fc62658bf354ea7/8c774/3b.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 67.47491638795987%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACDklEQVQ4y52SeXOaQBiH+f5fptOkMW018YriGUAEUURRUzWHgIKTeD5dSNLjj6QHMw/vu+zuM78dVioWcjQbZXSljmmZWEYLU1df0KhWylzlLihmL8lfpsldpKmWi5SKWaqlLM2aTFGuUa9WEqT2wEF3HEzXRdZ6yMaYmjmi3plQNUZUOzdcaQ6yPuBKtWl2b1D7M1R7hvJCwxxSbbdFbyOlHJ0P7RofjTopdUzaWvNFvxc8iPEdp5rHue6TMX3SxoJ8L6Q8fKI0eEwouxsKvYAT45qUayJ1/Szy4BRt9pUomvP8bAW7d9j/wpHdU4jc+4Qy/YzU8YtU3HMxyHDvz9mLNZvtju1un7B5qT/ZJfOv7PYHlmFIY5TB8PKxsEBlmEqEi2DO8SAyiE3vs//RHw4HonWINs3hrMtCGOSojM6oT8558Gccj8/CvYj6J56FR8JoRaFzSmV8hjRcKrSnMvpNSQhv/0MoEkYhzX4BfVpCms/mLB4WTL9N8TxPCI9/ceTdb0der9dMxhO8hYdki7vjukOsbhfP9/9ZGCeNojVBEIi9B6S4Wa2W3N7dsVoGyaV575iHGJEqrkdRk/Xbx0QYf5fiV5xqs3lCMW0Mq0dfpLbfoGv3sawuPdE7Q5da3eJMdvCCZeKRXmNvNxu0dofGtfhJuo7+BlqrhaIoqJqGoqpk8k1OCjqrMEoSfgckSMTGdm20PwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Question 3&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/eb05b6b482c881cf6fc62658bf354ea7/fb8a0/3b.png&quot;
        srcset=&quot;/blog/static/eb05b6b482c881cf6fc62658bf354ea7/1a291/3b.png 148w,
/blog/static/eb05b6b482c881cf6fc62658bf354ea7/2bc4a/3b.png 295w,
/blog/static/eb05b6b482c881cf6fc62658bf354ea7/fb8a0/3b.png 590w,
/blog/static/eb05b6b482c881cf6fc62658bf354ea7/526de/3b.png 885w,
/blog/static/eb05b6b482c881cf6fc62658bf354ea7/fa2eb/3b.png 1180w,
/blog/static/eb05b6b482c881cf6fc62658bf354ea7/8c774/3b.png 1196w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Thoughts on Windows Internals (Defense Against the Dark Arts)]]></title><description><![CDATA[Memory Root kits - way to intercept the regular program flow so you can hide something on the machine. Can also apply to Windows, Android‚Ä¶]]></description><link>https://michelelarson.com/blog/security-windows/</link><guid isPermaLink="false">https://michelelarson.com/blog/security-windows/</guid><pubDate>Thu, 07 Feb 2019 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;Memory&lt;/h4&gt;
&lt;p&gt;Root kits - way to intercept the regular program flow so you can hide something on the machine. Can also apply to Windows, Android, Linux, etc.&lt;/p&gt;
&lt;p&gt;Windows OS 64 bit, introduced the concept of digitally signing code = decline in rootkits but then they found their way around it.&lt;/p&gt;
&lt;p&gt;Most root kits try and go into the kernel mode because they have power to manipulate anything in the system. Kernel memory is flat with no security separation, so any kernel driver can access any part of memory.&lt;/p&gt;
&lt;h4&gt;Tools&lt;/h4&gt;
&lt;h5&gt;Cuckoo&lt;/h5&gt;
&lt;p&gt;After running Cuckoo (from previous week), you can inspect what it outputs in &lt;code class=&quot;language-text&quot;&gt;C:\Analyzer&lt;/code&gt; and run the following commands to see what comes up (dir calls different APIs):&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;dir *&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;dir*.*&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;dir *.sys&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;dir bin&lt;/code&gt;&lt;/p&gt;
&lt;h5&gt;RegShot&lt;/h5&gt;
&lt;p&gt;System diff tool- run before malware, run after, compare diff&lt;/p&gt;
&lt;h5&gt;Tuluka&lt;/h5&gt;
&lt;p&gt;Click on SST tab, then sort by suspicious column to view files that may have been modified. In this example NTQueryDirectoryFile shows up. These APIs passes information to the kernel. You can hook into this call and intercept it to do something else.&lt;/p&gt;
&lt;p&gt;You can see columns for ‚Äúoriginal‚Äù and ‚Äúcurrent‚Äù pointers which then you can use to inspect what is there at that memory address.&lt;/p&gt;
&lt;p&gt;Right click on a file in Tuluka and click ‚ÄúRestore Service‚Äù to see the file show up in the logs folder. Then you can investigate it.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Agony Rootkit Analysis Lab:&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/f96482b127ac799ffaa208b699e954cd/cf471/lab1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 35.76158940397351%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAByElEQVQozy2R227TQBRF8zmIiwoFJMTtAap+QsRNUB5AAgolSZHgN/oPqBIq/EPaQuGhFbQNOLZn4lzsxIntuM3FcZNocRr1YWtvnT2z58w5mfUvX9nY+Ebx52+29yw2990zeGyXfIp/PL7/bbN10BTusFMO+WGccjDTv8yQPavN/oHJYXGLTKPRwHGcGbRWaKXw/RZR0KbmedTcGu22S72uKDdK+B2Po25EFAaEQYe4GxKK7sYxfhSTURJgWBaW1tiVCsptoT2fSrWGYStUrYqui1Y2h2aZkmnhnDbRcPkn2rBtlJytui5a7mfam0WGd26S3LpBsrjA9EGWyaOHjBbv0790nvTaFdL5OdK7t0myWZInjxkt3GN89fLMG8xdJL0+z/jCOdy1NQnc3SXJvyct5Bl+KNDJrRDmcgw/fWS8mid9t8zJyluGUj/1gtUC0ZvXBEtPCZ8vCT8jfvmC6fIrKp/XyfhBQDSZ0gfhCbbvozsBrcGQY6mNznAkMOSbZa9JJYzQUYQKQ0y/g9sfMBFfey3pUAJiMYa9HrGEO0pmaZTRlk2z3qDXjTlJEo673VldmSa1iixRZu/IjHXZoikPTdJUlurwH9aK2EmsztbmAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Tuluka&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/f96482b127ac799ffaa208b699e954cd/fb8a0/lab1.png&quot;
        srcset=&quot;/blog/static/f96482b127ac799ffaa208b699e954cd/1a291/lab1.png 148w,
/blog/static/f96482b127ac799ffaa208b699e954cd/2bc4a/lab1.png 295w,
/blog/static/f96482b127ac799ffaa208b699e954cd/fb8a0/lab1.png 590w,
/blog/static/f96482b127ac799ffaa208b699e954cd/526de/lab1.png 885w,
/blog/static/f96482b127ac799ffaa208b699e954cd/cf471/lab1.png 1057w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h5&gt;Live KD&lt;/h5&gt;
&lt;p&gt;Run &lt;code class=&quot;language-text&quot;&gt;u 82e4daf&lt;/code&gt; where 82e4daf is the pointer in memory you want to see. This shows you the code that that pointer.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;lm&lt;/code&gt; - lists all modules loaded in kernel memory with their addresses&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;nds&lt;/code&gt; - lists all system APIs and shows the address of where each call is (SSDT - System Service Destriptor Table). In your system, you can put your code in that location, put your function pointer there instead of original, but save the original address so you can call back to it.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Agony Rootkit Analysis Lab:&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/adf62a58da40cda3104682f227553e7d/51273/lab2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 55.46875%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACGElEQVQoz41SS4vTUBi9fcS06TtJkz5o00fSNNB200I3IzqK4F5BRkRmI4rgY/BBN/4L0cVYxXFwql2Mjji1DgyuRAYEF/6f4/0+iCLOwsXhJt/rnnPuJxaH3zB/f4A3u0tszxd4NV/i5fwA0519bG7vYfP1RzyffcJ0tsR09yse7xzixeIHtj7/xLO9I2ztf8fb5RFmH77g3ZOnEBfOnUe90UDQDeB5HnK5HPSCDsuyGIZuMGzLRqFQgGGY8tShy1hR5vlbxsqVCuyaA7G2dgXtdhvdbhetVgvlcpkbs9ksNE1DOp1mKEocsVgMCVXluKIoUOW3qp6AlkxyTEskIDYeTOB3OnBdF77vo16vIxKJMLtcPs+Mq9WqPPNIyqZiscgXW7aNVCrFeVPGdF1HXtaL67fuSbk+hsMhRqMRsxFCoFarMctSqYTBYICGtIVAcQINoLp/cOP2fQz6PaysnOTCMEFM2U/ZSBYc23wcLl5eR7PhYCjZ9ft9ZpXJZGBLSTTMMAz21TTN3xIpT3WUp5NiJJfi4tLVa+h4Lnq9HjOMRqPsIRUkpdlURAzpEShHDxMiHo//9U95cefhI5xdPY3xeMysQurkFw2tyHUIgoAH/pfkmxsTnFk9xY8SPgTdRjtJD0JwHAcJuRJ/VkVl+RSjdSEVzI4H3p3Ac1u8Cs1mk9cl9JCkkj8h29ACAnlLl1MN9ZB8GvgLoKg2zjSVzLoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;LiveKD&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/adf62a58da40cda3104682f227553e7d/fb8a0/lab2.png&quot;
        srcset=&quot;/blog/static/adf62a58da40cda3104682f227553e7d/1a291/lab2.png 148w,
/blog/static/adf62a58da40cda3104682f227553e7d/2bc4a/lab2.png 295w,
/blog/static/adf62a58da40cda3104682f227553e7d/fb8a0/lab2.png 590w,
/blog/static/adf62a58da40cda3104682f227553e7d/51273/lab2.png 768w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h5&gt;WinDBG&lt;/h5&gt;
&lt;p&gt;You can go into View and Memory and overwrite the memory of a program.&lt;/p&gt;
&lt;p&gt;You can set breakpoints and step through the code.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Agony Rootkit Analysis Lab:&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/1e5f56dd53ec38144f6ce705b6bda08c/b7cef/lab3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 58.71670702179177%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACGklEQVQoz5VSaW/aQBD1//8n7ZemOSrEYQgOtjkiriSAMOa08UEwPgBjwK8766SqVFVqR3qa2dl5M2/WFqTWEN2RAaU9gtKbotadovysodrWUVTfUJDfkJdfUW6OUHtZo/Li4oeqcxTbJp4GW9THPlpDC52+DqGQz0N6UvBYlVGpKhBFBRVRRq4gIZd7hKy2oagt1JQ2ylITVakFsayiWJLZXYdxnlmuzrkVSYXw5dsDvt6LuC0p+F5UcJOXcSfWcVOQM+Rr7KziodLEfbmRebHBcll8V2ownsxrbpkXxpMZ4uSCXbCH50fYeD4s9x02g/vuYbW24Yd7HOIEQXRAuI9xvoJb+gGyIDoiuaQQNE3D6RQjCgOGEFEUwrYteN4WruvgfbOB49gwVisslwuYpgHXcXht4PsIP3jk0/QKodPtYcWKZ7MZB8Xz+RyGYbAGSx7bts2aOmyAy+P1eo0NG2SYJrbbLQfdX6+sYbfXh6aNMRgMOJmwWCyg6zqPiRgEAYfPFO12O+4JlKOz53ncp2maKaRm/X6fK6JmJpscsjVoIhX9jwmNZgv0juNxppKkn89n3jyKol/r0wBSRGdame5IJa1LCj9joV5vYDgccmQf6MSVEfFwOGAymXCQagK9Mb0l1Vwulz8gKKrKm41GIz6JjBTS6sfjEZZlIY7j7Df5h/UFfTrl69Dj0xqfxCRJuCeVpPp3o/zf8BP6knIlYn7CbQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDBG&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/1e5f56dd53ec38144f6ce705b6bda08c/fb8a0/lab3.png&quot;
        srcset=&quot;/blog/static/1e5f56dd53ec38144f6ce705b6bda08c/1a291/lab3.png 148w,
/blog/static/1e5f56dd53ec38144f6ce705b6bda08c/2bc4a/lab3.png 295w,
/blog/static/1e5f56dd53ec38144f6ce705b6bda08c/fb8a0/lab3.png 590w,
/blog/static/1e5f56dd53ec38144f6ce705b6bda08c/b7cef/lab3.png 826w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/537e985411249ea3b2a803ae984004cc/cc794/lab4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 587px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 78.19420783645657%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACfElEQVQ4y4VSiU7bQBD1//9DJaRKLS2VKg4VqraoUJxAnMT4zOEjTuzEbYJPcCBtktedNaQQBWrpaWZ3xm/nzYywe3iGqtzBD8nE6bmGo9Mmjs5UHIk69o4b2P9Wx95XCQffZW7fH5xi/1jCx88VHJ7U8UVUWL6Ck91PqGy9gtDpWrAsC/3+ALblYDDw2dmBHwzR6dC9D9NowXF6cF0P7XYXLbODntfnZ8pxWewqyzHJCwiu48KxbYxGI2RZhixNkSQJUmbTNCnPccx9Dhbj8aSMpfe513mGnFmBXvb9AGH4E0UxRZbnjDgvybN7P8//3T/2s6d+QoTxZIwsjpBEE8RXzE8i3BbXHNMbhuusxM0D8o24ZShYniAZLs7kNiTdgSi3UNNtWEEE0/sFexhhlP1hmCNIf/8XfjKD8EEK8fZihNcnNnYuhtg+D7BdHeCN2Me26GGrEmLrIsKOOsU7pcCONmUoNkO9gWDqKhyLTc2xoCnyCorcgNyQQPFw6CONr1jTY2A5x/PfEoIsy5AvL9lgfNTrddRqNSiqikqlClXToKoabNvhq0WDo2+xWGK5XAcwXywgNJtNKIrC9qnDLZHSHUHjhCr6gwHbxz5frdlsVtayRlg+xAhFUeQ/U6XtdpsT67qOVqsFwzDQ6/UQRRHyvFyloihWhCuhjwmr1Sonu2SyqRoiokrJdrtdJrdcekpeJ3iWkAioSiIkmVSpaZocYRhiMplgPB7j7u7uidwXKyRLUonkoa90JtnUV8M0+OAe93AjISWTPJruw5Spr/RIo9HgrXAcB0EQ8F7O5/OXCWl6w+GQv04/0hBc14XnefyO4iSZBrJJ7jrhX5w6lxDGYx2rAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDBG&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/537e985411249ea3b2a803ae984004cc/cc794/lab4.png&quot;
        srcset=&quot;/blog/static/537e985411249ea3b2a803ae984004cc/fcd59/lab4.png 148w,
/blog/static/537e985411249ea3b2a803ae984004cc/0963e/lab4.png 295w,
/blog/static/537e985411249ea3b2a803ae984004cc/cc794/lab4.png 587w&quot;
        sizes=&quot;(max-width: 587px) 100vw, 587px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/c5e397daa2c3b0c8949be8a10d6085f0/45fcc/lab5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 46.04221635883905%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACC0lEQVQoz12Py1PaUBjF85d32UUXfey66KLWceFYVBAfCNWqQCDyDIJAeGMTFfIgQRQI/nqNUxe9M2fO+c6595tzpdjBb+R4ikwixfn+KWeRE+IbYWJrIRLruxz/2A54X+BwfYeD7ztEP60T/rhG5PMr77z/SujdF6IfviGlLouksznkyxKpbJ5ktsyFXETOX3GaLpDOX6OoDfLqNbmyhlyoi7lNptREFshXu2TUjoCGUtWQwrEEW5EYe6Jl7EwhmpCJHF0QOU4TEo1/Rk/YPjgVfkp4SUJCR2Ln7B6eExLZXjxJ+OhVb25sISWVKmeZCoWrJqVai+Gdzb0zQx+7GKbHrTUNvMGtzc29E6BvmEHW003xkwpqvUux2iKXKyHliyr1WpV2S6Pf6zJ/euTlTBybW0Nn6rmBb45HOLaJJfifz/MKf7lg5S8D+AJStnBFuVyi3e4wGAyYz+fBQsuyGQ5vcJwJmqZhmmKZbQesGwbedMr/x/d9JKVURa2otDtd+oMhD7PXhmPTCmbbcWg0m4zGJqZlBfxH15m4Lv7qmaW/YrH031gqqlU6zRr6sMedPmBijVg+TlnMXKx7Q2gP46bPzLV49ByephM8x+QhmG0W4q4r3rxkoiPSkVwjmmkSLw1JNsbURz6ayJKtCb8qBumOS7zYJ9t1UXoe2c4EpeNQN+FaQLN4042xz1/Gwn6vuagg1wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDBG&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/c5e397daa2c3b0c8949be8a10d6085f0/fb8a0/lab5.png&quot;
        srcset=&quot;/blog/static/c5e397daa2c3b0c8949be8a10d6085f0/1a291/lab5.png 148w,
/blog/static/c5e397daa2c3b0c8949be8a10d6085f0/2bc4a/lab5.png 295w,
/blog/static/c5e397daa2c3b0c8949be8a10d6085f0/fb8a0/lab5.png 590w,
/blog/static/c5e397daa2c3b0c8949be8a10d6085f0/45fcc/lab5.png 758w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/c7860bfa6222ab6ad1358480ea51e344/c7177/lab6.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 32.61074458058435%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABbklEQVQoz4WO3U8aURBH92/3AX1AUzUaq7H4EWMiselDbYwQSldKWZCoaIPuggjIfrCwC4lUseweLzcqbzrJmZOZubn5KXvxb3xeixGdWyQyHWVlI05s5yu7+wfsxA9YWt9janaNyKcYM4tbgk2mFzYkM4LIfEzcV4W/EF3eRkmms6SONQ6Tv0mksvxIZPh+qMpd8leeo7RGOlMkkc6jZk9JqSeCnLjn+JnR+FM4l2jFkrSSKVxS/FtBb7Yxmi7XdUdgU74xubq1KNdMyetel56gN9pcGHeo+RK5syuUasWg2agzrtHTkG7Hpe97NOq39Hs+rmNLPqowGI0bim4YWLZDEMLg3wN3LZO262JaNvf3A3y/h+f5jIJAvAkJghfCcDILh+NPRVOqxjVNkUaM/B8+0HUdel6Heq0q7VgtkdCS95cs76KkzhsUaz5VH0rmI2rZQRND4cbn0h5y0RpQth8xPAQhFWnerHcnHu+eAbFQ80d126t3AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDBG&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/c7860bfa6222ab6ad1358480ea51e344/fb8a0/lab6.png&quot;
        srcset=&quot;/blog/static/c7860bfa6222ab6ad1358480ea51e344/1a291/lab6.png 148w,
/blog/static/c7860bfa6222ab6ad1358480ea51e344/2bc4a/lab6.png 295w,
/blog/static/c7860bfa6222ab6ad1358480ea51e344/fb8a0/lab6.png 590w,
/blog/static/c7860bfa6222ab6ad1358480ea51e344/526de/lab6.png 885w,
/blog/static/c7860bfa6222ab6ad1358480ea51e344/c7177/lab6.png 1061w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/d12600d8b837ea3a9b26f10f7b2fa845/f171e/lab7.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 31.28390596745027%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABSklEQVQY032ObUvCYBSG9+eLsg9JbxBWKIVQGGJR0Ae1cr2oTYuKjFxWq5VPezanRTNoV0+LXuhDN1wczn0fzjlaOpMjs5xjOpEkNhJndDzB7EKWhaUV0pk1puYWGRidZWhM5ZPzDI+nFMmI2ESKwfgMI5Mp4tNpFnN5tOzqOhvFPfKlAwolg4JuqL5MccdQ1MjrNbZ2DyNK5WM2d+ts7RmKGvvGCeX6KXrlKKKwuYNW1CvUjxtcXN0i/Wfu2pI7ITFvbNrSx/GfePR6CK+LcL/oRbUtuzyomYZ5zfmlxVmjiVatVjHNJq6UfEg6DkII7m2b136fIHihHwQqCflR+Kf/kXZQrdBSCz3XiYyP6jqCB/uW515XHXrE99xfC8J/eEPb3q9xdH5F0xL0XqF172HaklPT4kb4kW+JDr56shOE3/i/+PRU/hLyDpHkqt2enoQzAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDBG&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/d12600d8b837ea3a9b26f10f7b2fa845/fb8a0/lab7.png&quot;
        srcset=&quot;/blog/static/d12600d8b837ea3a9b26f10f7b2fa845/1a291/lab7.png 148w,
/blog/static/d12600d8b837ea3a9b26f10f7b2fa845/2bc4a/lab7.png 295w,
/blog/static/d12600d8b837ea3a9b26f10f7b2fa845/fb8a0/lab7.png 590w,
/blog/static/d12600d8b837ea3a9b26f10f7b2fa845/526de/lab7.png 885w,
/blog/static/d12600d8b837ea3a9b26f10f7b2fa845/f171e/lab7.png 1106w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h5&gt;Process Hacker&lt;/h5&gt;
&lt;p&gt;Similar to Process Explorer. Clicking on the Memory tab, you can see the memory starting at address memory 0 and walk through the virtual memory of the process, identifying some attributes about the process. It‚Äôs very suspicious if you see anything that doesn‚Äôt have a name and has read write execute permissions. Example: &lt;code class=&quot;language-text&quot;&gt;Private (Commit)&lt;/code&gt;&lt;/p&gt;
&lt;h5&gt;SectEdit&lt;/h5&gt;
&lt;p&gt;You can go to any sector and read the contents from the disk. You can see the MBR here. &lt;/p&gt;
&lt;h4&gt;Thread Basics&lt;/h4&gt;
&lt;p&gt;Thread - smallest unit of execution within an operating system. &lt;/p&gt;
&lt;p&gt;When you launch a program, the binary sequence gets loaded into RAM before anything happens. Then, using a BUS, it transfers the code in the CPU. It fetches each instruction and executes it.&lt;/p&gt;
&lt;p&gt;A thread scheduler‚Ä¶ schedules the threads ‚ò∫Ô∏è When creating a thread, you can use an API to set priorities for when your thread runs. If a thread is doing work and then another thread was doing work but now is waiting, it needs to save its context somewhere so it can come back to what it was doing. That gets saved in memory while the other thread is being executed. When it comes back to the second thread, the context is restored. Each thread has its own stack. Processes need at least one thread to execute, and each process includes an object table that has handles to other objects known to this process.&lt;/p&gt;
&lt;h4&gt;Hooks&lt;/h4&gt;
&lt;p&gt;Malicious code can hook into a process in user memory. For example, a process might do a call to a function at a certain memory address that will start with an instruction. The malware can change this first instruction to jump to another memory location and run the malicious code. &lt;/p&gt;
&lt;h4&gt;System Boot Process&lt;/h4&gt;
&lt;p&gt;&lt;img src=&quot;https://i0.wp.com/neosmart.net/wiki/wp-content/uploads/sites/5/2015/01/MBR-Boot-Sequence.png?resize=1024%2C385&amp;#x26;ssl=1&quot; alt=&quot;MBR Boot&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://neosmart.net/wiki/mbr-boot-process/&quot;&gt;(From here)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Now Microsoft has a Secure Boot which validates the process at each step.&lt;/p&gt;
&lt;p&gt;Bootkit vs rootkit - bootkit just modifies the MBR, but has no stealth component.&lt;/p&gt;
&lt;h4&gt;Trends in Stealth Malware&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;File forging - rootkits could modify a file and when you‚Äôre reading the file, they show you a different view&lt;/li&gt;
&lt;li&gt;Memory forging&lt;/li&gt;
&lt;li&gt;Self protection&lt;/li&gt;
&lt;li&gt;Attack AV&lt;/li&gt;
&lt;li&gt;Disassociating memory from file on disk - Root kits can utilize APIs that give away its associated file on disk&lt;/li&gt;
&lt;li&gt;File content foraging - modify some files on disk. If you try to read the file, they can insert anywhere on the chain&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Thoughts on Hacking Challenges (Final for Defense Against the Dark Arts)]]></title><description><![CDATA[Invite Code I first go to the website and open the Developer Console tools and refresh to view all of the network connections. I inspect‚Ä¶]]></description><link>https://michelelarson.com/blog/security-final/</link><guid isPermaLink="false">https://michelelarson.com/blog/security-final/</guid><pubDate>Thu, 07 Feb 2019 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;Invite Code&lt;/h4&gt;
&lt;p&gt;I first go to the website and open the Developer Console tools and refresh to view all of the network connections. I inspect each and the contents that are transferred but don‚Äôt see any useful information. I also inspect all of the files being loaded and content on the page.&lt;/p&gt;
&lt;p&gt;Based on the lesson from Week 7, I try hacking in through modifying the form but only get this message:
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/068865db877e9e99bf66ac553f4b28dc/8e816/final1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 440px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 53.18181818181819%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABxElEQVQoz3WSyW4bMQyG/RpFEs8iaRaNZt+8zNix06BBLy2CFkURtCnSXPL+D/CXkmzP5NDDB1ILf5ISF57guHHFDG64dpixS0/ADwRcTjBOWF/HLT0bq62+p1noS3qDRRw8tgcej8ACaezVkuHKcQmHghk+XLsmmcv/I6g3WMhRjz6KwUHZlfj7+oZfzy8Y9kd8ffyOp9/P+PH0E18ev+HPyyvyqqVE/kmEv+ts4VCFPglWJFgNHqJMot/couo2SMsWRb3C/niPbruGyisj5ovo8hxzjGCgGLyAUcuMhO27uSx617bGYT616piWdXU3pzeeY1rWD66qDGGSI4gLxGmJSJUXa0gKJFSdJk4ryKw2NpS5QcTpVKHLA8i8JtEaedNhu7/HajxiPd4Zu//4Gf32gH44YDx+otZvsbt7IP+BEjQGnXQSpDGQWQNVNEhJNCmmKtr1Ds1qpERrtJsd6n4wZ2dsXGv8S8sOC8ymKjuiRUZVpvTwKa3Pldb9aPzVeKCK6G7RnbD3dPKZoACPEohIIUgIaRGxot+UNNTSnGufhRKhUrSek9LnJdPY2DniZmhdbtG+w9hpYCdsFdOdc9z8l/8BREpIy3EKYygAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Form&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/068865db877e9e99bf66ac553f4b28dc/8e816/final1.png&quot;
        srcset=&quot;/blog/static/068865db877e9e99bf66ac553f4b28dc/e5da5/final1.png 148w,
/blog/static/068865db877e9e99bf66ac553f4b28dc/2629f/final1.png 295w,
/blog/static/068865db877e9e99bf66ac553f4b28dc/8e816/final1.png 440w&quot;
        sizes=&quot;(max-width: 440px) 100vw, 440px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I do see a javascript file being loaded called ‚Äô&lt;a href=&quot;https://www.hackthebox.eu/js/inviteapi.min.js&quot;&gt;/js/inviteapi.min.js&lt;/a&gt;‚Äô which looks like a minified javascript file. I execute this script in jsbin.com but change ‚Äúreturn p‚Äù to ‚Äúconsole.log(p)‚Äù to see what it says:
&lt;code class=&quot;language-text&quot;&gt;&amp;quot;function verifyInviteCode(code){var formData={\&amp;quot;code\&amp;quot;:code};$.ajax({type:\&amp;quot;POST\&amp;quot;,dataType:\&amp;quot;json\&amp;quot;,data:formData,url:&amp;#39;/api/invite/verify&amp;#39;,success:function(response){console.log(response)},error:function(response){console.log(response)}})}function makeInviteCode(){$.ajax({type:\&amp;quot;POST\&amp;quot;,dataType:\&amp;quot;json\&amp;quot;,url:&amp;#39;/api/invite/how/to/generate&amp;#39;,success:function(response){console.log(response)},error:function(response){console.log(response)}})}&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/63b5613b5a6829174d6d4ced50d67b10/6a24b/final2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 17.391304347826086%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAi0lEQVQI14WOywqDMBBF/f+fC9WtG6kGTGwSm4eBGk+NUOii0IHDhTsDcxrlEsEnso9sX+SQSHEjxExIGWU0yinUqpjdjF71lT54Uopo63nYlYZSKHtl/0HhVXflYDADt+mGGAWd7Ghli5gEve6RVjKa+/lspjn4P8d5ZL277KrZ8lyurHy6amu84Q0y2OXXUX0m1gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;JS File&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/63b5613b5a6829174d6d4ced50d67b10/fb8a0/final2.png&quot;
        srcset=&quot;/blog/static/63b5613b5a6829174d6d4ced50d67b10/1a291/final2.png 148w,
/blog/static/63b5613b5a6829174d6d4ced50d67b10/2bc4a/final2.png 295w,
/blog/static/63b5613b5a6829174d6d4ced50d67b10/fb8a0/final2.png 590w,
/blog/static/63b5613b5a6829174d6d4ced50d67b10/526de/final2.png 885w,
/blog/static/63b5613b5a6829174d6d4ced50d67b10/fa2eb/final2.png 1180w,
/blog/static/63b5613b5a6829174d6d4ced50d67b10/6a24b/final2.png 1357w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Here I see maybe I should do a CURL Post request to &lt;code class=&quot;language-text&quot;&gt;/api/invite/how/to/generate&lt;/code&gt;!&lt;/p&gt;
&lt;p&gt;This gives me &lt;code class=&quot;language-text&quot;&gt;{&amp;quot;success&amp;quot;:1,&amp;quot;data&amp;quot;:{&amp;quot;data&amp;quot;:&amp;quot;SW4gb3JkZXIgdG8gZ2VuZXJhdGUgdGhlIGludml0ZSBjb2RlLCBtYWtlIGEgUE9TVCByZXF1ZXN0IHRvIC9hcGkvaW52aXRlL2dlbmVyYXRl&amp;quot;,&amp;quot;enctype&amp;quot;:&amp;quot;BASE64&amp;quot;},&amp;quot;0&amp;quot;:200}&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;I try that code but it doesn‚Äôt work, so I see it also says ‚ÄúBASE64‚Äù so I try decoding it using &lt;a href=&quot;https://www.base64decode.org&quot;&gt;https://www.base64decode.org&lt;/a&gt; and find out it decodes to ‚ÄúIn order to generate the invite code, make a POST request to /api/invite/generate‚Äù.&lt;/p&gt;
&lt;p&gt;I do a CURL POST to &lt;code class=&quot;language-text&quot;&gt;/api/invite/generate&lt;/code&gt; and get the response &lt;code class=&quot;language-text&quot;&gt;{&amp;quot;success&amp;quot;:1,&amp;quot;data&amp;quot;:{&amp;quot;code&amp;quot;:&amp;quot;VFZJVk4tQVdFWEctWlpWUVMtWUdSSkgtR0FDV0c=&amp;quot;,&amp;quot;format&amp;quot;:&amp;quot;encoded&amp;quot;},&amp;quot;0&amp;quot;:200}&lt;/code&gt;. I try that code, but that doesn‚Äôt work, so I also BASE64 decode that to get &lt;code class=&quot;language-text&quot;&gt;TVIVN-AWEXG-ZZVQS-YGRJH-GACWG&lt;/code&gt;. That works!&lt;/p&gt;
&lt;h4&gt;Challenge 1 - Reversing - Snake - 10 points&lt;/h4&gt;
&lt;p&gt;For this challenge, I need to download a file, called &lt;code class=&quot;language-text&quot;&gt;snake.py&lt;/code&gt;. I open it in a text editor and also run the script and see it asks me for a username and password.&lt;/p&gt;
&lt;p&gt;First I take a look at the file:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/cf294cc9e46d89b67f5d1f6e03a19659/ad835/1a.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 61.08562691131498%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACqUlEQVQoz3WT3UtTcRzGf1ha0guWomVJiZWaiG+rdLmtpqazLZWILgryKrroqpuugi6CoH8jgiyiooKgmi8haFGhaam5pdvOzna28z63+dbTd+cUeqEXD8/DOfw+PL/v+R6m8jL0iAo9ShJJvJm1GCnzXFCR0DVDuiojubKK6Gg/vjkL8dNdjJkLhfD3FGC+Ow/cxV1giihBlzOHFRMapyyYWYsqJpTe6wpJIuDiKsLDXnyyF2HCVYLJjn2Y8RTC15VvQBkX4iDzChIxE6bHzFbr3WgbU6BGRCwklhEc+IDh08X40noIY+0H8cNzAFPuIvzy5IMFA0HE+TgUQYIqyNTu39Ul07VM1lWk00mkkwmsAIiMDuGjhYBnDmOspQQTbcWYaidgZwEBZwOI+nmIgRiUCAHDitHGaBtfG8H87G/4JqcRCITx/e0rvHZUwuuqQb+rCoPnKzDUWYZhdylYKBhCnIuZM6RWCVFbAxF4QdIRDfC4cbUXHkcrus6eQ7ezHT0kt90Jj70FbpsTHU02Qyw4PQPRL0Kek6BwMpSQRNdUjI+gSQRUCRjicbneDevOajTuqIIluxwnc4/jxPZKNFD+73VZR8DCPh/C/qDRQhAESGIcmqqYa6KpSNLcIuEwuqvaUJtVhua8GkPW3dWG2/fWwZFfb2RLTjkBOQ6BuTlwIZolHVRiogHSFBmqLGNB0xChTbjS2APbnlq07D+FZvKG7GMbigk8h4ScpHVIIamlkEqRL5GvLCL9ZwnLWIWsKbhmuwQ7NckALdvKUb/16IZiww/f4PNTL0aeePH18QDG+gYx3jeA8ef0Nzx7h/EX7zHy6CVcJVZUs1KjRebgpg17mRXXWTNuMgduMSduszbcYa24S/neFgce5NhwP7cJjuwK1K4DbQb9CxsAn5XYk6uHAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;snake.py&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/cf294cc9e46d89b67f5d1f6e03a19659/fb8a0/1a.png&quot;
        srcset=&quot;/blog/static/cf294cc9e46d89b67f5d1f6e03a19659/1a291/1a.png 148w,
/blog/static/cf294cc9e46d89b67f5d1f6e03a19659/2bc4a/1a.png 295w,
/blog/static/cf294cc9e46d89b67f5d1f6e03a19659/fb8a0/1a.png 590w,
/blog/static/cf294cc9e46d89b67f5d1f6e03a19659/526de/1a.png 885w,
/blog/static/cf294cc9e46d89b67f5d1f6e03a19659/fa2eb/1a.png 1180w,
/blog/static/cf294cc9e46d89b67f5d1f6e03a19659/ad835/1a.png 1308w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I see that it says:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;if user_input == slither&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So first thing I do is &lt;code class=&quot;language-text&quot;&gt;print slither&lt;/code&gt; which outputs ‚Äúanaconda‚Äù. I run the script and type in ‚Äúanaconda‚Äù and it asks me to enter my password.&lt;/p&gt;
&lt;p&gt;There are a bunch of arrays that hold things like &lt;code class=&quot;language-text&quot;&gt;[0x74, 0x68..]&lt;/code&gt;. I have a feeling these are hex codes, so I start converting them using this &lt;a href=&quot;https://bluesock.org/~willg/dev/ascii.html&quot;&gt;converter&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;chains = ‚Äúthis is a troll‚Äù  üòÇ&lt;/p&gt;
&lt;p&gt;password = ‚Äúits not that easy‚Äù üòÇ&lt;/p&gt;
&lt;p&gt;keys = ‚Äúpassword!!‚Äù&lt;/p&gt;
&lt;p&gt;Printing out some things from the file:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/b8e4d882189c69cf4e85382b7fcf7a9e/f449d/1b.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 66.75824175824175%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABSElEQVQ4y62S60/CMBTFG1ATFU18xGmMoDyGJhNWXpNtgLzBCEwNCBsSeWjU///7sR1qjGICyIdfzm1uenp7WtJq19GxbtA2DVs7lmHXw6cuXt766A9NDEYWRs8PeBx0mHbZ2kTzvga+l8Nrq9fEa88AMfQKiuc68pLKVENB0lAK6V+16qVQfdRWzTeuNZvID8Y9Uj1KQSbeP6HEPxOk7NERWQoguhJkiP+GVDypseGyuBBI2a1DdvgWZ1g9ZhM6Fzjh1Uka1On/1eAxzBMFqYt5JF2SPSWHm38/YFZT0ggWUBNzyAkJpLZkZIU40tt0/glLbg35AwWZ3Shy+wlc7sUQ419oQgRTGbbC17iTqigeqsxQQXonCuoIfETArs9+wGcE05iS23ABDSmLjEARXxehbJwi4RIRXz1DbE1CcjOEC5bxpIebxDvKt3tdjWTgcQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;snake.py&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/b8e4d882189c69cf4e85382b7fcf7a9e/fb8a0/1b.png&quot;
        srcset=&quot;/blog/static/b8e4d882189c69cf4e85382b7fcf7a9e/1a291/1b.png 148w,
/blog/static/b8e4d882189c69cf4e85382b7fcf7a9e/2bc4a/1b.png 295w,
/blog/static/b8e4d882189c69cf4e85382b7fcf7a9e/fb8a0/1b.png 590w,
/blog/static/b8e4d882189c69cf4e85382b7fcf7a9e/f449d/1b.png 728w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I take a look again and see that for the password, it‚Äôs checking if each char you type in for the password is in the chars array. I print the chars array and see a bunch of numbers. I use that same URL to convert each to its char value, and get keys = &lt;code class=&quot;language-text&quot;&gt;udvvrjwa$$&lt;/code&gt; and chains = &lt;code class=&quot;language-text&quot;&gt;-rs}*k*-|yvv&lt;/code&gt;. I try entering &lt;code class=&quot;language-text&quot;&gt;udvvrjwa$$&lt;/code&gt; into the submission box. It works!&lt;/p&gt;
&lt;h4&gt;Challenge 2 - CRYPTO - SICK TEACHER - 20 points&lt;/h4&gt;
&lt;p&gt;This looks like a classic crypto challenge. I first think that one of the words might be ‚Äúteacher‚Äù but the pattern doesn‚Äôt fit any. I notice that ‚ÄúIKW‚Äù repeats and I think it could be ‚ÄúTHE‚Äù because there is also ‚ÄúIKWYW‚Äù which could be ‚ÄúTHERE‚Äù. When I put in ‚ÄúTHERE‚Äù, I notice the next word could be ‚ÄúARE‚Äù. I fill in all of those letters. Next I figure that C = O because I have T? which is probably TO. Next I notice OR?ER so I think S must be ‚ÄúD‚Äù. ‚ÄúHMS‚Äù so far translates to ‚ÄúA?D‚Äù so I think ‚ÄúM‚Äù = ‚ÄúN‚Äù. ‚ÄúB‚Äù must equal ‚ÄúI‚Äù since we already know what ‚ÄúA‚Äù is and there‚Äôs no other single letter word. Next I guess ‚ÄúJ‚Äù = ‚ÄúS‚Äù because of ‚ÄúIKBJ‚Äù being ‚ÄúTHI?‚Äù and ‚ÄúBJ‚Äù being ‚ÄúI?‚Äú. From there, I keep going and guessing letters until the entire sentence becomes clear. (Although I regret wasting so much time filling in the entire thing since the flag is at the very end ‚Äî this does occur to me that it may be at the end, but I keep going since I do want to solve the entire cipher.)&lt;/p&gt;
&lt;p&gt;Starting out:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/e8f65b1212a6a7fdbfb05969bf14df69/2074a/2a.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 70.4161979752531%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAABO0lEQVQ4y62T6Y6DMAyE8/7PuRVHgBDus9l8BiOq/VNtizRyYjtm7EmMtTas6xqWZfkKDAW/+Zm6rv84n8/nv2HKsgz7vodt26R11h8VpGVYOudClmVhnufPWi6KIsCyqiqBFhdbHxaQR9x7H8pobWFlT65vvJBxrjoK5vYIVtFBcZLwoxpjYByqInu9FToi4nQGjBYAFGUPI+w4joK+7yV5GIbDnn72xMZpukZliniwbVuhrS0BLSotRtt1nfi6Plpfv+RhicNURIFdnufnHFzAJ6OIPlrTq/SWKGmaXu1SBLaIoSLxZyvFM2Fizx8BmCdJIizJlZfiThWVftM011oU9McomNk7l978PB7SKkizNNwZ0zosyuoQCrZ3oaYohorDWlom6QqMgxzS14LV9XpeHQYvr+q0d/D9AklXQIe71tUJAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Starting out&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/e8f65b1212a6a7fdbfb05969bf14df69/fb8a0/2a.png&quot;
        srcset=&quot;/blog/static/e8f65b1212a6a7fdbfb05969bf14df69/1a291/2a.png 148w,
/blog/static/e8f65b1212a6a7fdbfb05969bf14df69/2bc4a/2a.png 295w,
/blog/static/e8f65b1212a6a7fdbfb05969bf14df69/fb8a0/2a.png 590w,
/blog/static/e8f65b1212a6a7fdbfb05969bf14df69/526de/2a.png 885w,
/blog/static/e8f65b1212a6a7fdbfb05969bf14df69/2074a/2a.png 889w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Everything solved:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/8a7cda381c9a31730c60215003a9fbe5/e094c/2b.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 88.04960541149944%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAAB2ElEQVQ4y6WUW6+aUBCF+aFt0lbbU4/tU/tjfTMx3gAREAQv4HS+gbFqYpqeY7Ky956ZzGWtwWA8Gsh49EXGrwMZDj7I1+HHe6jt+8sn+f3rp+HH69Divj3EjF4+G4L1ei3b7VbSNJUoimS320ld11JV1R32+73h0f6IgGRVVUutjyzLpGlaec8vyLQzq6woikLO57M5LpfLmxAw6ul0kuPxKG3bGt6azBKGYSh5nhuHi8VCKuXvXSNHmjCOY9lsNoYkSSRRXl0oioEEv/py5Rm7xyIkfuJpLiAZFwyI4gk5EQtOoeRwOBgtdteTNycb4f49KpOM1aEid++UQmVZXoNvT1DXh/7UhJrYNVBRtrp7haT9KOwhnXKS2PcTG2/G4x7H9z7uJLeRGZfgzplbpwTR+f+KFCyXS6sWa7LVatVXj6Wzx1bZCfcuwVpj8VM06ptiKttDAgHGsiyuI2S9wq42HLlIcOZ3wL1pmq5DqoQ36xP3otAxNIQKVIcjT3Sr+rFX3UQJ7c/hb5e+V7Z7mgTRfFQKY3NaENL3EjuJgyjqdrDjI7yOi9131HnzbnPl6qkoBGZZaiL4twwX3dlebY94+i3PZjOZTqcymUxkPp8Lb1T/1+9Zwj/NK02oYdUeDQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Everything solved&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/8a7cda381c9a31730c60215003a9fbe5/fb8a0/2b.png&quot;
        srcset=&quot;/blog/static/8a7cda381c9a31730c60215003a9fbe5/1a291/2b.png 148w,
/blog/static/8a7cda381c9a31730c60215003a9fbe5/2bc4a/2b.png 295w,
/blog/static/8a7cda381c9a31730c60215003a9fbe5/fb8a0/2b.png 590w,
/blog/static/8a7cda381c9a31730c60215003a9fbe5/526de/2b.png 885w,
/blog/static/8a7cda381c9a31730c60215003a9fbe5/e094c/2b.png 887w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/d505c30fd9213092fe42af8f81b67545/89502/2c.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 35.169082125603865%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABG0lEQVQoz31R7W7DIBDL87RdPggcH4GkSbaqUt//eTwf6dZNk/bDMnCHD5vGpAG9dzAhw8aFa0HrAy5S0ErAIBZWJthUIMXi3AvOgyOk4tQ7dC7CTQtOnUUT14gw7wjLXnmMM8akWCme0dmA3k3oRRHxNh5o7QudSxjYe+GAJmwGsghcSZBppZBOK0TGOAnhYcgmKTxsJkdPoUDhUAWVFfriRsVMSJzi6yRtbN3XdF504S+eYj+h/VUw3wTr7XHkR1tquaewrl26MsN8nGmO7BnksK8Wx1D4mMKotnqmeTauOPj5HZLXWjS8PJCH2jw/+ff+VS9VqNY1Q+NpeU6I1ztxQ9ru8MsH89z5o/s3yz/71ib4vNHNyl92+AQOxeWnMYChdgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Entering the answer&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/d505c30fd9213092fe42af8f81b67545/fb8a0/2c.png&quot;
        srcset=&quot;/blog/static/d505c30fd9213092fe42af8f81b67545/1a291/2c.png 148w,
/blog/static/d505c30fd9213092fe42af8f81b67545/2bc4a/2c.png 295w,
/blog/static/d505c30fd9213092fe42af8f81b67545/fb8a0/2c.png 590w,
/blog/static/d505c30fd9213092fe42af8f81b67545/526de/2c.png 885w,
/blog/static/d505c30fd9213092fe42af8f81b67545/89502/2c.png 1035w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Challenge 3 - CRYPTO - YOU CAN DO IT! - 10 points&lt;/h4&gt;
&lt;p&gt;This challenge is a text file with the letters &lt;code class=&quot;language-text&quot;&gt;YHAOANUTDSYOEOIEUTTC!&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;My initial thought is that the challenge is called YOU CAN DO IT! and there‚Äôs an exclamation point and all of the letters in ‚ÄúYOU CAN DO IT‚Äù, so I think maybe I need to unscramble the rest of the letters. I take out the letters for ‚ÄúYOU CAN DO IT‚Äù and see what‚Äôs left.&lt;/p&gt;
&lt;p&gt;After trying many combinations:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/683a1052fdc0e186e9e7b69418634ca2/edd88/3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 47.288503253796094%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABAElEQVQoz52SXWuDMBSG8zf8FlGYV4LEqahQ2XQ2QWNbOnvbu10Nuv1/3iWBjvZisHrx3JyEJ+85J+QyCXx/MIjzFjPbYx53EHwG6zneXga8bjrsxQGXzy9dXw4nHHdHyTsmNkmErqu7CtLUNRjbom03qKsaVVWhKArETzFs24bruhrf9+F53h3Xs1vIc55LQYmyLGFZFgzDgGmavzLHcR6CUEp1IppRhGGoJX+9/h9I0zTouk623CKO79tcJRzHEZxzLMuik6qWVUIVf5UwyzIolCyX87wVrZGSYRjkluW3EQJ93+uEqu2r7FEpSdMUajEqZZIkiKJIzzIIglUJfwDKJAoRNPpH5wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Combinations&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/683a1052fdc0e186e9e7b69418634ca2/fb8a0/3.png&quot;
        srcset=&quot;/blog/static/683a1052fdc0e186e9e7b69418634ca2/1a291/3.png 148w,
/blog/static/683a1052fdc0e186e9e7b69418634ca2/2bc4a/3.png 295w,
/blog/static/683a1052fdc0e186e9e7b69418634ca2/fb8a0/3.png 590w,
/blog/static/683a1052fdc0e186e9e7b69418634ca2/526de/3.png 885w,
/blog/static/683a1052fdc0e186e9e7b69418634ca2/edd88/3.png 922w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;And trying to enter them in the solution box‚Ä¶&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;YOUSEETHATYOUCANDOIT!&lt;/code&gt; works!&lt;/p&gt;
&lt;h4&gt;Challenge 4 - CRYPTO - Deceitful Batman - 10 points&lt;/h4&gt;
&lt;p&gt;This challenge is a text file with &lt;code class=&quot;language-text&quot;&gt;NAANAAANNNAANAAAANANANANAAAAAAAANNAANAAANAAANANNAAAAAAAANNNAANAAAAANAANAAAA&lt;/code&gt;. My initial thought is to count the letters in each, and maybe each number is associated with a letter. That doesn‚Äôt work out since there‚Äôs a lot of single characters.&lt;/p&gt;
&lt;p&gt;Then I think it kind of reminds me of the Hamming Code that I just learned about in algorithms since there‚Äôs only two values, A and N. I look that up but it doesn‚Äôt really seem right.&lt;/p&gt;
&lt;p&gt;I google ‚ÄúBinary cryptography‚Äù to see waht comes up and find &lt;a href=&quot;https://en.wikipedia.org/wiki/Bacon%27s_cipher&quot;&gt;Bacon‚Äôs cipher&lt;/a&gt;. This looks promising‚Ä¶&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/fe525cce2e38e1c91db2d7f5f994c9a4/21176/4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 13.707165109034266%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAoUlEQVQI102LTQ6CMBSEOQeEFbTlABTKz45goS2IEePKGKP3v8LYPqNx8WXezJuJbvcBejGYDx5tYLSFmSzGQeOyX/F8vHDedqzuiG09wc0L9Dhj8n07OeoaUgfrf5FSEl3XQdU16n+qirK+76GUQuNpm4a6UkrygXCXZUmbtm0RMcbAGUfQPM+JLMsgigKcf/KgASEE+W+WpiniOEaSJD/e6Vdi+p2gvlwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Solved&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/fe525cce2e38e1c91db2d7f5f994c9a4/fb8a0/4.png&quot;
        srcset=&quot;/blog/static/fe525cce2e38e1c91db2d7f5f994c9a4/1a291/4.png 148w,
/blog/static/fe525cce2e38e1c91db2d7f5f994c9a4/2bc4a/4.png 295w,
/blog/static/fe525cce2e38e1c91db2d7f5f994c9a4/fb8a0/4.png 590w,
/blog/static/fe525cce2e38e1c91db2d7f5f994c9a4/526de/4.png 885w,
/blog/static/fe525cce2e38e1c91db2d7f5f994c9a4/fa2eb/4.png 1180w,
/blog/static/fe525cce2e38e1c91db2d7f5f994c9a4/21176/4.png 1284w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Looks like I found the cypher: NAPIER!&lt;/p&gt;
&lt;h4&gt;Summary:&lt;/h4&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/62b620d0be85ee5cfddeb20cf7aaeaba/b574e/5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 49.52305246422894%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABkUlEQVQoz4WRXY6cMBCEOUc2/NkGg8FgAwPsMBMlD3v/I1XKhlGySpQ8lBpQ83V1dVJULezi0PsbKmPR+RnKOBi/ou4cHt8/MMw70rKCqDW248B6/4Zpe2CO2uFu77E3KCnrDn7f0Ywe7TjDr3fogXV/QtsJx48POH5LRY2Sw6ftgJsm6N5HNdajZlVmhGoHAqWC6TpOOuBvO3KpkfHntFD4WlR4u2pwKOnw/b4R+uTgI7p0yxYd9tMawUkuFBsbdOOCqrXRRaGaqLQMsFMpoYXSGOeFEWyMaIUlpHdzjKvhNtHhW64QcmwHh0xWcTXBGOx0Q8lBuTz1cnh/7Jj3x+XwiA7Dc+eCQ2YYXKRljYprd4smrIfQXRwSqtDne0ZgSYeGg1/5nQrHGHjQAZIbJmFyWEe1hodpI1ASIps+wuQFDH1lVdPVRofP6C5q5ZUZg7EjTbkTGDISuuVVDdfsL2ef9er7kklK/Ca+5/I6njqBGVeWjUFt278D61/AuNE/lISmTGhmYSNQ/AHsPzn8H/An2qsnfiixtAUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Proof&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/62b620d0be85ee5cfddeb20cf7aaeaba/fb8a0/5.png&quot;
        srcset=&quot;/blog/static/62b620d0be85ee5cfddeb20cf7aaeaba/1a291/5.png 148w,
/blog/static/62b620d0be85ee5cfddeb20cf7aaeaba/2bc4a/5.png 295w,
/blog/static/62b620d0be85ee5cfddeb20cf7aaeaba/fb8a0/5.png 590w,
/blog/static/62b620d0be85ee5cfddeb20cf7aaeaba/526de/5.png 885w,
/blog/static/62b620d0be85ee5cfddeb20cf7aaeaba/fa2eb/5.png 1180w,
/blog/static/62b620d0be85ee5cfddeb20cf7aaeaba/b574e/5.png 1258w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Thoughts on Software Vulnerabilities (Defense Against the Dark Arts)]]></title><description><![CDATA[Software Vulnerabilities Hacking is manipulating software from bugs in a program, or through configuration vulnerability (when someone has a‚Ä¶]]></description><link>https://michelelarson.com/blog/security-software/</link><guid isPermaLink="false">https://michelelarson.com/blog/security-software/</guid><pubDate>Wed, 30 Jan 2019 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;Software Vulnerabilities&lt;/h4&gt;
&lt;p&gt;Hacking is manipulating software from bugs in a program, or through configuration vulnerability (when someone has a weak password, or unchecks a security box, etc. Those things make it less secure.) This week will focus on the first, software vulnerabilities.&lt;/p&gt;
&lt;p&gt;Companies use bug bounty programs where they ask people to find vulnerabilities and report them so they can be fixed, and then they‚Äôll be paid for finding them. &lt;/p&gt;
&lt;p&gt;Companies have gotten better at protecting their perimeters, so rather than focusing on perimeter attacks, attackers now focus on targeting users through phishing and social engineering.&lt;/p&gt;
&lt;p&gt;They can be targeted through a web browser, where javascript code can take over the browser. &lt;/p&gt;
&lt;h5&gt;WinDbg&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;debugger that freezes the program and lets you inspect it.&lt;/li&gt;
&lt;li&gt;List modules &lt;code class=&quot;language-text&quot;&gt;lm&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Search for string (called simple) &lt;code class=&quot;language-text&quot;&gt;lm list modules&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Set breakpoint in singlestackandheap program, main function &lt;code class=&quot;language-text&quot;&gt;bp singlestackandheap!main&lt;/code&gt; on &lt;/li&gt;
&lt;li&gt;list breakpoints &lt;code class=&quot;language-text&quot;&gt;bl&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;go &lt;code class=&quot;language-text&quot;&gt;g&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Display dword in memory in (eip) &lt;code class=&quot;language-text&quot;&gt;dd eip&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Unassemble - takes bytes at address (eip) and desembles them &lt;code class=&quot;language-text&quot;&gt;u eip&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;See numbers in different formats &lt;code class=&quot;language-text&quot;&gt;.formats 123&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Display as ascii string &lt;code class=&quot;language-text&quot;&gt;da 123&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Display as unicode string &lt;code class=&quot;language-text&quot;&gt;du 123&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Registers &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Stack &lt;code class=&quot;language-text&quot;&gt;k&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/4e04a32e24d8faa1afb8a0f1d7019325/77244/windbg.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 65.893470790378%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACdElEQVQ4y12S21PaUBDG8/8/dtROO1ZnnGm11NoH60MfFAUUoeGWewIkQSBAQC4SqFy/7h6bjuOZObObze7vfHv2SJ+PE/h2+gMnp+c4Pr3A0ck5dj4lsHuQwM5+Qvi83x9+xx7F9g6+CvvuwxF297/g49EZDo/PcXZxhZvkLaRfl0nkSxrksgG5qCNXUFGsGNCsqojdywru7otIpvK4TBeQzlWQvCsgVzZpW8hSTbagI51XKF6ClMrkYFg2Ot0eFqs1JtMpBo9DBPTd6Ybw/Af0wj7kQgmKZlCug7KiwXLq8B5aKJFfUXUUy6qwkiz/huPYmIzH2G42GI1GCNptdLtdLJcLxMu2LTi2jXqtCtM04PsegqAN0zBgWSYMQ4eua5AymVsCOphMJliv1xgOh+h0OgjDELPZDPP5XMQNKuS8Wq0mfN/3CRgI36Z4pVKBqhEweX2NarUqgM/Pz+j3+8I+PT0JtWwZqlEyAznXNE00Gg0BZN8m5bquCyul0hlY3ErdpTZ7aFPSmNpnyHK5FHBelmWJAgZysed5/xXyPz6QrXSbScN3q5hOhlj8iTCbjrFeLbDdbvF6xYUMZBsrZBD/483XIf28yiKrN2B1InjDFcwgwmDGsK2AxmBRZL7cI0NcUthqtYTPbSuqKnzpIpmD7ASoP67gjTZQHsYIo40Abl4B45Zj4OuhMJCvgdVLmdQNmr77rzF6NoNQ2Lcrvvz4Drllfg1iyhRXSaFo+fomBYeSPM9HRM9kTNPuDwbi9AFZfj6skpUxlIvioXDLsXJFUV4UpmnKrusKAE82iiL0ej0BaDabQgXHGcSFby3XxhPnur9XNKGmbvVbSgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Trying WinDbg&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/4e04a32e24d8faa1afb8a0f1d7019325/fb8a0/windbg.png&quot;
        srcset=&quot;/blog/static/4e04a32e24d8faa1afb8a0f1d7019325/1a291/windbg.png 148w,
/blog/static/4e04a32e24d8faa1afb8a0f1d7019325/2bc4a/windbg.png 295w,
/blog/static/4e04a32e24d8faa1afb8a0f1d7019325/fb8a0/windbg.png 590w,
/blog/static/4e04a32e24d8faa1afb8a0f1d7019325/526de/windbg.png 885w,
/blog/static/4e04a32e24d8faa1afb8a0f1d7019325/77244/windbg.png 1164w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h5&gt;Registers&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;eax - likely stores return&lt;/li&gt;
&lt;li&gt;eip - instruction pointer&lt;/li&gt;
&lt;li&gt;ebp/esp - stack frame pointers&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Program memory&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;!teb&lt;/code&gt; - stack - thread - pay attention to stack limit and stack base (refers to entire program)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;!peb&lt;/code&gt; - heap - process - pay attention to process heap&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;!address&lt;/code&gt; - will tell you where it is&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Memory corruption&lt;/h5&gt;
&lt;p&gt;Accessing (reading/writing) memory (usually stack or heap) in an invalid way which results in an undefined behavior (that we then take control of! - exploitation)&lt;/p&gt;
&lt;p&gt;As kind of an inside security thing, as a proof of concept you try to get the calculator app in Windows to launch when you launch your payload when exploiting a vulnerability.&lt;/p&gt;
&lt;p&gt;Metasploit has a lot of vulnerabilities and payloads you can use by mixing and matching to exploit programs.&lt;/p&gt;
&lt;h5&gt;Stack overflow explained&lt;/h5&gt;
&lt;p&gt;In an overflow, we can overwrite what is on the stack in memory, such as saved EBP, saved return address, next function parameter, local variables‚Ä¶ so for example, the saved EBP value is whatever we had put in there, which can correspond to an address. &lt;/p&gt;
&lt;h5&gt;Taking control of program&lt;/h5&gt;
&lt;h5&gt;1. Crash triage&lt;/h5&gt;
&lt;p&gt;What registers contain attacker controlled data? what registers point to attacker controlled data? Is attacker controlled data on the stack or the heap? Do we control critical data such as stack frames?
Where are we in the execution of the program?&lt;/p&gt;
&lt;h5&gt;2. Determine the return address offset&lt;/h5&gt;
&lt;p&gt;How many bytes between our buffer and the return address on the stack?&lt;/p&gt;
&lt;h5&gt;3. Position our shellcode&lt;/h5&gt;
&lt;h5&gt;4. Find address of our shellcode&lt;/h5&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ffe4&lt;/code&gt; is a jump instruction. We can look for that anywhere in memory and replace the return address with that jmp esp instruction. ESP is pointing to our code, so it will execute off the stack.&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;Lab&lt;/h4&gt;
&lt;p&gt;We are going to exploit a program by overflowing the stack buffer. Here is the javascript code that is running:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/7eae9991b7730ba3f4e444e01e9372d0/811f5/lab1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 310px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 28.064516129032256%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABN0lEQVQY0z2Q6XaCQBSDef9H62ndEAUFhh1UFgEFt/brBWp/3BMyw+Qm0SzryGyes7XOKK/F2FQEUUcQHtmaSriHqzL8MMd2YvZOQpSUpIeGY9nR9nAZpoP2+oPmeSWbbc3ObkSgYrkq8IIW242Fe6x0h70dyUJfUATdRBaksrTglJ1pi46m6qma5yTY9S8e37JBiL4+46gbeXHhcBrmimG44lKxWO5E6CCCKdY+ZK3b3FXCy/IodwFR1tLfQWsvT65iOS9v6CuLj09DXNriOEL5GbqhxKUrFUgtpj/ObL5ltjAxxfXX3EQFOQvhcVqjFdV1zF+3L5K0krgnHDebespqwriUH89kx2bE4TyUuEOniUQO42JM48u7vOylwyChqieX3Y3R9u0x4Zt3f99v/p7/+z8cNH4B5Ai+YeG/428AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;JS program&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/7eae9991b7730ba3f4e444e01e9372d0/811f5/lab1.png&quot;
        srcset=&quot;/blog/static/7eae9991b7730ba3f4e444e01e9372d0/3db3b/lab1.png 148w,
/blog/static/7eae9991b7730ba3f4e444e01e9372d0/1434c/lab1.png 295w,
/blog/static/7eae9991b7730ba3f4e444e01e9372d0/811f5/lab1.png 310w&quot;
        sizes=&quot;(max-width: 310px) 100vw, 310px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I load it into windbg and trigger the vulnerability:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/e80ced5230e067f2d2bc5fb7ffe5355d/e18e2/lab2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 30.758426966292134%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAA+UlEQVQY021Q6YqDYAz0/V9NoVrveuGBV6t40dYDZncCun9WCOabTCaTKKZpIgxD+L4Px3Ukv91usCwLcRxDVVXczTvyPL8wctI0xePxQBAEcF0XRVFIKGxgwbbtq4HNTdNcpL7v5U9snmdM04Tv94tlWSTatpU6Byl0GEUR6roW4vv9xnEc0rCuK/Z9v4I4sW3bpP7fpziOc6lzDTo816qqCv6ve+Ynj4OzLBPu8/lE13X4fD5/gpqmyf0Mw5BbeJ4HXddB52dOMdZ4Gq73er0kyrKUOE+TJAkUCjHhZDoahkEms4FvCvBuJzaOo5yGq9MZVydOHsV/AGhjumc30thwAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDbg&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/e80ced5230e067f2d2bc5fb7ffe5355d/fb8a0/lab2.png&quot;
        srcset=&quot;/blog/static/e80ced5230e067f2d2bc5fb7ffe5355d/1a291/lab2.png 148w,
/blog/static/e80ced5230e067f2d2bc5fb7ffe5355d/2bc4a/lab2.png 295w,
/blog/static/e80ced5230e067f2d2bc5fb7ffe5355d/fb8a0/lab2.png 590w,
/blog/static/e80ced5230e067f2d2bc5fb7ffe5355d/e18e2/lab2.png 712w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Next I change the code to use &lt;code class=&quot;language-text&quot;&gt;msfPatternString&lt;/code&gt; to generate and search a pattern and in WinDBG type &lt;code class=&quot;language-text&quot;&gt;!load byakugan&lt;/code&gt; to load a program to tell me the offset of the registers. I run the program and &lt;code class=&quot;language-text&quot;&gt;!pattern_offset 2000&lt;/code&gt; to get the return address of 1028.&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/5f5a0d48a5e4e71d7e4aee74650ef8b6/44786/lab3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 316px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 33.22784810126582%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABd0lEQVQoz12R6ZKiQBCEff8XmzVWZwAVVwS6Gwc5RE5FHB2/KTQ2NmJ/ZHTW0RlVWRM9D3j7fcBZFPhhi2UX6N2ZUEV82BtWbkCgEnSUsVorqeVoc6BqBoqq53qD/grnC5z6B5M8LPD8Ad8/4Tg1jt2IWEco+Y2XSc4wm20lr1kuY7xNhrtO2G5z6SuJ9yd2nx3F8ZuygklbXakbOBYPfk1znGWD1rU0NyhV8/GuROwTx4qwnB2WpZi9hywWsXCDbRumU48kvVEUInhuL3Q9tOc7xbllkflYqY+TbvGKPapO2Bx3qCojqFKCMsbUB5rhxv0BX/cXhq/X2pO+GzgNUNYDS1cxt1yWG42vY5T4ZS08XN8QmD2uFxGEe+b2H7ZhzGoVooysrjPxNRdPr7Jy2dGJctPe2MWleBmzXkfiy1FQikCKiY5kufiq0udHT3p0dJBa8oxHQSPxU3BvYurT93PcfniNPmLk4/VGfhmvOPzj/79/MWr8AIiVB2JnQCZaAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDbg&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/5f5a0d48a5e4e71d7e4aee74650ef8b6/44786/lab3.png&quot;
        srcset=&quot;/blog/static/5f5a0d48a5e4e71d7e4aee74650ef8b6/18004/lab3.png 148w,
/blog/static/5f5a0d48a5e4e71d7e4aee74650ef8b6/c49a0/lab3.png 295w,
/blog/static/5f5a0d48a5e4e71d7e4aee74650ef8b6/44786/lab3.png 316w&quot;
        sizes=&quot;(max-width: 316px) 100vw, 316px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/6c8c467e13cd09475449e6df683c0f80/9eb69/lab4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 50.16129032258064%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABgklEQVQoz32Si2rCUBBE8/+fUSi0v1IUNL5NYmqiifGtCRgVneasVdoiXVj2PvbO7Oxep9vtyg989Xo9BUGgVqul4XCoTqejwWCgfr+vRqNh53Ec2x0+Go3k+Z5FcsnDHTae5wlg1u12W77v234ymTwAoiiyc0jm87n5ZrNRnudar9e2XiwWckDlMUyz2Uy73U5lWQo7HA46n8+6Xq/6a5fLRc/MgT0MQ2VZpu12a6AwZvPMqoAgSRJjp0rylsul3ZEbxZH2+70VQQEOEgGs1WomnX5xRtX0DQXNZtN6XK/XH5IBm06nStPUHFLIDJBHPAAYIKoGhMg9DhCEkAAEKEqonF7fwa2HJIPOwWq1MkdqURSPxtNLImdlJQ2ZSPxpx+PxViEDsW/wPW3XdasKMpOVpon+MwZ2dxsKvQMAIAAhGI/Hldxq3ekqSWfVf/MtjsJPHU+nX0D39T3alPlfgNCXcTXJ3WYlN97rtVnqzS313sireNBLvdDH9PZdLk++EvYFYufkMs1DFp4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDbg&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/6c8c467e13cd09475449e6df683c0f80/fb8a0/lab4.png&quot;
        srcset=&quot;/blog/static/6c8c467e13cd09475449e6df683c0f80/1a291/lab4.png 148w,
/blog/static/6c8c467e13cd09475449e6df683c0f80/2bc4a/lab4.png 295w,
/blog/static/6c8c467e13cd09475449e6df683c0f80/fb8a0/lab4.png 590w,
/blog/static/6c8c467e13cd09475449e6df683c0f80/9eb69/lab4.png 620w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I put that value into the code (need to divide by 2 because it returns 2 for every 1) and add values to the string so it will overwrite that space in memory:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/4da1e0c8d1e77e7091aebf7d5bb6a450/28feb/lab5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 299px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 21.070234113712374%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAA5UlEQVQY01WP2W6DQAxF+f9Pa6UmRZQ1AYawDExg2EmapKcj1Jc+HF3Zsn2vLd/vOBxbongiPI34wUAhF1IhcZyT6RWIiyIRDWF0MaooqwGlN/T0ZLnDvP2xgiWyaT9yikeOdovn92S5NnXBlxvjuClBmOEFGdG5IDSkmaKWPYOama8Lutt2xuUH6/YNjxfo/snbe0NZ38mLK6rdyMuOj0OAbUe4niBOpEl8wXYTCl9wjzL0Z0AVCIQxbMcH1rS89qiNccvLdk+h2tWwIJuBUg5Udc+1W3fNq55KaqSZH83efPv/8i8Q4ylvgUeXfQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDbg&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/4da1e0c8d1e77e7091aebf7d5bb6a450/28feb/lab5.png&quot;
        srcset=&quot;/blog/static/4da1e0c8d1e77e7091aebf7d5bb6a450/58d0d/lab5.png 148w,
/blog/static/4da1e0c8d1e77e7091aebf7d5bb6a450/bd2b0/lab5.png 295w,
/blog/static/4da1e0c8d1e77e7091aebf7d5bb6a450/28feb/lab5.png 299w&quot;
        sizes=&quot;(max-width: 299px) 100vw, 299px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/a21061bada3a72946b6b1a77d075d06c/6ea70/lab6.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 29.973118279569892%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABAElEQVQY022QiYqDQBBE/f9vEzzjgUaTGA88o4mJeKRCNSgsrDB0DT3dVj3F932cz2fcbjcEQSDadV3EcSzaNE3R1+sVURTJSZLk0JxJ0xRlWeL1ekHRdR2e58G2bTiOI0sulwvyPJfKYWrWtm3xeDzw+XwwDAOezyfquhYzYRhKXzmdTnLhEB9N04Tv9ytDy7JgXdfj8D7Ps1S++e9T6I5x6IbRGIN1d0ckO5aiKHC/36VHXVWVmPizUNM0GIYhrOhWN3SoqgrLskAc7LNHJGTFJE3TIMsyuTMuDRyROUiwhEo+7/cbfd+j6zrhM46jwGaPmo722Nu2SY+L+BNi+gGmA7ySGNMhQAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDbg&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/a21061bada3a72946b6b1a77d075d06c/fb8a0/lab6.png&quot;
        srcset=&quot;/blog/static/a21061bada3a72946b6b1a77d075d06c/1a291/lab6.png 148w,
/blog/static/a21061bada3a72946b6b1a77d075d06c/2bc4a/lab6.png 295w,
/blog/static/a21061bada3a72946b6b1a77d075d06c/fb8a0/lab6.png 590w,
/blog/static/a21061bada3a72946b6b1a77d075d06c/6ea70/lab6.png 744w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Now I see where the program starts and ends and search the program between those two values for ff e4, which is the jump, and update my code with it plus add a call to shellcode to my string to execute next:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/26ec4ab6ed8aa539430605343b2b11a8/de368/lab7.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 10.977242302543507%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAbUlEQVQI112Muw7DIBRD8/8/1LVz5pKrkCFCEVCeYgIBg9veLR2Oju3By04vZP+GMRpKKbTWEGOE957de8cY48b/VmvFnBOlFCyP9cCTAo7zAtEGrQ2EEN9MkFLy8Q9rLds5x04pMTln7iEE9gefXpXVxWndBQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDbg&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/26ec4ab6ed8aa539430605343b2b11a8/fb8a0/lab7.png&quot;
        srcset=&quot;/blog/static/26ec4ab6ed8aa539430605343b2b11a8/1a291/lab7.png 148w,
/blog/static/26ec4ab6ed8aa539430605343b2b11a8/2bc4a/lab7.png 295w,
/blog/static/26ec4ab6ed8aa539430605343b2b11a8/fb8a0/lab7.png 590w,
/blog/static/26ec4ab6ed8aa539430605343b2b11a8/de368/lab7.png 747w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/ecffed612e1184bd210fa4e6a528d4d1/9531c/lab8.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 319px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 48.275862068965516%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAB6UlEQVQoz1VS6ZraMAzM+7/ZdulyBAgkEHKfzmHnIqUwnSS72/bHfJJla6SRrLlGDP0ocbkqOF4H86KQZAPsW4SzFcBxM7i+QBCVuNGPEsn7BqK+Q3ZAeycGol+ghUYI3ZBMrnE619hsC/ihhHXxsT/Y0PdXFol457LwDbaT4uZkyFIJJTqockBNSPUbTfeCdh8eeLzAwBMfm4lsYBclUj72vBzbrYX11oRpBrjYMQt72O5M1CQe9xbys4Ngd0YYs0D7hNbKAQ1bzkkQp4qyEuTFMJ+TjPLZSZq1EGXPQvUsd7KivEP1n3K/JHMEWqcGdCMgig4RkydCQQlF1ZNomqdEJhbCJKu/i0xvJolt/z+0hsNVZE7TbpndNSbRwKSW5xpBUMHzK0SxguvQRg3ipKWKEZV8olYv1PI1W0loVXbnJeBzwzengWkJuG6H1buFj7UL4xjjsI/w/sOCqbeoBOctgbIkKqAoFisYz/NZ8jjPIEkUfq7PeHvToR8cbjnkdmOsViduNsPp5OFo+Njtrnx3wsFwsdmYsOyUBW34kYJspg7zel6KVA+keUN5glLL2U/zFsHst/OSwrii3Hr+k1MsjKrF8k1RjcsM4yCFbF/oSNrzkw6/iHHx5/On333549/Yv3bKb7iLP4FR7jDbdp/MAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDbg&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/ecffed612e1184bd210fa4e6a528d4d1/9531c/lab8.png&quot;
        srcset=&quot;/blog/static/ecffed612e1184bd210fa4e6a528d4d1/231f6/lab8.png 148w,
/blog/static/ecffed612e1184bd210fa4e6a528d4d1/04000/lab8.png 295w,
/blog/static/ecffed612e1184bd210fa4e6a528d4d1/9531c/lab8.png 319w&quot;
        sizes=&quot;(max-width: 319px) 100vw, 319px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It worked! I see a calculator:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/902af4083fc5535c7a3a3ba345298c61/1bc44/lab9.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 59.24412665985699%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAAB+UlEQVQoz31T6XKbMBjk/d+pM/2RSVNf4NsEDOYSYBCnwTjY3n6Sj2mmSTWzo4Nltd8hpW1a1HWNpmlwOBwkxLptW0KDruvQnQRO8qxpb7wT7b8aiiAJQSlW38Sa5oCyLJEXBQqJHAVPUeTZ7WLiHY9H9H2P8/l8A63FXnFdF5zIKSFJEoQhg7Xb4VXd4Lem43Vq4ZeqY/zjJwZvQ7AkxT6OEEURYpoFP2QMSV6ioouU2WyG7XYLwzBg2zZM04SqTbEyGXZBDovgJy1Y2uLlbYz5Yi55juOQWCjFIrokLSsZpSI/RCGYuIkIjAjm1oITZijbHrzukBNYWmOkzuHdhXzflyiripzVz7Qpur6BvtFhvL/Dsi14nksOZxgsdljaMRZWhBXNa4fjZbKUIhEJcs6fRRR4Cj6q+zgQlfX8AJoRwAwymD6X0L0Mg+kaORVGuqqqT4KP7pCCXXdrgev1Kue8qKQ7Ny5gsQyGn2LtckzXW1zO/ZN7uVz+gSKKIcLoPz5kb4kWiPck4CRg/AB3X8GOCpisxGxj4XoX/G4oLTmsyb7ot0cYrhdguBI5jCiHoQx/uAmgLg3p8PKNO+kwLmvEeYGUepBnnHKUy55UNQ0TVcNoPMFkomI0Gsl2+fQQvipKUdUo6FUIh+J1PNDcCyRezd8//Q+C8wfnfYhSc8774wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;WinDbg&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/902af4083fc5535c7a3a3ba345298c61/fb8a0/lab9.png&quot;
        srcset=&quot;/blog/static/902af4083fc5535c7a3a3ba345298c61/1a291/lab9.png 148w,
/blog/static/902af4083fc5535c7a3a3ba345298c61/2bc4a/lab9.png 295w,
/blog/static/902af4083fc5535c7a3a3ba345298c61/fb8a0/lab9.png 590w,
/blog/static/902af4083fc5535c7a3a3ba345298c61/526de/lab9.png 885w,
/blog/static/902af4083fc5535c7a3a3ba345298c61/1bc44/lab9.png 979w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;Exploiting the heap&lt;/h4&gt;
&lt;h5&gt;1. Free the object&lt;/h5&gt;
&lt;p&gt;In Windows when compiled with Microsoft Visual C‚Äôs runtime library, 1MB of memory gets allocated when creating a virtual process heap. This is what Internet Explorer uses. When 1MB of memory is requested, VirtualAlloc is used and returns chunks of data up to 1MB. After the 18th request for an allocation of a size, it creates buckets of that size. &lt;/p&gt;
&lt;p&gt;With JavaScript we can control when something gets freed.&lt;/p&gt;
&lt;p&gt;Page Heap - debugging heap you can enable to see more info:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/f0faa08c701671eb42158acc07bee93a/0d0be/heaplab.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 46.189735614307935%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACHklEQVQoz5WO20/SYRzGf3d2kKGzTVKWhzkEEvjxA2T1f3VRm1utLrxqemeHuVZNp8FaQnkaCiqCNZCDgqID8wSOJSHef3p5L+q6i2fP+zzf7/t8H2XywwyzcyGCoRi+wAr++SjvfUtMBTeYDed57VtjYjbCG/8Grz41eZ2JmVUmv8SYCWWZi2QIRpIs+eeITX1EefZiFJtdRXN7cHu8mMz3GbI7sasurIIHTFYsQw6sNidmq51Bq03MNYYcGtrwQzTPA1SXl57+Ad5OvkN5MvKUbqMRi9mMwyE+WiySNaeT3p57dHfdpa+vF2N3F/39fRg6O2lvb6O19TZ3OjrkTlubHkVRGB8fR3n0eIQbN2+h1+sxGAzodDpaWlokmkv/g7GxMZTnoy9xuYfxeDwMe72oqhObzS5hF01VVRWN1X8smjs1TXJzt+m7XG5MpkGmp6dRPgcWCCyGmQ9t8HV5jYWVKIurmxJL4Zj0g8uRv7NvoXWpF1ajhNa/S4RjCTYTWaI/MiiJRIJ0OkNye5tkcltyIpmUyGSzQqeIb21Jv3R0RKFwQC6fp1gq8fP4mErlgsb1NfWrKxqNa5R0Os3e3h77+/sSuVyOVCol3weFgtC7FItFuVOpVLi8/EW9/ptyuSx0mfPzc47koYIIbKDE43F2dnZlUF5cPj095VhcLokGTT48PBTzHRlYrVY5OzuTH2u1mgiuS31yciKPNb0/I3vONESqU3EAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Enabling Page Heap&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/f0faa08c701671eb42158acc07bee93a/fb8a0/heaplab.png&quot;
        srcset=&quot;/blog/static/f0faa08c701671eb42158acc07bee93a/1a291/heaplab.png 148w,
/blog/static/f0faa08c701671eb42158acc07bee93a/2bc4a/heaplab.png 295w,
/blog/static/f0faa08c701671eb42158acc07bee93a/fb8a0/heaplab.png 590w,
/blog/static/f0faa08c701671eb42158acc07bee93a/0d0be/heaplab.png 643w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h5&gt;2. Replace the object that got freed with a new object that you create as the attacker&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Figure out the size&lt;/li&gt;
&lt;li&gt;Make allocations of the same size&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Next we need to find out the size of the space we‚Äôre freeing. We can tell the size of the busy space allocation by setting a breakpoint right before it gets freed. By using &lt;code class=&quot;language-text&quot;&gt;!heap -p -a eax&lt;/code&gt; we can see where the allocations are freed and see what space in memory this is happening, and then set a breakpoint:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/2faba5dd9363f29a70335341272960bc/26951/heaplab2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 560px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 81.07142857142857%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACPElEQVQ4y3WU544aQRCEef/nsOS3sPyD4whLzhkWlpxzruNra1aW5Rup1TCarq6qntlIr9eT7/sqFAqq1Wrif6fT0XA41Gw20/l8Fut6ver5fFq+XC46nU72//V66fF42N7tdlPkeDxqOp0ql8upVCqpWq2q1WpZ9Pt9rVYrLRYLi9FoZEBuHQ4HI7Ner8O9yG630263VxCMtKR4PtdyubQmMIQp4NlsVqlUyhrO32cmk4k1QBFNWbCN7Pd7zcaBMsmY/F5HtXrdijKZjGKxmJLJpDzPM7B8Pm+MUIW8/63I4bBXdbjRz19FxUtdFfI5Y4SniUTCrACIaDQaxoIAED8hhA33+908jRz2O2W6K/34Xddn2VfiM/YuLhgAMmFJrlQq5jHhftMU9sViUc1m0+Sb5PGwr7wXl99tq1wuq/6WTU6n01ZEUIQVNMIOmgCKz3iKn0EQ/AHsv33xvLSab6l0pBAQ5DpAigHBU9eMzHAAxFfzEEDQ6cr9Qw4ekgkKYQVDAAGBCdPn7rnAwxBwMBjYFMnIBRiWsHIDIWAMKIxh9e8Krw1A8XjcTGWS7XbbCmEBKM0IgNz14aJ/C8jdikajBuiGAhBPESvcVGmCBW6Pl7Ldbi3z/ELJPLGPjw91u90QEDYMgD0YOw+5RpzhdQC22Wwsu4seAnIQhnQGkGnjGbLJgCPVZYC+lQwgHsIGaQC6QcDKvWPAnGQG9zcQETIcj8d2CGnua+NeBKxpgJ/su68SvnMH3YfBAX8B0hGMUrVw3K8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Page Heap&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/2faba5dd9363f29a70335341272960bc/26951/heaplab2.png&quot;
        srcset=&quot;/blog/static/2faba5dd9363f29a70335341272960bc/b2ad5/heaplab2.png 148w,
/blog/static/2faba5dd9363f29a70335341272960bc/2283b/heaplab2.png 295w,
/blog/static/2faba5dd9363f29a70335341272960bc/26951/heaplab2.png 560w&quot;
        sizes=&quot;(max-width: 560px) 100vw, 560px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/9ce27280519823e6d3655a8c6cdeb51f/a9d25/heaplab3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 77.39463601532567%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACuUlEQVQ4y31T2XLaQBDU/39CPiIPrjgOtjltMLY5hIQkJKGDQ9ynsBB3Z2ZtKDupZKu62F1WvTPdvdJNIoHb+xySmQKS6QISiRyub1K4uk7hLv2EzMMLktlXJHMlpAjJ7AvSD2Uk7gv4lcrjLvNE+0UUnqvIE6TbdBZlRUdJ1lCq6cgXy/h5n8ePZBGpQhVl3YNstVExPFQbLYGa3UGN9mSzTWv/fc/q4LXuQsrmcvB9D4auQ6vXYdsWNE2HYTQwGg5wOh4AnLBcLBCvI2w3G9o7vuP0gY/5freDlMlkiNAXBDqRNptNKEoNtVoN/X4f5zGdThGt19hut2J9Op3oGgjg06/0mM/DdV1YlvWJUBGEQRDgcDgITCYThGGIOI7x5xDkH5DKlQoajYYg0TQNjuOgKsuQawqRO5jNZnh7e0O3G2A4HMJvtcQef7zf73Gkdj8PqVqtigq5veVyiXC1gq7K8Mw6HNtEtArFwTHpGS5m6AVdDAYDrKn9Bev6UfGlwgoRclUM07Tguw7unjVclchBclFzA3iDBezOGGZ7BMvvCT1HoxF6vR7G47GQgwvii6Ri8Rl1cpfbVRQVpq7i+6OJb/kxbrUpMs4aWW+LnB0i68ao92NsNjFVGCOKIlEhg+dctWiZNTRNU9zo+5Sp8iscQ8GoH1y0Cecz7OIIx/0O/xvSZDKFR7HRDYO0dNBuU2Blig1V2+l0L3GYcGyiNXa73V/OfnGZDwZtH52Wh1arjQ4RcmQYbBYLz3HpdrvCXdaKW/tnbGbzBR4VD0+ySSSyMIcjpKqqyOaKXOfBgs/nc/H/2WWO0znol5Y13UDRGkH1RvA9V4RZphyyURz0MyHry0QsPre9oSfIZJzFLxWqah2L6RigN8sbfIhfi2XZsOwmPM8XRjWpMg46z13XE7qzRLzmM7xm/AZ791DTz6qrywAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Page Heap&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/9ce27280519823e6d3655a8c6cdeb51f/fb8a0/heaplab3.png&quot;
        srcset=&quot;/blog/static/9ce27280519823e6d3655a8c6cdeb51f/1a291/heaplab3.png 148w,
/blog/static/9ce27280519823e6d3655a8c6cdeb51f/2bc4a/heaplab3.png 295w,
/blog/static/9ce27280519823e6d3655a8c6cdeb51f/fb8a0/heaplab3.png 590w,
/blog/static/9ce27280519823e6d3655a8c6cdeb51f/a9d25/heaplab3.png 783w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Because heapfree takes 3 parameters, we can use &lt;code class=&quot;language-text&quot;&gt;!heap -p -a poi(esp + 8)&lt;/code&gt; to find the space that gets freed.&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/c6a33f23290d56cdbf5388b921f2994b/acd0d/heaplab4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 50.556438791732916%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAB/ElEQVQoz12SXY/SUBCG+clGY+LNem1i4o1eeLG3628wajYuLiK0UOh3+ahAQViKS6lkgdL28ZyDGOOkb2fOTOedj9OKZTvcLWOCoEc0nTKJpozGE6bCnkYTNsmaX+mGVGiJ+1XMMTtAWZAfhabkJCddSe+XDAMHy9CUDnsek2GA77nMY0G2P5Lujmwejqy3mcCB7aFAHBFHBRFW2OxLKu9DeKf95LIa8fZ6xOWXGVeNO17frnn64YFXGrys5zy7LnjyGS5uUb4XdXj0seTxp5KLm5Ln1ZI3uiBcbgvscE7LG/HN7Cs0rAFfDZ+bRgfDHVLTTTQzwB5E+N9/EM5iZquUjZg42Z+wFjjkYmQ5e+A5+K5NP/DwHQvXNvGE7hotdK2B2TFotzQGPZ9tmpDtd+TZeX+FeHK107IoqBTi5boe3a5Jq9Wi2dTw/QDDMKjVarSFdhwHx3WF32c0Gv+Jd8RFBkTiEj3hl3HP806EMtDv9xkMBipZ2pZlnYgEwjBUH3c6HeWX9mKxUJjP5+qPmM1mjMdjKnmeqyRZ/Uwgbdu2VaIrKkuf7PhMJn1xHJMkCTL/X1EdmqapqkuSbrerEtrtNtVqFV3XxRqa1Ot1RSqnSNOULMvY7XaKsCzLv1CEsqrEcDhU48ukXq+nOpKFZEFpS8LVasX/IonO8hul/dTKCCuXjgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Page Heap&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/c6a33f23290d56cdbf5388b921f2994b/fb8a0/heaplab4.png&quot;
        srcset=&quot;/blog/static/c6a33f23290d56cdbf5388b921f2994b/1a291/heaplab4.png 148w,
/blog/static/c6a33f23290d56cdbf5388b921f2994b/2bc4a/heaplab4.png 295w,
/blog/static/c6a33f23290d56cdbf5388b921f2994b/fb8a0/heaplab4.png 590w,
/blog/static/c6a33f23290d56cdbf5388b921f2994b/acd0d/heaplab4.png 629w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h5&gt;3. Position shell code into memory&lt;/h5&gt;
&lt;p&gt;When you‚Äôre using your browser, you can‚Äôt know where the memory is being created. We can make a huge string that fills up a giant amount of memory. You can then put in your shell code because it will be in a super high memory address because of your string. This is in a predictable place.&lt;/p&gt;
&lt;h5&gt;4. Use object again&lt;/h5&gt;</content:encoded></item><item><title><![CDATA[Thoughts on Security Defenses (Defense of the Dark Arts)]]></title><description><![CDATA[This week focuses on life as a malware researcher and covers how the attack gets into the system, how it typically functions, and how we can‚Ä¶]]></description><link>https://michelelarson.com/blog/security-defenses/</link><guid isPermaLink="false">https://michelelarson.com/blog/security-defenses/</guid><pubDate>Sat, 26 Jan 2019 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;This week focuses on life as a malware researcher and covers how the attack gets into the system, how it typically functions, and how we can defend against it.&lt;/p&gt;
&lt;h4&gt;Spreading malware&lt;/h4&gt;
&lt;h5&gt;First contact - Possible Sources&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Email, Instant Messaging&lt;/li&gt;
&lt;li&gt;Malvertising - contaminated ads&lt;/li&gt;
&lt;li&gt;Poisoned search results - Trow up sites based on google trends that would show up high in search results that people would then click on&lt;/li&gt;
&lt;li&gt;Watering hole - go to the place where people mostly go and poison one place&lt;/li&gt;
&lt;li&gt;Physical access - such as USB drives&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Local Execution&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Autorun - Windows will automatically run software&lt;/li&gt;
&lt;li&gt;Exploitation of a document or file - PDF, plugin, browser&lt;/li&gt;
&lt;li&gt;Reverse psychology/social engineering - ‚Äúdon‚Äôt click here‚Äù ‚Äúclick to claim your prize‚Äù&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Establish Presence&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Tries to blend in and hide (change filenames or datetime stamp, sign files)&lt;/li&gt;
&lt;li&gt;Tries to appear legitimate&lt;/li&gt;
&lt;li&gt;Persists (system startup, application start up, scheduled tasks, etc)&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Attack&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Harvest information&lt;/li&gt;
&lt;li&gt;Phone home - use web, email, FTP to send data&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Defenses&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;User education&lt;/li&gt;
&lt;li&gt;Block computer ports&lt;/li&gt;
&lt;li&gt;Anti-virus/malware&lt;/li&gt;
&lt;li&gt;Network Firewall/Inreusion Prevention&lt;/li&gt;
&lt;li&gt;Message/Network/Web Reputation&lt;/li&gt;
&lt;li&gt;Host Firewall&lt;/li&gt;
&lt;li&gt;Host IPS&lt;/li&gt;
&lt;li&gt;Access control&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Anti-malware features&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;File Scanning&lt;/li&gt;
&lt;li&gt;Registry and Cookies&lt;/li&gt;
&lt;li&gt;Cloud scanning&lt;/li&gt;
&lt;li&gt;Memory scanning&lt;/li&gt;
&lt;li&gt;Scripts&lt;/li&gt;
&lt;li&gt;Heuristics&lt;/li&gt;
&lt;li&gt;Decomposition&lt;/li&gt;
&lt;li&gt;Configuration: Exclusions, sensitivity, reporting&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Yara&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;language that lets you search for patterns in your scans&lt;/li&gt;
&lt;li&gt;strings - &lt;code class=&quot;language-text&quot;&gt;&amp;quot;in quotes&amp;quot;&lt;/code&gt; params: &lt;code class=&quot;language-text&quot;&gt;nocase&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;wide&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;wide ascii&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;fullword&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Byte patterns (hex strings) &lt;code class=&quot;language-text&quot;&gt;{}&lt;/code&gt; params: &lt;code class=&quot;language-text&quot;&gt;?&lt;/code&gt; &lt;code class=&quot;language-text&quot;&gt;??&lt;/code&gt; are wildcards &lt;code class=&quot;language-text&quot;&gt;{E2 34 ?? C8 A? FB}&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;conditions are boolean operators, arithmetic, and bitwise &lt;code class=&quot;language-text&quot;&gt;($a == 6 or $b)&lt;/code&gt; &lt;code class=&quot;language-text&quot;&gt;#a == 6 and #b &amp;gt; 10&lt;/code&gt; &lt;code class=&quot;language-text&quot;&gt;$a at 100 and $b at 200&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;example:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;rule myRule {
    strings:
        $a = &amp;quot;win.exe&amp;quot;
        $b = badfile1.exe
        $c = badfile2.exe
    condition:
        $a and ($b or $c)
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/d6c8310b7e03f48b679c26b2f70516c0/26c84/yara.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 49.33554817275748%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABS0lEQVQoz32S666CQAyE8YoX5CKKKIpX1BA1vP/L9fhNssYTjT8mu9m20+lsvaZp7Hg82ul0srqu7fF42G63s8vlYtfr1RaLhY3HYxuNRjo9z/uN7XYrgvl8bv1+37rdrgK9Xk9kWZYptlwubb1e22q1siRJ9N7pdD4JB4OBRVGkBE6XxPv5fJZySCCrqkrg7XA4GGImk8l/wjCMXqrewYhYgXpIhsOh8lqtlrXb7dcUH7V0CIJAcIkAgs1mI2W3201q8jwXmII4wCam4S6Pi2dB/vRqv98r6AjpTvF0OhUxHmJLURRqkqaplWUpn8lDkAh935fp+BXHschQSleIKMQvfKRwNpupObm8kQMpjeHx8CoMQ/0coBMkWEEhKjjx0t0hY4Kva8PPfgui8H6/azc52Ve3Wu6DvhIy8vtnOFCAZ24URkU5U/xa7D+P7+oXt1IKBgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Yara&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/d6c8310b7e03f48b679c26b2f70516c0/fb8a0/yara.png&quot;
        srcset=&quot;/blog/static/d6c8310b7e03f48b679c26b2f70516c0/1a291/yara.png 148w,
/blog/static/d6c8310b7e03f48b679c26b2f70516c0/2bc4a/yara.png 295w,
/blog/static/d6c8310b7e03f48b679c26b2f70516c0/fb8a0/yara.png 590w,
/blog/static/d6c8310b7e03f48b679c26b2f70516c0/26c84/yara.png 602w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Automated Analysis&lt;/h4&gt;
&lt;h5&gt;Cuckoo&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Automated analysis - You tell it what VMs to run and when you upload a sample, it will run it on the VMs and report the results.&lt;/li&gt;
&lt;li&gt;The host controller of &lt;a href=&quot;http://docs.cuckoosandbox.org/en/latest/introduction/what/&quot;&gt;Cuckoo&lt;/a&gt; tells each VM how to run the file. It will create the process, inject its DLL (randomly named to avoid detection) into the process, and then trace the Win32 API calls which then it can report back.&lt;/li&gt;
&lt;li&gt;It also reports files being created, deleted, and downloaded by the malware; memory dumps of the malware processes; network traffic trace; screenshots of Windows desktop; full memory dumps of the machines&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4&gt;Lab&lt;/h4&gt;
&lt;p&gt;We are given some sample files to analyze using Cuckoo. I chose to write about the last file. First I use the command line to run Cuckoo on the file:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/b0c184f694330c10af6d35ceadf9c996/5d9c9/cuckoo.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 96.9230769230769%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAACjklEQVQ4y3WU13KaQQyF95rQe+8dfprpJBkSxwETD2Mnef9XkffTWAw3vtDsImmPjo7E7za7gzSbTel2e2qdblcq1apEojGJekul0nqPRKL+NIvJl3BEYrG4nuGIWVTc6XyRlgccj8eyWCxkOp1ogVQqJZl0WorFomQyGSmXy5LNZiX7cc/n81KpVCSXy+m9VCpJMpkU9/h0kopPIKnqmWG1Wk2TW62WGgXwcdbrdS2G4dPCvkjaF+d019c3z2oqw9FINpuNLJdLNXyr1Urm87kEQSCz2UyOx6MMh0P93e/39U5n5FIoHo+LOz//UScPYQBD2BYKBWk0GsoCo3XY2kmuxbnTsgJeXq5aHaOKAQAIMI/NV/6QBs2Io58VgwinO3mGk8lEaQPa6/VUP4L3gPgYCkwSiYTqZcPixI+53x7w4WGheq3X65tm7XZbdUKOTqdzmzZGazYI/EyXYnSoDIeDgT4a+BNGVGJ6POBuLcKMh1G/i9wxYhQgH7bu+vZPAs8CsJGfNCcSAEz7TBKfse36xac4vzFi+LgD6o4/f2kCbdqE0QwmsLpfXuK0io8Y7MmjbXK05cP3401wmxytftYyPmsZ7Yhx4tMpv/79ry1aq7QIY3aLthnSvRwW426aW0f612MPg2CsYEzaVghDht1up/8gzu12e9uE/X6v2gGCTMbcnS8vOmWYAYbw3KnMAx7DCuOfATsbFkAMg8JIFQqFxP14fJKaF7vhE+8f2kfCwAHBiAHC3WRBZxvSrWWY8PlioUkCGMD7tcCMOYXIJc++SpBwh6/fFMg+EFQGCCasgQ0Ds48HYGhMLuC85Y0CzucLDfKQKgBBnSDrBAvWAdFt5+y/i4ZoxwqFw2G1dwCxE6FPJEQ+AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Running Cuckoo&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/b0c184f694330c10af6d35ceadf9c996/fb8a0/cuckoo.png&quot;
        srcset=&quot;/blog/static/b0c184f694330c10af6d35ceadf9c996/1a291/cuckoo.png 148w,
/blog/static/b0c184f694330c10af6d35ceadf9c996/2bc4a/cuckoo.png 295w,
/blog/static/b0c184f694330c10af6d35ceadf9c996/fb8a0/cuckoo.png 590w,
/blog/static/b0c184f694330c10af6d35ceadf9c996/5d9c9/cuckoo.png 650w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Cuckoo outputs a series of csv files in the /logs folder that detail everything the malware did. I start here reading the logs since I see the processes happened from ‚Äúbad‚Äù (which is what it‚Äôs configured to run on):&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/f521780945e3f6e10bae330aa5f563de/870c1/doc1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 69.98031496062993%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAB/0lEQVQ4y51SO2/UQBD2vwfE8VRCBIgCikABERFFaAKIDlHRpkvO3rXXj10/7nzoTvqYb7w5XASKFKO1Z3e+x8wkX86/4vTjKd6ffMKbtydYPH2JRwevsHjyQuI57iwOcO/hMzkPcffBYfw/0pO5+4+P8Pr4A76df8evz2dIjn84vPtZ4dI2WA09vPdYrVZYr9fYbDbYbrf6PY4j+mGQNyuM6xG73Q5d16HvB3n3G00IqCSSiyuLi0uLqvbwwcO5Qr5rNE2D5fIKxmTI8xx1U8NYg7IsJb9EJnnGMk2VaBTS0uVIijyDyw28AFCdc06Kp+9UHmdZqrnGN8gLAa6rPZi1Vkis3Hl0fSdkDgkvjDGq6GbADMWNgEYBGam8qaoKZVUiMbcBzGYKpdZL7waxzXYl1pKJgF4v2COCB+knC0noJOf3gLWCqELpLS1THQHVciGoVBVCi7ZrtSC0rUywRVEUyspcKzlaCmFywTuSa38bbsagQhImGCy4BmwVsMNENk2dOSrZA0qU7JuA8uR7ukhog2sRxC6DRZPlEC2bv0BiSS1Li67reE+1BIxDMXEo0x6WamHqYSorwx4W/1ubOG0OUQFtbmMiKuRQ5HKuUIciBGxBExecw6BC1hK8EiLGTOHt1ibTHYxD45SVbW65jIAzy+5fi51bPQmmeyi1fwDRbAfI79mkeAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Log 1&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/f521780945e3f6e10bae330aa5f563de/fb8a0/doc1.png&quot;
        srcset=&quot;/blog/static/f521780945e3f6e10bae330aa5f563de/1a291/doc1.png 148w,
/blog/static/f521780945e3f6e10bae330aa5f563de/2bc4a/doc1.png 295w,
/blog/static/f521780945e3f6e10bae330aa5f563de/fb8a0/doc1.png 590w,
/blog/static/f521780945e3f6e10bae330aa5f563de/526de/doc1.png 885w,
/blog/static/f521780945e3f6e10bae330aa5f563de/870c1/doc1.png 1016w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/4dd2151ced827126ce79414658b99484/d5f08/doc2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 66.69902912621359%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACBklEQVQ4y4WSW2vUUBSF8///gLZqpXhD8EnECwNSC/pQ6IOF0okzFTQzk9tJMpPbJHNb7rWTE6UUDGzOScj+zlp7Hefi8gqfv3zDu/cjfBqd4fWbt3hwfIpHT1/i4eNnOHryXPdHdn/yAseyDiXvJ6ev8GF0jouzczg/b2+RmRCJiRFGMbLlEmVZIssyFEWB1WqFpVRVVvpeFCXqupZao2la2Ge73SGXf5zv1zf46kb45ceIogBxYmAEPpt7yAnMBSiHVFUp4KUeVFUVqrrqwOu1wLbY7XbYbjYEuvh4FWLihYjjsAcaAc6QZimCMMB8MVfoWpoJoQOq5VqKKgts2xbOD3eMVRIiFdDC9xGLOmMSeDNP7RNOVfz5cDgMxcfuCVOFAnbG47GoiLRx4S96oBHgb7Gbq8okSdQmVeXyTecqh3HlO0H7/V4ObeBMJhOBdDb9wIfpLdMm59eF0gXFJiriel9RpTOdTkUh5xcrMBFgJHt+I8yXMYSyj6JQlfIwHtA0jQRSo5FRWKAqdMWyHwTSEN2x7HWW01QOiNQuA6H1kin3xaC6Ge67UDhDwth4NxQq5HeGoor0/v1N2c7UznDDa+O6HTAeQjFqn3s2E8YmVabXpFS4nZmtAUiF3WwShZgeyFDYSEssXmRrs2n/Awz/CcXOkKoHW0WuEM4ul+TZeC9QZvgH6lDQFIQ8fBsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Log 2&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/4dd2151ced827126ce79414658b99484/fb8a0/doc2.png&quot;
        srcset=&quot;/blog/static/4dd2151ced827126ce79414658b99484/1a291/doc2.png 148w,
/blog/static/4dd2151ced827126ce79414658b99484/2bc4a/doc2.png 295w,
/blog/static/4dd2151ced827126ce79414658b99484/fb8a0/doc2.png 590w,
/blog/static/4dd2151ced827126ce79414658b99484/526de/doc2.png 885w,
/blog/static/4dd2151ced827126ce79414658b99484/d5f08/doc2.png 1030w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It looks like the malware tries to find out information about a &lt;code class=&quot;language-text&quot;&gt;prints.exe&lt;/code&gt; file (NtQueryDirectory) as well open the file and another file &lt;code class=&quot;language-text&quot;&gt;ntshruis2.dll&lt;/code&gt; from &lt;code class=&quot;language-text&quot;&gt;C:\Users\Admin\AppData\Local\Temp\&lt;/code&gt;. It also creates a registry key in the Session Manager and tries to open various registry keys. It later successfully creates the &lt;code class=&quot;language-text&quot;&gt;prints.exe&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;ntshruis2.dll&lt;/code&gt; files, as well as a &lt;code class=&quot;language-text&quot;&gt;Deleteme.bat&lt;/code&gt; file in &lt;code class=&quot;language-text&quot;&gt;C:\Users\Admin\AppData\Local\Temp\&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Looking at the strings, I also see it looking for a user &lt;code class=&quot;language-text&quot;&gt;SOFTWARE\Borland\Delphi\RTL&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Knowing about the files it creates and where they are stored, I open up the Temp directory before running the malware:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/e771ebf34808e495ce8e831561ceeaa3/b7a32/created.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 34.18803418803419%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABoklEQVQoz2VQPU8VQRTd/4IR/ACMhGdhbGxorPgFFlT0FBb22hliYUlrYmnkKwg8Aw+I8hKIhcbney8+WHdnv2Zndmbf7izHO+NH4yQn99yce8+5GW/tzQZWnjzFwqNF3Gk9wOT0PK7fnsPUzDyh9R+u3ZrDxM27uDF7D637D/F4aRmrL1/h9eoLrD1/Bq/bj3HwqYv13WOsv+9gq32Ct9sfHN/cO8K7nUPsHJyifXLmsLH/kWaPsNfpUn+O/eNz2v+M9ukXbHbO4A1/BAiSAhHXuGQ5wrRAIsYIqKZU//ZW9yOBVFaut8i1QZgpRDlpTODrIIT3vd9HmsSwT6sUgT+CFML1V435h0IKxHGMPOcoCgkhctTVGKau0ZjfiHgB79L3cTG6gNYaUmkM+gP0vvUQhgxSFjDGoK4NGQiEjCHLMuISjHiSpKjI0O3SLJcaXhIzSs3dkiJhSIY2oCxLVOPKGTYEzjP4FG6v5GQa/AxciDENaRycPBh9i9cbjsCC0AmlVkiiiAZyNE3z57raVaWUC7aXWG7NrGbnylK7Y4JU4RfBwufRhGXrcwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Created files&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/e771ebf34808e495ce8e831561ceeaa3/fb8a0/created.png&quot;
        srcset=&quot;/blog/static/e771ebf34808e495ce8e831561ceeaa3/1a291/created.png 148w,
/blog/static/e771ebf34808e495ce8e831561ceeaa3/2bc4a/created.png 295w,
/blog/static/e771ebf34808e495ce8e831561ceeaa3/fb8a0/created.png 590w,
/blog/static/e771ebf34808e495ce8e831561ceeaa3/b7a32/created.png 819w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I also see a file called &lt;code class=&quot;language-text&quot;&gt;qinput.png&lt;/code&gt; which I translate using my phone. It looks like a login screen:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/4ff17cc80b1f9a314475eb16738ab8bc/e3ca9/created2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 70.68004459308807%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACYElEQVQ4y42Sy27TQBSG8zDseQGegSULWHSHCgKhUipxkVAEqFWXILJCSBULtl0gSpUipaoUpYhWapIW4iap6zh27MSOx/fcf844CXFSFiw+zZkzM7+Pz38SmcMCTgQZuaKEg7yE/YKMdEHHTr6JnRMdu8UWdgsz0mcG0qdj9ijeFywclg3k8wL2tr8iUa0b0FgHqhmMaQdomD5Uw0OThWjZnYimzePZPp7XrBBmCByV6kiYThdO0IftE8EMRvu214uwvP4c/CyORXf87giVSwUJXsU0GccJBgh7QNgdIgj78GPYC/fbbhdeFxAuqEKNfpFXxA+YP77ghgMIqoXtbJF6WUNGdHEgecjKPrI1D3V640zeWD4X7EWCv6skWK1pcDujOUFendh08CVXwPd8BUcyww/RwE/JxLFsQbWCWZW8NVShT4K/uOC5qFwR5C0w3Q4000KtoaPRaqOmapApVptmdDa9z+KCFRmJ8uVVQf51zfKgGAzUQoSDUbR2CDqK3GbcIG7KxDj+y6ULMqUs/ltQaXuo6DZUFkBhPmTTofHyKe9Cp9xfI/3/FvQhaIywcUYGHYs6SooJod6aE2SLgtxqJxyBz2N8FNhk3uwpZFR87hbHhto6FpTUFjV0SIk+ucur60Ywb0a0X8zFYovUuEapSqZ8y+SoTyOUzm1IWg+KPYRqA5oLNBxA90BjQjk2jGKeX6RBGFRhkUYrce36Ddy+n8TNW6u4s/wKSyvrePAyhbXNLTzd/Ii1Nyk8Wv+MlY1PePI6hdWNLTxb/4DHyfe4+/wtlol7L95F69LDJP4A/x0HA7PL3voAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Created image file qinput.png&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/4ff17cc80b1f9a314475eb16738ab8bc/fb8a0/created2.png&quot;
        srcset=&quot;/blog/static/4ff17cc80b1f9a314475eb16738ab8bc/1a291/created2.png 148w,
/blog/static/4ff17cc80b1f9a314475eb16738ab8bc/2bc4a/created2.png 295w,
/blog/static/4ff17cc80b1f9a314475eb16738ab8bc/fb8a0/created2.png 590w,
/blog/static/4ff17cc80b1f9a314475eb16738ab8bc/526de/created2.png 885w,
/blog/static/4ff17cc80b1f9a314475eb16738ab8bc/e3ca9/created2.png 897w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Translation:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;re-register&quot;&gt;&lt;pre class=&quot;language-re-register&quot;&gt;&lt;code class=&quot;language-re-register&quot;&gt;Dear User:
Since your network is unstable, please login:
[input]
Password:
[input]
[Login] [Cancellation]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Looking at the &lt;code class=&quot;language-text&quot;&gt;Deleteme.bat&lt;/code&gt; file, it seems to do exactly what it‚Äôs named, delete the source of the malware:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/fee8c8abdd33d05bfa0c9ab9554ba1a9/cf471/created3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 26.773888363292336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABTklEQVQY03WP3StDARyGzz9GQpqvaMTccOOjSG4myYU/QPKRK3GhcIPSppaxDdvZztlpOzqO2c5m5+xYRORurbb1OLiUXz09N+/71k/YWlrm4NjH2Pg0k3MLeJdXGJ+dx+0ZpdXVS0//EH2DI/S6h2np6KaptZPm9i6a2hw7uAY8THgXWd3YZGFmCuH2LoPxoKCmUiSSOnJKQ1Vvyeg6ecPALD5SLj/x8vJMybbRswUyRpFMzsG0ub+Ik17fJ719wtH6LkIsIfGNKCcdy86oguRwE4sRjkSQZJnzYBD/mZ9Tnw9/IMBVTCR8EyXkZEL+AJc7h1zvH7O3toWQz+bIF4oUTQvTsnl9e+f94xOrZJNWVSyr9ONoNIooiiTicRKShKIoaJqGdq+jGVkKTyWC4RAC/1y1WnVeLVOpVGg0Gj/UajXqtfqv6/U/Hcs0+QLcX0QEn39BogAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Deleteme.bat&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/fee8c8abdd33d05bfa0c9ab9554ba1a9/fb8a0/created3.png&quot;
        srcset=&quot;/blog/static/fee8c8abdd33d05bfa0c9ab9554ba1a9/1a291/created3.png 148w,
/blog/static/fee8c8abdd33d05bfa0c9ab9554ba1a9/2bc4a/created3.png 295w,
/blog/static/fee8c8abdd33d05bfa0c9ab9554ba1a9/fb8a0/created3.png 590w,
/blog/static/fee8c8abdd33d05bfa0c9ab9554ba1a9/526de/created3.png 885w,
/blog/static/fee8c8abdd33d05bfa0c9ab9554ba1a9/cf471/created3.png 1057w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Finally, the malware tries to download one file, &lt;code class=&quot;language-text&quot;&gt;TJ.asp&lt;/code&gt;:
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/23ae0c646c8890afe7da4d3d5b50c14c/32413/network.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 583px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.089193825042884%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACDklEQVQoz42SS2sTYRSGJzEJuZPQ3Cb3+3UumSRNJiYL9xJsaiRpa0GCqJWKRdA/4M6ley12odlYkFYdNzUQaSlqwYJ/QH/I63wHKy5a2sXLOXNmvvc853zDffpyBE2bQvs4xcH+MWafv0Gb/sDrvWN8OPqF7dlPvNrZh/b1Nybad0zeHWDyZg8vXu5ic/M9trY0bL+dYXfnUPc4BPf02XMsLCxiOFzBYDBCr9dHf7CE3mAZV/tD9K6PsDq+i8HyLTQvX4Egz0MQaqhUFBLLlWqLJEkNcPfWN5BKJiCIArLZLJLJJGRJ1GtxZDNp8MEA/L45uF0OcBx3vh4+eoJ0KgVZllEsFlEqlfTOFUj6cy6XQ0Zvks/nkU6n4fcHYDQaYTAYdBlPFbcyXkM0wiOeSCAejyMcDlP0eDxwu90U7XY7mVyI8M6Dx1Bb82i1VNTrdSJlSunUoVBIp/LD6XTCarXCZDKdb3jz9jr4UIAMYrEYGUSj0X+kLLJ6JBIBz/MIBoP0jc/nowlYZDWH4++Or91YhemSEV6vFzabjV6w3OVyERGrmc1mIrzQyOO1DdSUKrrdLtrtNlRVRafTQbVaJTJGzm6fkfy/xzN32lscoVIuQdYNBEFArVZDs9kkQ5YrioJGo4FyuUzKZDLUhE1w+g7H9xGLRiCKIv0uhUKBDkqSRLdrsVhIJ+Of5GeN/AdK40dTGlNvXQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Tries to download a file&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/23ae0c646c8890afe7da4d3d5b50c14c/32413/network.png&quot;
        srcset=&quot;/blog/static/23ae0c646c8890afe7da4d3d5b50c14c/a734f/network.png 148w,
/blog/static/23ae0c646c8890afe7da4d3d5b50c14c/5c6ba/network.png 295w,
/blog/static/23ae0c646c8890afe7da4d3d5b50c14c/32413/network.png 583w&quot;
        sizes=&quot;(max-width: 583px) 100vw, 583px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Thoughts on Forensics (Defense of the Dark Arts)]]></title><description><![CDATA[This week focuses on how to investigating security incidents. You should be aware of the best way to investigate it while being careful to‚Ä¶]]></description><link>https://michelelarson.com/blog/security-forensics/</link><guid isPermaLink="false">https://michelelarson.com/blog/security-forensics/</guid><pubDate>Fri, 18 Jan 2019 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;This week focuses on how to investigating security incidents. You should be aware of the best way to investigate it while being careful to preserve evidence.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Side note - the lecturer talks about the book, &lt;a href=&quot;https://www.goodreads.com/book/show/18154.The_Cuckoo_s_Egg&quot;&gt;The Cuckoo‚Äôs Egg&lt;/a&gt;. I read it last year and loved it!&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;Types of cases you may investigate&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Fraud&lt;/li&gt;
&lt;li&gt;Intellectual Property&lt;/li&gt;
&lt;li&gt;Hacker Intrusions/Data Breaches&lt;/li&gt;
&lt;li&gt;Inappropriate use of Internet&lt;/li&gt;
&lt;li&gt;Child Exploitation&lt;/li&gt;
&lt;li&gt;eDiscovery supporting Civil or Criminal Litigation&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Stages of Investigation&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Evidence acquisition&lt;/li&gt;
&lt;li&gt;Investigation and Analysis&lt;/li&gt;
&lt;li&gt;Reporting results&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Forensics&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Includes: Identifying, preserving, analyzing evidence and presenting results.&lt;/li&gt;
&lt;li&gt;Could find evidence in network, operating system, databases and applications, peripherals, removable media, human testimony&lt;/li&gt;
&lt;li&gt;To keep in mind: It‚Äôs not up to you to judge guilt. It‚Äôs up to you to show what happened. If you think someone is guilty, you look for information to prove your opinion, so it can make you biased while investigating.&lt;/li&gt;
&lt;li&gt;Need to describe results in a way that a judge will understand. Something the lecturer does is ask questions like an attorney to see if there‚Äôs anything a judge might ask that they can clarify now.&lt;/li&gt;
&lt;li&gt;Always check times and keep records of times.&lt;/li&gt;
&lt;li&gt;Any time you do anything, it affects the memory and could erase something.&lt;/li&gt;
&lt;li&gt;Locard‚Äôs Exchange Principle - when two things interact, there is always transference of material. Thoroughly document anything you do on a live system.&lt;/li&gt;
&lt;li&gt;Triage - There may be different ways to do something. You should check multiple ways to make sure you can come to the same conclusion.&lt;/li&gt;
&lt;li&gt;You can‚Äôt log into accounts even if you come across the username and password. You need permission from a judge. It has to be relevant to the case.&lt;/li&gt;
&lt;li&gt;Harddrives are giant and there may be a time limit. You also might get additional harddrives, portable harddrives, cell phones, etc. It takes time to process the data.&lt;/li&gt;
&lt;li&gt;Whitelisting is good to match checksums and verify files are ok and you don‚Äôt have to waste time investigating them. The person processing the harddrive will do a checksum of the entire harddrive. The first thing you should do is check that to make sure the evidence wasn‚Äôt tampered with.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Incident Response Process&lt;/h3&gt;
&lt;ol start=&quot;0&quot;&gt;
&lt;li&gt;Incident Response Team Preparation&lt;/li&gt;
&lt;li&gt;Incident Detection&lt;/li&gt;
&lt;li&gt;Initial Response&lt;/li&gt;
&lt;li&gt;Formulate Response Strategy&lt;/li&gt;
&lt;li&gt;Investigate the Incident
4a. Data Collection
4b. Forensic Analysis
4c. Perform Non-Forensic Investigation&lt;/li&gt;
&lt;li&gt;Document Findings
5a. Administrative Action&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;APT Case Evidence&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Reconnaissance: Firewall/IPS logs&lt;/li&gt;
&lt;li&gt;Delivery - Email Gateways logs, proxy logs, internet history, Java-IDX files&lt;/li&gt;
&lt;li&gt;Exploitation - Windows Event logs, crash dump files&lt;/li&gt;
&lt;li&gt;Installation - $MFT, memory dump registry, prefetch-files&lt;/li&gt;
&lt;li&gt;Command and Control - Memory dump, firewall logs, proxy logs, netflow&lt;/li&gt;
&lt;li&gt;Actions on Objectives - $MFT, memory dump registry, prefetch files, netflow, remote tools&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;Initial Response - Shutting off the machine can destroy evidence, but you should pull network cable or block port (attacker may be on network still, even watching you!)&lt;/em&gt;&lt;/p&gt;
&lt;h4&gt;Order of Volatility - RFC 3227&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Gather evidence in specific order, capturing the most volatile things first&lt;/li&gt;
&lt;li&gt;System memory&lt;/li&gt;
&lt;li&gt;Temporary file systems&lt;/li&gt;
&lt;li&gt;Process Table and Network Connections&lt;/li&gt;
&lt;li&gt;Network Routing Information and ARP cache&lt;/li&gt;
&lt;li&gt;Forensices Acquisition of Disks&lt;/li&gt;
&lt;li&gt;Remote Logging and monitoring data&lt;/li&gt;
&lt;li&gt;Physical config and network topology&lt;/li&gt;
&lt;li&gt;Backups&lt;/li&gt;
&lt;li&gt;Non volatile data (Time/Data stamps, event logs, web/application logs, registry)&lt;/li&gt;
&lt;li&gt;Relevant logical files (Unknown executables, attacker tools, any other files related to incident)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;FTK Imager&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Easy free tool, to dump memory, but leaves an imprint in memory so it‚Äôs better to do with commands.&lt;/li&gt;
&lt;li&gt;Note - Never install forensics tools on a suspect‚Äôs computer, because you‚Äôre influencing!&lt;/li&gt;
&lt;li&gt;Capture memory - don‚Äôt store it on desktop. usually will want to store on a shared network. Naming - operation + serial number or date + .mem. You can decide to include pagefile&lt;/li&gt;
&lt;li&gt;Add evidence item - you can copy external sources&lt;/li&gt;
&lt;li&gt;Take a look - find root -&gt; $MFT master file table. You can export it from this tool&lt;/li&gt;
&lt;li&gt;Create disk image, pick encase (E01) as format or raw (DD)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Physical memory - system memory (RAM) - short term memory&lt;/h4&gt;
&lt;p&gt;You can get‚Ä¶&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;All running processes at time of snapshot&lt;/li&gt;
&lt;li&gt;All loaded modules and DLL‚Äôs including malware&lt;/li&gt;
&lt;li&gt;Running device drivers, including rootkits&lt;/li&gt;
&lt;li&gt;Open files for each process, including path to file on disk&lt;/li&gt;
&lt;li&gt;Open registry keys for each process&lt;/li&gt;
&lt;li&gt;Open network sockets including IP address&lt;/li&gt;
&lt;li&gt;Decrypted versions of data&lt;/li&gt;
&lt;li&gt;Contents of windows&lt;/li&gt;
&lt;li&gt;Keystrokes&lt;/li&gt;
&lt;li&gt;Email attachments, file transfers&lt;/li&gt;
&lt;li&gt;Cryptographic key material&lt;/li&gt;
&lt;li&gt;WEP and WPA wireless keys&lt;/li&gt;
&lt;li&gt;Usernames/passwords&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Analyzing Memory Dumps&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Look for a printable string&lt;/li&gt;
&lt;li&gt;Reconstruct internal data structures&lt;/li&gt;
&lt;li&gt;Search for static signatures of kernal data structures&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Volatility&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Advanced memory forensics framework&lt;/li&gt;
&lt;li&gt;Plugins - malfind, csrpslist, orphan threads, PSList, PSScan, svcscan, ldrmodules, impscan, apihooks, idt, gdt, callbacks, driverirp, psxview, ssdt&lt;em&gt;ex, ssdt&lt;/em&gt;by_threads&lt;/li&gt;
&lt;li&gt;Yara - Malware plugins for Volatility&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;volatility.exe -h    // shows options
volatility.exe -f nameofmemorydump pluginname
volatility.exe -f nameofmemorydump --profile=Win7SPOx86 pluginname&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;Plugins:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;imageinfo&lt;/code&gt; - tells us windows operating systems. image date and time - when you took the memory dump&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;psscan&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;dlllist -p &amp;lt;processid&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;netscan&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Deskscan&lt;/code&gt; - &lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Getsids&lt;/code&gt; - see which user rights the malware was running&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Windows Registry&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;regedit&lt;/code&gt; in run window
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/87791a29882b11a34ebbf788ee275572/4f5b3/registry.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 291px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 79.03780068728523%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADEUlEQVQ4y52S20sUYRjG518oqMD7LrsqqPAmb0KILjpQKeJFYGrioQgFS/F0oWWJZpIgnaBCkP6CrrU0a13X3dnjzOwcdg47M7utGrqHp/ebXRUv8qIPHr73m8Pve94DV1P/EFeaulHfOYC2Jy/Q+ngcLb3P0NQzhobOQdR3DOJSXReqqu/gxPmbOH7uOo6d3dO1isrn4ySuprkXp+8242pjOxraenD73qOKulFbdx+1t1pw5nIjuKpqcCcvHK1TF8HdaO3H6OxHTL5ZwNTbBUzMzePp608YefkeQ1MfMDD5Dt2js+gamcGD4Rl0Db/y1DE4jc6hctw5NL0vrn1gGtF4CnwsBUl1sRYQkJBdRBMG1oMiRCULIWkjHNPomY5QRIGkZJCkbzd4GXHBhOUWYdq7pDwB+yegW1nEJQOBkI6EqEGSDYgkFguSDkVLl5Uq72rKhma4kDULsmp5/+tmBikS1zc2AwdAWLHwed6HaEyAz+fDr5+rWCUtLS0ik83i6FXa37n2vudeWCjksbX9B9l0AL9dEZKkIhKNQjcMOI4LXddhUKxpKTi27e3snMlkyqhSCcVikRyOz1UeFJEvApvpZWy6PDRKTxJFpOlny7IgCAIURYEoSQSjUiQE75JcLncYuOQXvAMD7uwCW/YPAoaRlHXwPA+TYMxJOMxjbX0DwVAYadOAqqlY8wdgpu0DIIn78nWFncoOCwR0/NjKJghERZdl2I4Dm6WoqgRJkds0TLrANE1IyfJ7BmLLc/h9PYQSBZ7DPJCzlpBzgpSiSq7ClLoOlcAsTVlWvH1leQVyUkQkEsO3xUWCugfABN1WrACZw2234tB0kEwmvY+ZGxYzIKtZoVDAzs7OvvL5/AEwQB/tAXfzrCkr5DAEWTHIQZhSp+ZQIyKRKOLxhAf71/KAkqodArKmbGWj5EYnQJwaYtLYOIjHogjyEWpUhOqpeI1il/hpZhVilBtLTVG0PWAJBRqb7QxPQBqXNE1+SqM5y3qFN2hEVG/2LLh0ZrPJGsRq6rjuAVCuAA9P/P8txvkL/uNLqQsdAo4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Registry Editor&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/87791a29882b11a34ebbf788ee275572/4f5b3/registry.png&quot;
        srcset=&quot;/blog/static/87791a29882b11a34ebbf788ee275572/cde50/registry.png 148w,
/blog/static/87791a29882b11a34ebbf788ee275572/4f5b3/registry.png 291w&quot;
        sizes=&quot;(max-width: 291px) 100vw, 291px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HKEY (handle to a key). Most important are &lt;code class=&quot;language-text&quot;&gt;HKEY_USERS&lt;/code&gt; (HKU) - profile of users, &lt;code class=&quot;language-text&quot;&gt;HKEY_LOCAL_MACHINE&lt;/code&gt; (HKLM)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Timeline Analysis&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;$MFT (master file table) - check timings of when things are changed
&lt;code class=&quot;language-text&quot;&gt;volatility.exe -f nameofmemorydump --profile=Win7SPOx86 mftparser --output=body &amp;gt;&amp;gt; mftparser.txt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Reg-Ripper&lt;/li&gt;
&lt;li&gt;Volatility timeline
&lt;code class=&quot;language-text&quot;&gt;volatility.exe -f nameofmemorydump --profile=Win7SPOx86 timeliner --output=body &amp;gt;&amp;gt; timeline.txt&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Files and Directory Analysis&lt;/h4&gt;
&lt;p&gt;Things to check:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pagefile.sys, index.dat, etc&lt;/li&gt;
&lt;li&gt;Windows event logs (Application, System, Security, DNS)&lt;/li&gt;
&lt;li&gt;IIS/webserver/FTP logs/URL Scan - the web could be a point of entry&lt;/li&gt;
&lt;li&gt;Windows firewall log (%windir%\pfirewall.log)&lt;/li&gt;
&lt;li&gt;setupapi.log - installation of applications and devices&lt;/li&gt;
&lt;li&gt;schedlgu.txt - scheduled tasks&lt;/li&gt;
&lt;li&gt;Application configuration files and logs&lt;/li&gt;
&lt;li&gt;Antivirus/IDS/IAS/ISA Server logs&lt;/li&gt;
&lt;li&gt;Prefetch folder &lt;code class=&quot;language-text&quot;&gt;strings C:\WINDOWS\Prefetch\PWDUMP2.exe&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Evidence of malware, rootkits, etc&lt;/li&gt;
&lt;li&gt;System restore points&lt;/li&gt;
&lt;li&gt;Hybernation file&lt;/li&gt;
&lt;li&gt;Crash-dump files&lt;/li&gt;
&lt;li&gt;LNK files&lt;/li&gt;
&lt;li&gt;Shell-bag - when you open a window&lt;/li&gt;
&lt;li&gt;HKEY_USERS for internet browsing history, last accessed files&lt;/li&gt;
&lt;li&gt;Autorun locations&lt;/li&gt;
&lt;li&gt;MRU lists&lt;/li&gt;
&lt;li&gt;UserAssist&lt;/li&gt;
&lt;li&gt;USB devices&lt;/li&gt;
&lt;li&gt;Geolocation&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Data Recovery&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;When you delete files, the markers in memory for the data are deleted, but not always the data&lt;/li&gt;
&lt;li&gt;You can use a program to search for the data such as PhotoRec. Header files start with certain keys, so it looks for starting with JOJA and footer has xyz.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3&gt;Lab&lt;/h3&gt;
&lt;p&gt;We are then given a challenge, a Korean defector was caught with a USB stick that we need to investigate.&lt;/p&gt;
&lt;p&gt;First I mounted the contents of the drive to a drive on my VM using OSFMount:
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/55db41f0441e2e74076a184508eda16f/6e3a5/1-mounted.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 19.888475836431226%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAABD0lEQVQY0yWOW0sCYRCG9xd2pOwmEwJDiLIuRCK6CCLoOiShm4KILoL+QD8hqMxSk4KV1XVb3fO3J5anz3VgeOeZeWcY5fb+kbuHJy6bN9ROLtitnbJXP6NYPmRlY5tCscJO9Zjq0Tlb5QMW14osF0osrZdyXVjdpLJf56pxzXOzgfLy+kGr3aH92aX3/Uu394M+NgmjFBHGBCLGDyKpkeQk51nO5nNPgusJzKmL4QiUr04HbTik3++jaRpjw+DPNLEsW6aFZduYkke6zmikE4YhU9kfDAaoqspkMkGXM0Pu2bKvvL23yLIMx3HwPA8hhFQ/r13XJYrkd0GQs+8HzCJJ5FfunNM0lZ44vxHHMf/B5BL0uFCssAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Contents of USB&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/55db41f0441e2e74076a184508eda16f/fb8a0/1-mounted.png&quot;
        srcset=&quot;/blog/static/55db41f0441e2e74076a184508eda16f/1a291/1-mounted.png 148w,
/blog/static/55db41f0441e2e74076a184508eda16f/2bc4a/1-mounted.png 295w,
/blog/static/55db41f0441e2e74076a184508eda16f/fb8a0/1-mounted.png 590w,
/blog/static/55db41f0441e2e74076a184508eda16f/526de/1-mounted.png 885w,
/blog/static/55db41f0441e2e74076a184508eda16f/6e3a5/1-mounted.png 1076w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/77ce83f124f5f45d668d35413d4e5e2a/ab1f1/1b.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 44.90909090909091%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABrklEQVQoz4WRz07bQBDG/XSoqkSrFEgrQlS4wLmXXhBHWsEJbly58wJ9gp44AaoK+YNZL3bsrO1d25s4tvk6uwEaJCQsfZrdmdnffCM73w9P8W33B/YOT9Bqd7H0/iOWW2201jpY39zB+tdtrHW28Km9Mddnoy5WvnTxYaWDd8ur6Gzt4Of+Ac6Oj+D8+n2Ji2sPV30flz2Ov26IPwMffS8GFxN4Yw03UBjwBMP7FEN/LjeQ6FOu5wlcuxEuej7OexEc3+cIRiGUyiDSDEmqkCQpRJxASmXzZTlDnEhbK/QEknKa4pTyRUFxWqJuHig3hcPvGbJM0UUjiEZgHsMd8xBFY2rW0BPzsIQQMcZCEEzRsJjg0g7K8pze52iahsAEvLll5HBkJ4YhARmzDmggZrMKs6q2TgwsGgukBDJw+ehcEcxADXBCTp0B40iltE7CwIeSKTXSCnVNquaxquwGWhfWhS6K556ynNpzQ2cL5H5Iq+XI88JONV9FgBeycBK5MLF5jKZWP9WegLe08ohWNauYn9A0/xsX42tarD0DXeZiMByCc27XeW3yW1oE/gMt/ZIfmgcVHQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Contents of USB&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/77ce83f124f5f45d668d35413d4e5e2a/fb8a0/1b.png&quot;
        srcset=&quot;/blog/static/77ce83f124f5f45d668d35413d4e5e2a/1a291/1b.png 148w,
/blog/static/77ce83f124f5f45d668d35413d4e5e2a/2bc4a/1b.png 295w,
/blog/static/77ce83f124f5f45d668d35413d4e5e2a/fb8a0/1b.png 590w,
/blog/static/77ce83f124f5f45d668d35413d4e5e2a/526de/1b.png 885w,
/blog/static/77ce83f124f5f45d668d35413d4e5e2a/fa2eb/1b.png 1180w,
/blog/static/77ce83f124f5f45d668d35413d4e5e2a/ab1f1/1b.png 1650w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Next I used the Google Translate app on my phone to take a picture of the files and translate them:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Democratic People‚Äôs Republic of Korea - country to.mp3&lt;/li&gt;
&lt;li&gt;Target list.zip&lt;/li&gt;
&lt;li&gt;Rootkin.bin&lt;/li&gt;
&lt;li&gt;Target.bat&lt;/li&gt;
&lt;li&gt;Goal.png&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;Targets&lt;/h5&gt;
&lt;p&gt;Looking at the contents of the jpg file as strings, I found the password:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/407d57d1c0dff5f0b58283721bc98cc5/02562/3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.22078482104355%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACUUlEQVQozzVSWU8aURSeX9nEVlEQg7XbW9M+9ql9aOxrE0lMFAGNCyJENoelUZZhFgYGlHWgLLaVNqlBKmq+nnvVm3w5833n3C/nnDuC8+sKPnz6jDn7a8wtvITVvohZ2wKs8w5Mz9oxY3WQtgTbwgs8tczDMr8Ex6u3mJq24cnUDEUrnlnsWHz+Bh/fv4OglzToSgrpnA61dIpisYhSqYRWq4mzWp1rmnHGUShXoRFXixX+rVfqKBikVWpQD0SkfVEIYuIbTnIaMpJMUBA8DGN9fR2RWAz7/gO4PB5seD3wbm3BQ9je3YV7c5Nz5+oq3F4vNqjGueLExtoahFarhavxGLd3d5hMbmCabYRCIciyjHa7jcFggF63iy6h0+k88B46lGs0GmgSTPJgPv1+H8Jw+JuMJrgjQ3aYmEqlkM1mYRgGN1ZVlUdFUfg6GFg+k8lA1TRUqzVqxMTFxRDC8fExqrUams0mTk9pX1TAOtze2UY8HucmLGe2TJ7P5/O8pl6vc67rOsrlMhr1BmrkI/j8QWRyMsRECjt7fiSSKUQiEbjdbix/WcYa7SUQCMDlcnGd4YD4YegQ0WiU8yPxiHPWtTA4/4HxvwlGV2M+skm7kXI5SJIEn28P4XCYoo8uhvmoJ+kTBIMBBAh+/z5EUeRTMPNkMglhPL43ejxGuYJwLI50VoGs6sgrOhStSLGArHSvabrxgDLPSbLGo1ooQWAPcnl5yTEajdDufMev4R8Mzn/yRbMJuvSqvV4fVzTFze0trunONf0RDJMHMP0vefwHe2WYwkxF0g0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Password found&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/407d57d1c0dff5f0b58283721bc98cc5/fb8a0/3.png&quot;
        srcset=&quot;/blog/static/407d57d1c0dff5f0b58283721bc98cc5/1a291/3.png 148w,
/blog/static/407d57d1c0dff5f0b58283721bc98cc5/2bc4a/3.png 295w,
/blog/static/407d57d1c0dff5f0b58283721bc98cc5/fb8a0/3.png 590w,
/blog/static/407d57d1c0dff5f0b58283721bc98cc5/526de/3.png 885w,
/blog/static/407d57d1c0dff5f0b58283721bc98cc5/fa2eb/3.png 1180w,
/blog/static/407d57d1c0dff5f0b58283721bc98cc5/08f6a/3.png 1770w,
/blog/static/407d57d1c0dff5f0b58283721bc98cc5/02562/3.png 2319w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Which I used to unzip the zip file:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/a86b08d31715bef6501959cc0c6ac298/511d6/4.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 20.64404830362277%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/UlEQVQY002OuU7DUBBF/ak0FCRpIICQMChIIERDgYTYREdBR0GH4AsQBVUQMYiQzbKf/bw887wlB8cFpLiamTN3FuP2/pHrmzu2949ZWtlkublFY9WktbFHc71Da1EVq3m7Q2Ntl7Z5xM7hGebBCeenlzxcXWC8WK+89fp8jm0+vscMrAHOsE9WlBTFjLyYLmhGlpe15nWaFaRpTpJoZBDjhglG13rnazhmNJogfR8pJY7jYE9sXFfgV0wI8cejKKpzITzCMKx7XuVRSqHiGOO5J3jqhvgqJ8tSkh+N1rpa5uJVQ1IGeJ5PEAT1AaWSyjf/6j9qnZLnBWU55RdLNRZPK4ZqSAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Unzipped file&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/a86b08d31715bef6501959cc0c6ac298/fb8a0/4.png&quot;
        srcset=&quot;/blog/static/a86b08d31715bef6501959cc0c6ac298/1a291/4.png 148w,
/blog/static/a86b08d31715bef6501959cc0c6ac298/2bc4a/4.png 295w,
/blog/static/a86b08d31715bef6501959cc0c6ac298/fb8a0/4.png 590w,
/blog/static/a86b08d31715bef6501959cc0c6ac298/526de/4.png 885w,
/blog/static/a86b08d31715bef6501959cc0c6ac298/fa2eb/4.png 1180w,
/blog/static/a86b08d31715bef6501959cc0c6ac298/511d6/4.png 1739w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;And read its contents, the list of targets! (included S-Oil Onsan Refinery, GS Caltex Yeosu Refinery)&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/f0ec9196d316c5129de247ce423f8f06/34f25/5.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 8.734939759036143%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAiElEQVQI1yWLyw7BUAAF+8u0VRVVRGJLrldUNVa+x94HWCK9r+rNuOoks5nMCYrqykocEfszYleyPVSsNwXxaE44nBKlM2JPmOQdkXdpviQZL+gPMs+EXpx1zam4ENzuD4ySSKWRUvF8valrSdN8UFpjjMFYy2/OOdrWoX2rvZdKYW3zb4ztvl+RvYCnwaVvcQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Opened file&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/f0ec9196d316c5129de247ce423f8f06/fb8a0/5.png&quot;
        srcset=&quot;/blog/static/f0ec9196d316c5129de247ce423f8f06/1a291/5.png 148w,
/blog/static/f0ec9196d316c5129de247ce423f8f06/2bc4a/5.png 295w,
/blog/static/f0ec9196d316c5129de247ce423f8f06/fb8a0/5.png 590w,
/blog/static/f0ec9196d316c5129de247ce423f8f06/526de/5.png 885w,
/blog/static/f0ec9196d316c5129de247ce423f8f06/fa2eb/5.png 1180w,
/blog/static/f0ec9196d316c5129de247ce423f8f06/08f6a/5.png 1770w,
/blog/static/f0ec9196d316c5129de247ce423f8f06/34f25/5.png 2324w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h5&gt;Malware&lt;/h5&gt;
&lt;p&gt;Looking at the strings of the .bin file, we see &lt;code class=&quot;language-text&quot;&gt;cmd.exe /q /c net share shared$=%SystemRoot% /GRANT: everyone, FULL&lt;/code&gt;
It looks like it is executing a command to create a network share to the system root and give full permissions to everyone. /q is for quiet mode so it‚Äôs undetected.&lt;/p&gt;
&lt;p&gt;When running the malware, the first thing I see is a file called igfxtrayex.exe that is created. By reading and googling strings and using the tools from last week, I think the malware is adding itself as a service to Windows Schedule Management Service (WinsSchMgmt). It looks like it creates and runs multiple files including dpnsvr16.exe and net_ver.dat. It also seems to change soooo many registry keys (just a small sub section below):&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/e4a1ad56282f2663afe586ba13b91236/b7132/bad.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 92.33817701453104%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAADOklEQVQ4y01UZ3PaQBDV//8nKZMySb4nsR07ITYGdQlVkADTZIpgKH55uyIkzNwMc9rbe23PuG+34YcpbMuH5fbgOAFcrwczCmAGEVqWiaQosVrvsVhuUS13WDzXmMxXmFc1ZtUGU/6vVjt+28IIQx/FsETU62Gz2aDerPGj24Ht2phOJ8j7GZIsweTpCePRCMPhELPZFEkSo6oq1PUGcRxhxG8bnjU810UyGMB1Pby8vGCzXuPV12/41fqNLMsxKAZ4aD/CdVw4toNu10QQhGThoiyHqJ4rZGmGlGvNs4bvedrQdhwcj0fdfPv9Ci02TJIEWZ6ha5rwWOfxUsuyEYYhfN/HaDzGcrnUuqIosN3tYMRRhAHhxtw8nU7Ybmt8ufsJ07RYVKKkHAEb5ESbJimiKMaAANKUMlASkWk2m2G1Wul5RZiVzSHZkIL319ek2dZbZVm2TY0jIuvBI7I8z9m4h/ligcNhr2iDICD9ZxgOqca8UagcjydSXuH1N9GwpdRiit9+FA29i4ae1zR4olGHw4HmTRXldkuXezzUp3MhXRaEdV3j449bdDpdRVIQvc/D0rzHGmnU7w8QnZ0VqrL2+z3kZ4RSwIaizd+Gn25v8djtakRG45HSjKh1EifauN/va8OFUj5Qz1T31pTrQrlx+aQuvzlTlkJxucPmorVEx6Tj0tzzPZoyxW63hU2NJQXPoqEImpWFbvw15d31DR4e2nowzVI1JWT2Ap9TxNxKIgThfD5XqmEYaC6n1NEQXTQ28b/YfL67O8emYHhFw7AJr8YmUg0le2OaItMidWKM0Ddc1+GsFqqTItRgf9fYSFTEZQm2IPTprkPaAsIPfL1MDJlMJhpwbaijx/Gy7UZDafjmPClxHF80lCmRZVqWjp5PDQWhaC51OikamzNlofI/5S6bCLXyHBuhKy5Lvcy4UJYcihGj0Vipy+heJuWSQ5ry4eaGYe6cJ2UAhyzkQpHApzFplml8nkhVYiZ5lYsVoXuhbP+LDTVs/b7XEIubj50O6fpNbJRy42oT/IJoU50Uea0UYcpNQXEx5eoK94xNRiR5P1dTxBB9wiS3pC6mzGZNbKROnjJB+wcsPx3qgm7HJgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Opened file&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/e4a1ad56282f2663afe586ba13b91236/fb8a0/bad.png&quot;
        srcset=&quot;/blog/static/e4a1ad56282f2663afe586ba13b91236/1a291/bad.png 148w,
/blog/static/e4a1ad56282f2663afe586ba13b91236/2bc4a/bad.png 295w,
/blog/static/e4a1ad56282f2663afe586ba13b91236/fb8a0/bad.png 590w,
/blog/static/e4a1ad56282f2663afe586ba13b91236/b7132/bad.png 757w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/b42eb19c22027bf891596c4fb49d9bf4/6ea70/bad2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 16.801075268817204%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAsklEQVQI1zWPzQrCMBCE+/4v40k89yII4qHpr20aMU0qNdLE3grJuKl0YWGHYb+dTYQQ6IcBddMglp0t0usRRZFDKQ1FHmMMVVWhbVtw3mNdV4ieQ2kN7z3KsiS/hjEfJEI8NmBeFAjBw1mH9HJAxjKYt8E4jsh3YNcRkP+BgkOTF0Kgo2qDzxQmGUgMrxcaShjTOPfF+Xai5TuklFiWZVuKSfaOWsonpmnaZk2w+I21Fj/urd0XrBEBcgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Opened file&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/b42eb19c22027bf891596c4fb49d9bf4/fb8a0/bad2.png&quot;
        srcset=&quot;/blog/static/b42eb19c22027bf891596c4fb49d9bf4/1a291/bad2.png 148w,
/blog/static/b42eb19c22027bf891596c4fb49d9bf4/2bc4a/bad2.png 295w,
/blog/static/b42eb19c22027bf891596c4fb49d9bf4/fb8a0/bad2.png 590w,
/blog/static/b42eb19c22027bf891596c4fb49d9bf4/6ea70/bad2.png 744w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It also tries to connect to a bunch of IPs starting with 43.130.141:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/f7fe0b68d9a773f19e1c8dd56044ce2e/95632/bad3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 576px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 67.1875%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABq0lEQVQ4y42SyU/CQBSHSziZaEw8aNlKF9ppC20pILUKQa/uGhcS48WLJ///48/5jUwim/EwmaXzvvfNezU+Pr8wnV1gXE6Q5iOUk3P0RwVGJxMMizP0siHidIBsMEaSH8v9CNmwwEDe8fwQe/sH2NndV/PhoQnj9vEFnmvD8zzU6zUEvg+r1UIoBHy/g3rNREOeu46tZtM8gmO3kfR6qMlvhmEsj+f5mwoWIoRltRHHMVzXRbfbRRiGaEl4y7JUQsdx0Gg0ZCIfSZJIYA2VSmUBq/ysaShEgCAIJNBCFEUqkGAhEzWbTQUlkIm473Q6CmiaGwwv754gAl9lJZBWtm0rMJPQyFoYEsg91z355I3A64eXJaA25KwNrZUn0/BPYBQKFdxub6mhHDyjua5hmqaqhmvAq/tnxFGomkIgQQymAS1/Azm4/idQLAFXDfnkfxleP7xuBWpDXUPWThtmWbYZePM4X3uy7uJvIGE8Z5PY/a1ANmVTDVcN9V/AO+w2gVxXq9Vl4NP8HaenJfI8Vxaz2UzVpyxLFEWhbLQRoUzW7/cxnU5VTVcNvwGfwWV4/GK1vgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Opened file&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/f7fe0b68d9a773f19e1c8dd56044ce2e/95632/bad3.png&quot;
        srcset=&quot;/blog/static/f7fe0b68d9a773f19e1c8dd56044ce2e/9d04d/bad3.png 148w,
/blog/static/f7fe0b68d9a773f19e1c8dd56044ce2e/f1dcb/bad3.png 295w,
/blog/static/f7fe0b68d9a773f19e1c8dd56044ce2e/95632/bad3.png 576w&quot;
        sizes=&quot;(max-width: 576px) 100vw, 576px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;It also seems like it may be loading a window and drawing text to it, based on calls to BeginPaint, DrawText, and LoadIcon.&lt;/p&gt;
&lt;h5&gt;Deleted files&lt;/h5&gt;
&lt;p&gt;The following files were deleted (found using PhotoRec):&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/44adaa83cacd14a017263fe5ccade7cf/a7964/2-photorec.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 37.025796661608496%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAA+UlEQVQoz31R2W6EQAwDcd9XgeUUCIEE4nrY/v+nufJUs+pDdx+szCiJHSfK8/mN8zyxriuu68JxHNj3Hfd9Y1kWbNuGYRgwTRO6roPrulAU5T2apkEURciyDH3f4/F4oCgKAdu2YRgGVFWFpmmfiSSy7At1XQuCqqrg+z4cxxECcRyLqSjIYk7HN0WYI9I0RRiG0HX9l1DTdNGc5/m/U0gB5pIkEbWcXDoqyxJt24ooeoIgEIqmab4sep73IvoL1jBalvXe8jzPwvI4juIIVKIICdlIEVrin5Zp8+Nhuq4X+yMprynfPA7XQCFGQu6MOUa5Kg5B+xT6AdMoo3BPwEyuAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;PhotoRec&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/44adaa83cacd14a017263fe5ccade7cf/fb8a0/2-photorec.png&quot;
        srcset=&quot;/blog/static/44adaa83cacd14a017263fe5ccade7cf/1a291/2-photorec.png 148w,
/blog/static/44adaa83cacd14a017263fe5ccade7cf/2bc4a/2-photorec.png 295w,
/blog/static/44adaa83cacd14a017263fe5ccade7cf/fb8a0/2-photorec.png 590w,
/blog/static/44adaa83cacd14a017263fe5ccade7cf/a7964/2-photorec.png 659w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/e8a807dd7bb7eb6705ec5cccd926b26e/214b2/2a.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 47.423887587822016%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQoz22S2ZaCMBBE+f/fm4fhyLCIHgFBIWFfa1Jx2qMOD6GbpFN9K4lTXGIEPx6O8Qm32w1t26Jpmueo6xp5UeB6zZHnOaqqsrEwc9qssUZrjSzL0Pc9HKULeN7BDM9uXpYF8zw/xzRNuN/vthkjGzKK6DAMtq4sy4dgrjSCKML5fDKL41OQUXISlIaMmyhISs5JU9Yppay4k51DHKMAsbFMwnVd3woZlaqsIDeRovoTl6Z0wblxHA1h8AX/8I3oGJsz0buC3Pxp+VNQ7Dtt2+CSJEiS1E68nuGrZdIxsoZOJJcaXo4lpIUwDOH7vi36T/i4FBLIK2CkgBAyT9MHkMMPfxJD2XXdLqEQMQqh0HGQjOuWkAukc13XvLUrtm17F9x5Nsx5BNKQrngpdPsLMjqz67qKpF0AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Recovered files A&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/e8a807dd7bb7eb6705ec5cccd926b26e/fb8a0/2a.png&quot;
        srcset=&quot;/blog/static/e8a807dd7bb7eb6705ec5cccd926b26e/1a291/2a.png 148w,
/blog/static/e8a807dd7bb7eb6705ec5cccd926b26e/2bc4a/2a.png 295w,
/blog/static/e8a807dd7bb7eb6705ec5cccd926b26e/fb8a0/2a.png 590w,
/blog/static/e8a807dd7bb7eb6705ec5cccd926b26e/214b2/2a.png 854w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/2b0d69a3aa4c4a034dac4f125a529f91/29454/2b.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 39.0452876376989%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABHklEQVQoz22S25KDIBBE+f+fVMzilhdEwLumOvSspFKpfegSxslxuidqig5aa+hKY14WPJ9PnOf51nVdmOcZwzBgHEf4ELCuK5xzWFL/vu9/fUnTNEEFp1GWGlVVSRMB/wFtAvI9odu2wVqLPqnrOhzHkeCznFX0Bo/HD4wxUiCAU2Ywn5yEMO89QpqQwAznk0DWeJcJi6JMKgTatI18PcYoMIpW+r6XH1O0zAgo1gmkeFfBNwKihsFKJrnhvIGS4T0hlTPMU9MJ+3lWDLlKSzGmlmK2+2n5cynhXkq2S6s5JtbVb2dly0VZpvHtG/K9FC4gT8RMmTfPW3JEWIxB7KvejajrGm3bSm60/A3kBjOMPbIk/oXSnR9jDyfluxc5iWa13eH4rAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Recovered files B&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/2b0d69a3aa4c4a034dac4f125a529f91/fb8a0/2b.png&quot;
        srcset=&quot;/blog/static/2b0d69a3aa4c4a034dac4f125a529f91/1a291/2b.png 148w,
/blog/static/2b0d69a3aa4c4a034dac4f125a529f91/2bc4a/2b.png 295w,
/blog/static/2b0d69a3aa4c4a034dac4f125a529f91/fb8a0/2b.png 590w,
/blog/static/2b0d69a3aa4c4a034dac4f125a529f91/29454/2b.png 817w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h5&gt;Username/passwords&lt;/h5&gt;
&lt;p&gt;After opening a file recovered via PhotoRec, I searched in the .bin file for the string ‚Äòspe‚Äô (lecture hint) and found the following (at offset value 0x3ebbd):&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/blog/static/f95e466da5c2bd0bbcd609d4ccf11ffc/bd485/6.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 50.32453483340545%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACL0lEQVQoz22RW08acRDF93NataJSb2nSN/sJmr71oUnTh/atiVoNTVoJ1guCVBEqCCwLKlor12Vxl0sCgcXw6+ymJKbpJCdzZnZmcv5nlY/vP/D6zVtmZpd5OreMZ36JOe8i3sUVPN4lJme8zC8+Z/bZChPTc8x4V1h+8ZJpzwJPpmaZlN7ElIcFmXm1uoqSUtNkzsPEzzKcqxdktTy5nMZlPo+maiRTWdJqnnQmRyZ7QUpyKp11c8JBWiD9+Nd9jjcDKKFwhOjPFLGzJKfxBPvBEMlEko1tP++2tvi0u8tGOMza4SHrwSCboRDrUvsiR4QFoUhEIPzoiOD+AcrNzS+63S6jEbTbbVGjYfe6aO0OX+oG2zWd7+UKO6USO+UygcY9gXqdmGXxbzw8PKDUjQa2PZCDI3q9HqqWo22ZpGXRVyrzTQ7574r4i0UCgh1dZ7tS5dgwsAcDBoL+3+wIU6LRKIVCgdvbWwpXV5zGYpwl0iTUHCcplaj4dZJxoLk8Ji+IZnMuz+bE8/wl2sUV+ctrNOHK2mcf4R+n7B2E2dj04Q/scX3zm2qlwr2oN0RRvVajJqoMsUCvVtGFl4slqsLvRL0hc7rMtVptlFKljmk1RbaN2Mi9aWEKdDlimiaNRsOFs9RsNl1uWpb7zamd7Hjv9Dudjhws16TREkOHrrGGeNNqtej3+64vw+HQzbZtuz6Pw6Hj2sljKEX3YNv9Q05U5DktqUf8P8aLj+vH8QdtRruELp3jjgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Usernames and passwords&quot;
        title=&quot;&quot;
        src=&quot;/blog/static/f95e466da5c2bd0bbcd609d4ccf11ffc/fb8a0/6.png&quot;
        srcset=&quot;/blog/static/f95e466da5c2bd0bbcd609d4ccf11ffc/1a291/6.png 148w,
/blog/static/f95e466da5c2bd0bbcd609d4ccf11ffc/2bc4a/6.png 295w,
/blog/static/f95e466da5c2bd0bbcd609d4ccf11ffc/fb8a0/6.png 590w,
/blog/static/f95e466da5c2bd0bbcd609d4ccf11ffc/526de/6.png 885w,
/blog/static/f95e466da5c2bd0bbcd609d4ccf11ffc/fa2eb/6.png 1180w,
/blog/static/f95e466da5c2bd0bbcd609d4ccf11ffc/08f6a/6.png 1770w,
/blog/static/f95e466da5c2bd0bbcd609d4ccf11ffc/bd485/6.png 2311w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;h5&gt;Strategy to Target&lt;/h5&gt;
&lt;p&gt;DO NOT RUN THIS FILE! It will destroy your computer. üò±&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Thoughts on Malware (Defense Against the Dark Arts)]]></title><description><![CDATA[As part of my effort to obtain a Computer Science degree, I am taking a class called ‚ÄúDefense Against the Dark Arts‚Äù on Security topics. I‚Äôm‚Ä¶]]></description><link>https://michelelarson.com/blog/security-malware/</link><guid isPermaLink="false">https://michelelarson.com/blog/security-malware/</guid><pubDate>Fri, 11 Jan 2019 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;As part of my effort to obtain a Computer Science degree, I am taking a class called ‚ÄúDefense Against the Dark Arts‚Äù on Security topics. I‚Äôm actually really excited for this class, both its topics and its approach, which is that the lectures are given by experts who work in the field. As part of the class, I am required to write blog posts each week on the topic, so here I go!&lt;/p&gt;
&lt;p&gt;The first week talks about malware (malicious software). I had a small understanding of malware, in that I knew what it is, but I had never thought about it beyond that. This week, the lecturer is from McAfee, and I learned that what the security research team is doing is writing drivers to detect malware, and in their approach to writing these drivers, trying to be able to detect future variations, because there‚Äôs just so much malware to keep up with.&lt;/p&gt;
&lt;p&gt;First we start off with some basic information about malware and definitions:&lt;/p&gt;
&lt;h3&gt;Some different types of malware:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Viruses&lt;/strong&gt; (parasitic - when it depends on another file, polymorphic - code keeps changing) and Worm - (spreads quickly)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Trojans&lt;/strong&gt; - backdoor (has remote control of system, attacker will be active so it‚Äôs more targeted than a bot), downloader (has remote control of system), password stealer, keylogger, bot (waits for remote commands) &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Potentially Unwanted Program, Adware, Spyware&lt;/strong&gt; (PUP, PUA, PUS) (commercial, can install other programs along with one you want)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Ways to cause infection of malware:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The biggest risk is people!&lt;/li&gt;
&lt;li&gt;USB sticks&lt;/li&gt;
&lt;li&gt;Mobile apps&lt;/li&gt;
&lt;li&gt;Drive by downloads - such as JavaScript exploit from visiting a website&lt;/li&gt;
&lt;li&gt;PDF&lt;/li&gt;
&lt;li&gt;Office files&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Malware Definitions:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;White listed&lt;/strong&gt; - clean&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Black&lt;/strong&gt; - dirty&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Grey&lt;/strong&gt; - trying to discover what the malware is doing&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Sample&lt;/strong&gt; - piece of malware&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Goat&lt;/strong&gt; - machine used to investigate malware. Some malware knows when it‚Äôs running in a VM, so sometimes you want to run on a real system. Goats are sacrificial machines that are on purpose infected.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Honeypot&lt;/strong&gt; - sitting duck waiting for it to be infected&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Replication&lt;/strong&gt; - what is the malware doing? So we can study its behavior.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Hash&lt;/strong&gt; - calculating using cryptographic algorithm (commonly md5) the value of a file. It‚Äôs used to verify values of files. (Is it the same file?)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Trojan horse&lt;/strong&gt; - users tricked into opening a program because they think it‚Äôs legitimate software. Can also create a backdoor that gives users access to your system&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Spyware&lt;/strong&gt; - programs that collect personal info without the user‚Äôs knowledge. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Ransom-ware&lt;/strong&gt; - encrypts your files and asks for payment to unlock them - bitcoin&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;POS malware&lt;/strong&gt; - (point of sale) trying to steal your credit card (Target, Home Depot, Staples)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Patient zero&lt;/strong&gt; - first attacked&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Naming convention for malware:&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Type of malware + Platform + Family (name in malware) + Variant of Family + ! + information&lt;/code&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;The next part was my favorite part of the week, learning about strategies for investigating malware and doing a lab to investigate an actual malware sample. I learned there are different tools out there that you can use to see what is happening, but there‚Äôs also a lot of basic methods you can use to poke around the system.&lt;/p&gt;
&lt;h2&gt;Strategies to replicate/investigate malware:&lt;/h2&gt;
&lt;h3&gt;Before Starting:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Transport it in an inactive state by renaming it using the command line (ie remove ‚Äò.exe‚Äô so it won‚Äôt execute)&lt;/li&gt;
&lt;li&gt;Have isolated environment so it doesn‚Äôt destroy anything you need&lt;/li&gt;
&lt;li&gt;Take a snapshot of your machine before you start, so you can easily revert back to a clean state.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;General Research Tactics:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Upload/check sites: You can hash the file and upload to different sites to see if anyone else has encountered the malware. Virustotal, Malwr, Wepawet, Comodo are examples of sites.&lt;/li&gt;
&lt;li&gt;Compare snapshot before and after running it to see what is changing&lt;/li&gt;
&lt;li&gt;Bait the malware with what it‚Äôs looking for (ie if it‚Äôs trying to steal credit card numbers, feed it some fake credit card numbers)&lt;/li&gt;
&lt;li&gt;Check PE file (starts with MZ) - headers, directories, section tables, code, imports, data&lt;/li&gt;
&lt;li&gt;Do a text analysis by searching google (maybe someone has a username and posted online, or you find an IP address you can investigate)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Built in Windows tools you can use to investigate:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Task Manager&lt;/li&gt;
&lt;li&gt;MS Config&lt;/li&gt;
&lt;li&gt;Command Prompts - IPconfig/displayDNS&lt;/li&gt;
&lt;li&gt;Windows search for the time when last files were added to system &lt;/li&gt;
&lt;li&gt;Task Scheduler&lt;/li&gt;
&lt;li&gt;Registry - because malware wants to survive a reboot, it might add run keys in registry&lt;/li&gt;
&lt;li&gt;attrib &lt;filename&gt;&lt;/li&gt;
&lt;li&gt;Process Explorer - Task manager/system monitor&lt;/li&gt;
&lt;li&gt;Process monitor - monitor all changes on system like opening files. File and capture events, search for Evil.exe.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Other tools we‚Äôre using in class:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Flypaper - block TCP/IP connections and blocks program from exiting&lt;/li&gt;
&lt;li&gt;Fake Net - listening on several ports&lt;/li&gt;
&lt;li&gt;Antispy - detect spyware&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Static analysis techniques:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Open the program in text editor and analyze source code&lt;/li&gt;
&lt;li&gt;Open in IDA Pro - tool to disassemble code and to see how it is running&lt;/li&gt;
&lt;li&gt;XOR encryption - check for bit flipping (sometimes authors will flip values to hide things)&lt;/li&gt;
&lt;li&gt;File Insight - A Mcafee tool where you can try to make the code more readable by checking for bit flipping, swapping, and string dumps&lt;/li&gt;
&lt;li&gt;Packer - some malware is compressed and/or encrpyted, so you need to use a packer to return it to its readable state&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;Next the lectures talked about APT, or Advanced Persistent Threats.&lt;/p&gt;
&lt;h3&gt;APT&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Advanced&lt;/strong&gt; - attacker is fluent with techniques&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Persistent&lt;/strong&gt; - attacker has an objective and works to achieve goals without detection&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Threats&lt;/strong&gt; - attacker is organized, receives instructions, funded/motivated&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Actors&lt;/strong&gt; - can be activists, governments, organized crime groups, competitions, malicious insiders or ex employees&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Motives&lt;/strong&gt; - money, revenge, ideology, excitement&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Targets&lt;/strong&gt; - corporations, governments, defense contractors, anyone&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Goals&lt;/strong&gt; - use stealth to avoid detection, create backdoors to allow greater access, initiate primary mission, leave undetected&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kill chain&lt;/strong&gt; - reconnaissance, weaponization, delivery, exploitation, installation, command and control, actions on objectives&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;The last topic was also really interesting to me: reconnaissance. The lectures talked about ways someone could go about planning an attack to get information. It‚Äôs scary how easy it is.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You can research people at the company on LinkedIn to find out who works there and the way the company structures their email addresses.&lt;/li&gt;
&lt;li&gt;You can research what those users visit, what vendors they use, and send fake emails where you get people to click (water hole attack)&lt;/li&gt;
&lt;li&gt;You can find a lot about what technologies a company is using (on job listings you can see what software they are using; check metadata in files published online (version of pdfs, word, OS, etc)&lt;/li&gt;
&lt;li&gt;Delivery - you can implement a fake wifi, something that requires Facebook login, that people at the company may use and you can then infect them&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item></channel></rss>